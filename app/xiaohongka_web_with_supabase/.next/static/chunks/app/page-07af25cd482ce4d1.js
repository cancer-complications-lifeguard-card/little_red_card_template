(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4454:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>eQ});var t=a(5155),i=a(2115),r=a(3463),l=a(64),n=a(9434);function d(e){let{className:s,...a}=e;return(0,t.jsx)(l.bL,{"data-slot":"tabs",className:(0,n.cn)("flex flex-col gap-2",s),...a})}function c(e){let{className:s,...a}=e;return(0,t.jsx)(l.B8,{"data-slot":"tabs-list",className:(0,n.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...a})}function o(e){let{className:s,...a}=e;return(0,t.jsx)(l.l9,{"data-slot":"tabs-trigger",className:(0,n.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...a})}function m(e){let{className:s,...a}=e;return(0,t.jsx)(l.UC,{"data-slot":"tabs-content",className:(0,n.cn)("flex-1 outline-none",s),...a})}function x(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...a})}function h(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...a})}function g(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",s),...a})}function p(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm",s),...a})}function u(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",s),...a})}var j=a(9708),y=a(2085);let f=(0,y.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function b(e){let{className:s,variant:a,asChild:i=!1,...r}=e,l=i?j.DX:"span";return(0,t.jsx)(l,{"data-slot":"badge",className:(0,n.cn)(f({variant:a}),s),...r})}let v=(0,y.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function N(e){let{className:s,variant:a,size:i,asChild:r=!1,...l}=e,d=r?j.DX:"button";return(0,t.jsx)(d,{"data-slot":"button",className:(0,n.cn)(v({variant:a,size:i,className:s})),...l})}var w=a(1976),k=a(1788),A=a(1497),C=a(9099),S=a(4869),D=a(8883),I=a(760);function T(e){let{className:s,type:a,...i}=e;return(0,t.jsx)("input",{type:a,"data-slot":"input",className:(0,n.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...i})}var _=a(968);function P(e){let{className:s,...a}=e;return(0,t.jsx)(_.b,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...a})}function E(e){let{className:s,...a}=e;return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,n.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...a})}var z=a(4842),M=a(6474),O=a(5196),F=a(7863);function L(e){let{...s}=e;return(0,t.jsx)(z.bL,{"data-slot":"select",...s})}function J(e){let{...s}=e;return(0,t.jsx)(z.WT,{"data-slot":"select-value",...s})}function R(e){let{className:s,size:a="default",children:i,...r}=e;return(0,t.jsxs)(z.l9,{"data-slot":"select-trigger","data-size":a,className:(0,n.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...r,children:[i,(0,t.jsx)(z.In,{asChild:!0,children:(0,t.jsx)(M.A,{className:"size-4 opacity-50"})})]})}function G(e){let{className:s,children:a,position:i="popper",...r}=e;return(0,t.jsx)(z.ZL,{children:(0,t.jsxs)(z.UC,{"data-slot":"select-content",className:(0,n.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:i,...r,children:[(0,t.jsx)(K,{}),(0,t.jsx)(z.LM,{className:(0,n.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,t.jsx)(V,{})]})})}function H(e){let{className:s,children:a,...i}=e;return(0,t.jsxs)(z.q7,{"data-slot":"select-item",className:(0,n.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),...i,children:[(0,t.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,t.jsx)(z.VF,{children:(0,t.jsx)(O.A,{className:"size-4"})})}),(0,t.jsx)(z.p4,{children:a})]})}function K(e){let{className:s,...a}=e;return(0,t.jsx)(z.PP,{"data-slot":"select-scroll-up-button",className:(0,n.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,t.jsx)(F.A,{className:"size-4"})})}function V(e){let{className:s,...a}=e;return(0,t.jsx)(z.wn,{"data-slot":"select-scroll-down-button",className:(0,n.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,t.jsx)(M.A,{className:"size-4"})})}var B=a(6981);function U(e){let{className:s,...a}=e;return(0,t.jsx)(B.bL,{"data-slot":"checkbox",className:(0,n.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...a,children:(0,t.jsx)(B.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,t.jsx)(O.A,{className:"size-3.5"})})})}var X=a(9397),Z=a(1007),W=a(9420),Y=a(1243),Q=a(4416),q=a(4616),$=a(4516),ee=a(4186),es=a(2355),ea=a(3052),et=a(6516),ei=a(5525),er=a(7434);function el(e){let{selectedComplications:s,medicalInfo:l,emergencyContacts:n,hospitals:d,nursingServices:c=[],symptomRecords:o=[]}=e,m=(0,i.useRef)(null),[x,h]=(0,i.useState)(!1),g=async()=>{h(!0);try{if(m.current){let e=(await a.e(316).then(a.t.bind(a,2699,23))).default,s=await e(m.current,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",width:m.current.scrollWidth,height:m.current.scrollHeight}),t=document.createElement("a");t.download="小红卡-".concat(l.name||"未命名","-").concat(new Date().toLocaleDateString("zh-CN"),".png"),t.href=s.toDataURL("image/png"),t.click()}}catch(e){console.error("生成图片失败:",e);try{if(m.current){let e=document.createElement("canvas"),s=e.getContext("2d");if(!s)throw Error("无法创建canvas上下文");e.width=800,e.height=4e3,s.fillStyle="#ffffff",s.fillRect(0,0,e.width,e.height),s.fillStyle="#ef4444",s.fillRect(0,0,e.width,100),s.fillStyle="#ffffff",s.font="bold 32px Arial",s.fillText("小红卡",50,40),s.font="20px Arial",s.fillText("并发症管理指引",50,70),s.font="16px Arial",s.fillText("生成时间: ".concat(new Date().toLocaleDateString("zh-CN")),e.width-200,70),s.fillStyle="#000000",s.font="bold 20px Arial",s.fillText("患者信息",50,140),s.font="16px Arial",s.fillText("姓名: ".concat(l.name||"未填写"),50,170),s.fillText("年龄: ".concat(l.age||"未填写"),250,170),s.fillText("血型: ".concat(l.bloodType||"未填写"),450,170),s.fillText("主要诊断: ".concat(l.mainDiagnosis||"未填写"),50,200);let a=240;s.fillStyle="#ef4444",s.font="bold 20px Arial",s.fillText("\uD83C\uDD98 急救指导步骤",50,a),a+=30,s.fillStyle="#000000",s.font="16px Arial",v.forEach(e=>{if(s.font="bold 18px Arial",s.fillText(e.title,50,a),a+=30,s.font="16px Arial",s.fillText("处理步骤：",50,a),a+=25,e.steps.forEach(e=>{s.fillText("• ".concat(e),70,a),a+=25}),s.fillText("注意事项：",50,a),a+=25,e.warnings.forEach(e=>{s.fillText("• ".concat(e),70,a),a+=25}),a+=20,e.emergencyCall){s.fillStyle="#3b82f6",s.font="bold 16px Arial",s.fillText("\uD83D\uDCDE 120急救话术模板",50,a),a+=25,s.fillStyle="#000000",s.font="14px Arial";let t=e.emergencyCall.replace(/\[姓名\]/g,l.name||"未填写").replace(/\[年龄\]/g,l.age||"未填写").replace(/\[血型\]/g,l.bloodType||"未填写").replace(/\[主要疾病\]/g,l.mainDiagnosis||"未填写").replace(/\[过敏史\]/g,l.allergies||"未填写").replace(/\[既往病史\]/g,l.surgeryHistory||"未填写").split(""),i="";for(let e=0;e<t.length;e++){let r=i+t[e];s.measureText(r).width>700&&e>0?(s.fillText(i,70,a),i=t[e],a+=20):i=r}s.fillText(i,70,a),a+=25}e.criticalInfo&&(s.fillStyle="#eab308",s.font="bold 16px Arial",s.fillText("\uD83D\uDD34 关键信息卡",50,a),a+=25,s.fillStyle="#000000",s.font="14px Arial",e.criticalInfo.forEach(e=>{let t=e.replace(/\[姓名\]/g,l.name||"未填写").replace(/\[年龄\]/g,l.age||"未填写").replace(/\[血型\]/g,l.bloodType||"未填写").replace(/\[主要疾病\]/g,l.mainDiagnosis||"未填写").replace(/\[过敏史\]/g,l.allergies||"未填写").replace(/\[相关风险因素\]/g,l.otherDiseases||"未填写").replace(/\[是\/否\]/g,l.isOnAnticoagulation?"是":"否");s.fillText(t,70,a),a+=20}),a+=10)}),A.length>0&&(s.fillStyle="#3b82f6",s.font="bold 20px Arial",s.fillText("\uD83D\uDD0D 病情诊断关键指引",50,a),a+=30,s.fillStyle="#000000",s.font="16px Arial",A.forEach(e=>{s.font="bold 18px Arial",s.fillText(e.title,50,a),a+=30,s.font="16px Arial",e.points.forEach(e=>{s.fillText("• ".concat(e),70,a),a+=25}),a+=20,e.riskFactors&&(s.fillStyle="#ef4444",s.font="bold 16px Arial",s.fillText("⚠️ 风险评估体系",50,a),a+=25,s.fillStyle="#000000",s.font="14px Arial",e.riskFactors.forEach(e=>{e.includes("\uD83D\uDD34")||e.includes("\uD83D\uDFE1")||e.includes("\uD83D\uDFE2")?(s.fillStyle=e.includes("\uD83D\uDD34")?"#ef4444":e.includes("\uD83D\uDFE1")?"#eab308":"#10b981",s.font="bold 14px Arial"):(s.fillStyle="#000000",s.font="14px Arial"),s.fillText(e,70,a),a+=20}),a+=10),e.monitoringTable&&(s.fillStyle="#10b981",s.font="bold 16px Arial",s.fillText(e.monitoringTable.title,50,a),a+=25,s.fillStyle="#000000",s.font="14px Arial",e.monitoringTable.fields.forEach(e=>{s.fillText(e,70,a),a+=20}),a+=10)})),s.fillStyle="#10b981",s.font="bold 20px Arial",s.fillText("\uD83C\uDFE0 日常注意和预防",50,a),a+=30,s.fillStyle="#000000",s.font="16px Arial",s.fillText("\uD83C\uDF4E 饮食管理",50,a),a+=25,s.fillText("推荐食物：流质食物、半流质、易消化蛋白、温热饮品",70,a),a+=25,s.fillText("避免食物：难消化食物、高纤维食物、坚硬食物、易胀气食物",70,a),a+=30,s.fillText("\uD83D\uDC8A 用药安全指导",50,a),a+=25,s.fillText("需谨慎使用：阿片类止痛药、抗胆碱药物、某些抗抑郁药、钙通道阻滞剂",70,a),a+=30,s.fillText("\uD83C\uDFC3‍♂️ 运动和生活方式",50,a),a+=25,s.fillText("适宜活动：餐后散步、腹式呼吸、轻柔按摩、适度瑜伽",70,a),a+=25,s.fillText("避免活动：剧烈运动、重体力劳动、久坐卧床、腹部按压",70,a),a+=30,s.fillText("\uD83D\uDCC5 定期监测指标",50,a),a+=25,s.fillText("每周：排便频率、腹胀程度、食欲体重、腹痛情况",70,a),a+=25,s.fillText("每月：腹部CT/B超、血常规生化、肿瘤标志物、营养评估",70,a),a+=30,(n.length>0||d.length>0)&&(s.fillStyle="#10b981",s.font="bold 20px Arial",s.fillText("\uD83E\uDD1D 辅助服务",50,a),a+=30,s.fillStyle="#000000",s.font="16px Arial",n.length>0&&(s.fillText("紧急联系人：",50,a),a+=25,n.forEach(e=>{s.fillText("• ".concat(e.name," (").concat(e.relationship,") - ").concat(e.phone),70,a),a+=25})),d.length>0&&(s.fillText("医院信息：",50,a),a+=25,d.forEach(e=>{s.fillText("• ".concat(e.name," - 急诊: ").concat(e.emergency),70,a),a+=25,s.fillText("  地址: ".concat(e.address),70,a),a+=25}))),s.fillStyle="#8b5cf6",s.font="bold 20px Arial",s.fillText("\uD83D\uDCCB 个人医疗信息卡",50,a),a+=30,s.fillStyle="#000000",s.font="16px Arial",s.fillText("姓名: ".concat(l.name||"未填写","  血型: ").concat(l.bloodType||"未填写"),50,a),a+=25,s.fillText("年龄: ".concat(l.age||"未填写","  联系电话: ").concat(n.length>0?n[0].phone:"未填写"),50,a),a+=25,s.fillText("主要诊断: ".concat(l.mainDiagnosis||"未填写"),50,a),a+=25,D.length>0&&(s.fillStyle="#6366f1",s.font="bold 20px Arial",s.fillText("\uD83D\uDCDA 医学术语速查表",50,a),a+=30,s.fillStyle="#000000",s.font="16px Arial",D.forEach(e=>{s.fillStyle="#4f46e5",s.font="bold 18px Arial",s.fillText(e.title,50,a),a+=25,s.fillStyle="#000000",s.font="14px Arial",e.items.forEach(e=>{s.fillText("".concat(e.term,"：").concat(e.definition,"（").concat(e.significance,"）"),70,a),a+=20}),a+=10})),s.fillStyle="#6b7280",s.font="14px Arial",s.fillText("\xa9 2024 小红卡 - 为您的健康保驾护航",50,a),a+=20,s.fillText("由小红卡开源社区 x 小x宝社区联合提供公益服务",50,a);let t=document.createElement("a");t.download="小红卡-".concat(l.name||"未命名","-").concat(new Date().toLocaleDateString("zh-CN"),".png"),t.href=e.toDataURL("image/png"),t.click()}}catch(e){console.error("备用图片生成也失败:",e),alert("图片生成失败，请重试或联系技术支持")}}finally{h(!1)}},[p,u]=(0,i.useState)([{name:"布洛芬",taken:!1},{name:"阿司匹林",taken:!1},{name:"利伐沙班",taken:!1},{name:"华法林",taken:!1},{name:"非甾体抗炎药",taken:!1},{name:"糖皮质激素",taken:!1}]),[j,y]=(0,i.useState)(""),f=e=>{let s=[...p];s[e].taken=!s[e].taken,u(s)},b=e=>{let s=[...p];s.splice(e,1),u(s)},v=(()=>{let e=[];return s.includes("bleeding")&&e.push({title:"消化道出血急救",steps:["立即拨打120，告知消化道出血","绝对禁食禁水，保持呼吸道通畅","侧卧位，防止呕吐物误吸","记录呕血和黑便的量、颜色和时间","保存呕吐物样本，供医生查看"],warnings:["禁止使用止痛药，可能掩盖症状","禁止热敷腹部，可能加重出血","禁止自行服用止血药"]}),s.includes("obstruction")&&e.push({title:"肠梗阻急救",steps:["立即拨打120，告知肠梗阻症状","绝对禁食禁水，减轻肠道负担","禁止催吐，防止肠道穿孔","禁止使用止痛药，避免掩盖症状","禁止热敷腹部，防止肠管扩张","侧卧位，保持呼吸道通畅","记录腹痛性质、呕吐次数和腹胀程度","准备身份证、医保卡、既往病历资料"],warnings:["禁止按摩腹部，可能导致肠穿孔","禁止使用泻药或灌肠，加重肠管损伤","禁止进食任何食物或液体","禁止剧烈活动，防止病情加重","禁止自行服用药物，特别是止痛药"],emergencyCall:"您好，这里是肠梗阻急救，患者[姓名]，[年龄]岁[性别]，[既往病史]。现在出现[具体症状：剧烈腹痛/呕吐不止/停止排气排便]，可能需要紧急手术。地址是[具体地址]，联系电话[电话号码]。请尽快派救护车！",criticalInfo:["血型：[血型]","年龄：[年龄]岁","诊断：[主要疾病]","特殊风险：[相关风险因素]","药物过敏：[过敏史]","7天内抗凝治疗：[是/否]"]}),s.includes("biliary")&&e.push({title:"胆道梗阻急救",steps:["立即拨打120，告知黄疸、发热症状","绝对禁食禁水，减轻肝脏负担","记录体温变化，监测发热规律","观察皮肤和巩膜黄染程度","记录腹痛性质和部位变化"],warnings:["禁止使用对肝脏有损害的药物","禁止饮酒，加重肝脏负担","禁止高脂饮食，加重胆道负担"]}),s.includes("infection")&&e.push({title:"感染急救",steps:["立即拨打120，告知高热、感染症状","保持休息，减少体力消耗","补充水分，防止脱水","记录体温变化和发热规律","观察有无寒战、出汗等症状"],warnings:["禁止自行使用抗生素，可能导致耐药","禁止捂汗，可能加重高热","禁止擅自降温，可能掩盖病情"]}),s.includes("ascites")&&e.push({title:"腹水急救",steps:["立即拨打120，告知严重腹胀、呼吸困难","半坐卧位，减轻呼吸困难","限制水分和盐分摄入","记录腹围变化，观察腹胀程度","测量体重变化，监测腹水增减"],warnings:["禁止大量饮水，加重腹水","禁止高盐饮食，增加水钠潴留","禁止腹部按摩，可能导致不适"]}),s.includes("thrombosis")&&e.push({title:"血栓急救",steps:["立即拨打120，告知肢体肿胀、疼痛","保持患肢休息，避免活动","抬高患肢，减轻肿胀和疼痛","记录肢体肤色和温度变化","避免按摩患处，防止血栓脱落"],warnings:["禁止热敷患处，可能加重血栓","禁止剧烈运动，可能导致血栓脱落","禁止自行服用抗凝药，可能导致出血"]}),e})(),A=(()=>{let e=[];return s.includes("bleeding")&&e.push({title:"消化道出血诊断要点",points:["呕血颜色：鲜红色提示活动性出血，咖啡色提示出血较慢或已停止","黑便：柏油样便提示上消化道出血，暗红色便提示下消化道出血","生命体征：心率增快、血压下降提示失血较多","伴随症状：头晕、心慌、出冷汗提示休克前期"]}),s.includes("obstruction")&&e.push({title:"肠梗阻诊断要点",points:["腹痛：阵发性绞痛提示机械性梗阻，持续性胀痛提示麻痹性梗阻","呕吐：呕吐物含胆汁提示高位梗阻，含粪样物质提示低位梗阻","腹胀：腹部膨隆，可见肠型和蠕动波","停止排气排便：完全性肠梗阻的典型表现","腹部X线：可见液气平面和肠管扩张","生命体征：心率增快、血压下降提示休克","腹部体征：肌紧张、反跳痛提示肠坏死或穿孔","实验室检查：白细胞升高、电解质紊乱"],riskFactors:["\uD83D\uDD34 高危风险信号（立即呼叫120）：","  • 剧烈腹痛伴肌紧张","  • 呕吐物呈粪便样","  • 腹胀明显伴停止排气排便>24小时","  • 发热>38.5\xb0C","  • 血压下降、心率增快","  • 腹部触及明显包块","  • 腹膜刺激征阳性","","\uD83D\uDFE1 中等风险管理（密切观察，准备就医）：","  • 阵发性腹痛","  • 间断呕吐","  • 腹胀但仍有少量排气","  • 轻度发热","  • 食欲完全消失","","\uD83D\uDFE2 低风险监护（居家观察，定期复查）：","  • 轻度腹胀不适","  • 排便困难但仍有排气","  • 食欲减退","  • 无明显腹痛"],monitoringTable:{title:"症状记录表",fields:["日期时间：_________","腹痛症状：","  - 阵发性腹痛（间隔时间：_______）","  - 持续性腹痛（疼痛程度：_______/10分）","  - 腹痛部位：_______","呕吐情况：","  - 次数：_______次","  - 性质：[ ] 胃内容物 [ ] 胆汁样 [ ] 粪便样","  - 量：_______ml","排便排气：","  - 最后排便时间：_______","  - 最后排气时间：_______","  - 大便性状：_______","腹胀情况：","  - 腹胀程度：[ ] 轻度 [ ] 中度 [ ] 重度","  - 是否可见肠型：[ ] 是 [ ] 否","生命体征：","  - 血压：_______mmHg","  - 心率：_______次/分","  - 体温：_______\xb0C","  - 呼吸：_______次/分"]}}),s.includes("biliary")&&e.push({title:"胆道梗阻诊断要点",points:["黄疸：皮肤和巩膜黄染，尿色加深，大便颜色变浅","腹痛：右上腹持续性胀痛，可向右肩放射","发热：提示合并感染，如胆管炎","Charcot三联征：腹痛、寒战高热、黄疸提示急性胆管炎","实验室检查：总胆红素、直接胆红素升高，碱性磷酸酶升高"]}),s.includes("infection")&&e.push({title:"感染诊断要点",points:["体温：持续高热或体温不升","血常规：白细胞计数升高，中性粒细胞比例升高","C反应蛋白：明显升高","降钙素原：严重细菌感染时升高","感染灶：局部红肿热痛，或有分泌物"]}),s.includes("ascites")&&e.push({title:"腹水诊断要点",points:["腹胀：腹部膨隆，腹围增加","移动性浊音：体位改变时浊音区移动","液波震颤：大量腹水时出现","超声检查：腹腔内游离液体","腹水检查：明确腹水性质（漏出液、渗出液）"]}),s.includes("thrombosis")&&e.push({title:"血栓诊断要点",points:["肢体肿胀：单侧肢体明显肿胀","疼痛：肢体胀痛或压痛","皮肤温度：患肢皮肤温度升高","皮肤颜色：患肢皮肤发红或发绀","血管超声：可见血管内血栓形成"]}),e})();if(0===s.length)return(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"text-center py-12",children:(0,t.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-950 border border-yellow-200 dark:border-yellow-800 rounded-lg p-8",children:[(0,t.jsx)(Y.A,{className:"h-16 w-16 text-yellow-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-yellow-800 dark:text-yellow-200 mb-2",children:"请先选择并发症类型"}),(0,t.jsx)("p",{className:"text-yellow-600 dark:text-yellow-400 mb-6",children:"您需要返回第一步选择至少一种并发症类型，才能生成预览卡片。"}),(0,t.jsx)(N,{onClick:()=>{let e=new CustomEvent("goToStep",{detail:0});window.dispatchEvent(e)},className:"bg-yellow-500 hover:bg-yellow-600 text-white",children:"返回选择并发症"})]})})});let C=(()=>{let e=[];return s.includes("bleeding")&&e.push({title:"消化道出血日常管理",dietManagement:{recommended:["流质食物：米汤、蛋花汤、清汤面条","半流质：稀粥、蒸蛋羹、软烂面条","易消化蛋白：鱼肉、鸡蛋、豆腐","温热饮品：温开水、淡茶水、温牛奶"],avoided:["坚果类：花生、核桃、瓜子（可刺破曲张静脉）","尖锐食物：鱼刺、骨头、鸡爪","粗糙食物：韭菜、芹菜、豆芽","油炸食品：炸鸡、薯片（硬脆外壳）","带皮水果：苹果皮、梨皮","酒精和刺激性食物"]},medicationSafety:["避免使用：阿司匹林、布洛芬、华法林等","7天内服用过的药物需告知医生","任何新药使用前咨询医生","避免使用抗抑郁药SSRIs"],monitoringIndicators:["每日观察：大便颜色、性质","每周监测：血压、心率","定期检查：血常规、肝功能","注意症状：头晕、心慌、出冷汗"],specialNotes:["家中常备：血压计、体温计、手电筒","提前联系：主治医生、急诊科","定期更新：医生联系方式、验血报告","门脉高压患者需特别注意饮食安全"]}),s.includes("obstruction")&&e.push({title:"肠梗阻日常管理",dietManagement:{recommended:["流质食物：米汤、蛋花汤、清汤面条","半流质：稀粥、蒸蛋羹、软烂面条","易消化蛋白：鱼肉、鸡蛋、豆腐","温热饮品：温开水、淡茶水、温牛奶"],avoided:["难消化食物：糯米、年糕、粽子、汤圆","高纤维食物：芹菜、韭菜、豆皮、玉米","坚硬食物：坚果、硬糖、骨头","易胀气食物：豆类、洋葱、碳酸饮料","冰冷食物：冰淇淋、冰水、冷饮"]},medicationSafety:["避免使用：阿片类止痛药（减慢肠蠕动）","谨慎使用：抗胆碱药物（654-2、阿托品等）","注意药物：钙通道阻滞剂","任何新药使用前咨询医生"],activityGuidance:{recommended:["餐后散步（30分钟后）","腹式呼吸练习","轻柔的腹部按摩（顺时针）","适度的瑜伽伸展"],avoided:["剧烈运动（跑步、跳跃）","重体力劳动","长时间久坐或卧床","腹部剧烈按压"]},monitoringIndicators:["每日观察：排便频率、腹胀程度","每周检查：腹痛情况、食欲变化","定期复查：腹部CT或B超","注意症状：停止排气、呕吐重新出现"],specialNotes:["肠梗阻会多次出现，第一次处理大致一样","手术难度逐次增加，需要经验丰富的医生","二级医院成立了肠梗阻专科，但口碑参差不齐","复发梗阻可考虑有经验的专科医生"]}),s.includes("biliary")&&e.push({title:"胆道梗阻日常管理",dietManagement:{recommended:["低脂饮食：清淡、易消化的食物","高蛋白：鱼肉、鸡胸肉、豆腐","新鲜蔬菜：煮熟的蔬菜","充足水分：温开水、淡茶"],avoided:["高脂食物：油炸食品、肥肉","辛辣刺激：辣椒、酒精","胆固醇高：动物内脏、蛋黄","难消化：坚果、粗糙食物"]},medicationSafety:["避免使用：对肝脏有损害的药物","谨慎使用：解热镇痛药","定期监测：肝功能指标","中药使用需咨询医生"],monitoringIndicators:["每日观察：皮肤颜色、尿色变化","每周监测：体温、食欲情况","定期检查：肝功能、腹部B超","注意症状：腹痛、黄疸、发热"]}),s.includes("infection")&&e.push({title:"感染日常管理",dietManagement:{recommended:["高蛋白：鸡蛋、鱼肉、瘦肉","丰富维生素：新鲜水果蔬菜","充足水分：温开水、汤类","易消化：粥类、面条"],avoided:["生冷食物：生鱼片、生肉","不洁食物：街头小吃","过度加工：罐头、腌制食品","刺激性食物：辛辣、酒精"]},medicationSafety:["避免自行使用抗生素","按时完成处方抗生素疗程","注意药物过敏反应","定期复查血常规"],monitoringIndicators:["每日监测：体温变化","观察症状：感染部位红肿热痛","注意体征：寒战、出汗","定期检查：血常规、C反应蛋白"]}),s.includes("ascites")&&e.push({title:"腹水日常管理",dietManagement:{recommended:["低盐饮食：每日盐分<3g","优质蛋白：鱼肉、鸡蛋、瘦肉","适量水分：控制每日液体摄入","易消化：软烂、清淡食物"],avoided:["高盐食物：咸菜、腊肉","大量饮水：超过医生建议量","酒精饮料：加重肝脏负担","难消化：油腻、粗糙食物"]},medicationSafety:["按时服用利尿剂","监测电解质平衡","避免使用肾毒性药物","定期复查肝肾功能"],activityGuidance:{recommended:["轻度活动：短距离散步","休息时抬高下肢","避免长时间站立","半坐卧位休息"],avoided:["剧烈运动","重体力劳动","长时间久坐","腹部压迫"]},monitoringIndicators:["每日测量：体重、腹围","观察症状：呼吸困难程度","注意体征：下肢水肿","定期检查：腹部B超、电解质"]}),s.includes("thrombosis")&&e.push({title:"血栓日常管理",dietManagement:{recommended:["清淡饮食：蔬菜、水果","富含纤维：全谷物、豆类","适量蛋白：鱼肉、瘦肉","充足水分：每日2000ml左右"],avoided:["高脂食物：动物内脏、油炸食品","高糖食物：甜点、饮料","过量维生素K：深绿色蔬菜","酒精：影响药物代谢"]},medicationSafety:["按时服用抗凝药物","定期监测凝血功能","避免自行调整药量","注意药物相互作用"],activityGuidance:{recommended:["适度运动：散步、游泳","避免久坐：每小时活动5分钟","穿弹力袜：预防深静脉血栓","肢体按摩：轻柔按摩"],avoided:["剧烈运动","长时间静止不动","过度劳累","肢体受压"]},monitoringIndicators:["每日观察：肢体肿胀、疼痛","注意症状：肢体颜色、温度变化","定期检查：血管超声","监测指标：凝血酶原时间"]}),e})(),S=(()=>{let e=[];return e.push({title:"辅助服务",emergencyContacts:["120急救：120","主治医生：".concat(l.mainDiagnosis?"专科医生":"未填写"),"紧急联系人：".concat(n.length>0?n[0].name+" "+n[0].phone:"未填写")],hospitalInfo:d.map(e=>"".concat(e.name,"：").concat(e.emergency,"（").concat(e.address,"）")),nursingServices:["专业护理机构：提供24小时陪护服务","社区医疗：提供基础医疗支持","康复中心：提供专业康复指导","心理咨询：提供心理支持服务"],nursingServiceDetails:c,symptomRecords:o,medicalInfoCard:{fields:["姓名：".concat(l.name||"未填写"),"血型：".concat(l.bloodType||"未填写"),"年龄：".concat(l.age||"未填写"),"主要诊断：".concat(l.mainDiagnosis||"未填写"),"过敏史：".concat(l.allergies||"未填写"),"抗凝治疗：".concat(l.isOnAnticoagulation?"是":"否"),"紧急联系人：".concat(n.length>0?n[0].name+" "+n[0].phone:"未填写"),"指定医院：".concat(d.length>0?d[0].name:"未填写")]}}),e})(),D=(()=>{let e=[];return s.includes("obstruction")&&(e.push({category:"生命体征相关",title:"肠梗阻生命体征",items:[{term:"肠鸣音",definition:"肠道蠕动时产生的声音，通过听诊器听取",significance:"消失：提示肠麻痹；亢进：提示机械性梗阻"},{term:"腹膜刺激征",definition:"腹部压痛、反跳痛、肌紧张三联征",significance:"阳性：提示肠坏死或穿孔，需紧急手术"}]}),e.push({category:"影像学相关",title:"肠梗阻影像学表现",items:[{term:"液气平面",definition:"立位腹部X线片中肠管内可见液面和气体分层",significance:"典型肠梗阻征象，多个液平提示完全性梗阻"},{term:"移行带征象",definition:"CT扫描中扩张肠管向正常肠管的移行区域",significance:"可确定梗阻部位和原因，是诊断的金标准"}]}),e.push({category:"临床分型",title:"肠梗阻分类",items:[{term:"机械性肠梗阻",definition:"肠腔被机械性因素阻塞",significance:"常见原因：粘连、肿瘤、疝气、肠扭转"},{term:"麻痹性肠梗阻",definition:"肠管失去蠕动功能",significance:"常见原因：手术后、电解质紊乱、感染"}]})),s.includes("bleeding")&&(e.push({category:"生命体征相关",title:"消化道出血生命体征",items:[{term:"收缩压(SBP)",definition:"心脏收缩时动脉血压最高值",significance:"＜90mmHg：休克临界值，提示失血＞20%"},{term:"GCS评分",definition:"格拉斯哥昏迷指数（3-15分）",significance:"≤13分：意识障碍，需防误吸"}]}),e.push({category:"出血特征",title:"消化道出血特征",items:[{term:"咖啡渣样呕血",definition:"深褐色颗粒状呕吐物",significance:"提示血液在胃内停留＞4小时，相对低危"},{term:"鲜红色呕血",definition:"未经胃酸作用的鲜红血液",significance:"高危！提示动脉活动性出血"}]}),e.push({category:"风险分层工具",title:"消化道出血风险评估",items:[{term:"Rockall评分",definition:"上消化道出血死亡风险预测",significance:"≥5分：死亡率＞30%"},{term:"Child-Pugh分级",definition:"肝硬化严重程度评估",significance:"C级：1年生存率＜45%"}]})),e})();return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(r.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex justify-center gap-4",children:[(0,t.jsxs)(N,{onClick:g,disabled:x,className:"flex items-center gap-2 bg-red-500 hover:bg-red-600",children:[x?(0,t.jsx)(r.P.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:(0,t.jsx)(ee.A,{className:"h-4 w-4"})}):(0,t.jsx)(k.A,{className:"h-4 w-4"}),x?"生成中...":"下载卡片"]}),(0,t.jsxs)(N,{onClick:()=>{navigator.share?navigator.share({title:"我的小红卡",text:"并发症管理指引卡片",url:window.location.href}):alert("分享功能已准备就绪！")},variant:"outline",className:"flex items-center gap-2",children:[(0,t.jsx)(et.A,{className:"h-4 w-4"}),"分享"]})]}),(0,t.jsxs)(r.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},ref:m,className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-red-500 to-pink-500 text-white p-6 border-2 border-red-500",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"bg-white rounded-full p-2",children:(0,t.jsx)(w.A,{className:"h-6 w-6 text-red-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"小红卡"}),(0,t.jsx)("p",{className:"text-red-100",children:"并发症管理指引"})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-sm text-red-100",children:"生成时间"}),(0,t.jsx)("div",{className:"text-sm font-medium",children:new Date().toLocaleDateString("zh-CN")})]})]})}),(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(Z.A,{className:"h-5 w-5 text-red-500"}),(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"患者信息"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"姓名"}),(0,t.jsx)("div",{className:"font-medium",children:l.name||"未填写"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"年龄"}),(0,t.jsx)("div",{className:"font-medium",children:l.age||"未填写"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"血型"}),(0,t.jsx)("div",{className:"font-medium",children:l.bloodType||"未填写"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"主要诊断"}),(0,t.jsx)("div",{className:"font-medium",children:l.mainDiagnosis||"未填写"})]})]}),l.isOnAnticoagulation&&(0,t.jsxs)(r.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-4 p-3 bg-red-50 dark:bg-red-950 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(Y.A,{className:"h-4 w-4 text-red-500"}),(0,t.jsx)("span",{className:"font-medium text-red-700 dark:text-red-300",children:"抗凝治疗信息"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"药物种类："}),(0,t.jsx)("span",{className:"font-medium",children:l.medicationType})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"最后服用："}),(0,t.jsx)("span",{className:"font-medium",children:l.lastTaken})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"停药原因："}),(0,t.jsx)("span",{className:"font-medium",children:l.stopReason})]})]})]})]}),(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)("div",{className:"bg-red-100 rounded-full p-1",children:(0,t.jsx)(ei.A,{className:"h-5 w-5 text-red-500"})}),(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"\uD83C\uDD98 急救指导步骤"})]}),(0,t.jsx)("div",{className:"space-y-4",children:v.map((e,s)=>(0,t.jsxs)(r.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1*s},className:"bg-red-50 dark:bg-red-950 rounded-lg p-4 border-l-4 border-red-500",children:[(0,t.jsx)("h3",{className:"font-semibold text-red-700 dark:text-red-300 mb-3",children:e.title}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"处理步骤："}),(0,t.jsx)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-600 dark:text-gray-400",children:e.steps.map((e,s)=>(0,t.jsx)("li",{children:e},s))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"注意事项："}),(0,t.jsx)("ul",{className:"list-disc list-inside space-y-1 text-sm text-red-600 dark:text-red-400",children:e.warnings.map((e,s)=>(0,t.jsx)("li",{children:e},s))})]}),e.emergencyCall&&(0,t.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-950 rounded-lg p-3",children:[(0,t.jsx)("h4",{className:"font-medium text-blue-700 dark:text-blue-300 mb-2",children:"\uD83D\uDCDE 120急救话术模板"}),(0,t.jsx)("p",{className:"text-sm text-blue-600 dark:text-blue-400 whitespace-pre-line",children:e.emergencyCall.replace(/\[姓名\]/g,l.name||"未填写").replace(/\[年龄\]/g,l.age||"未填写").replace(/\[血型\]/g,l.bloodType||"未填写").replace(/\[主要疾病\]/g,l.mainDiagnosis||"未填写").replace(/\[过敏史\]/g,l.allergies||"未填写").replace(/\[既往病史\]/g,l.surgeryHistory||"未填写")})]}),e.criticalInfo&&(0,t.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-950 rounded-lg p-3",children:[(0,t.jsx)("h4",{className:"font-medium text-yellow-700 dark:text-yellow-300 mb-2",children:"\uD83D\uDD34 关键信息卡"}),(0,t.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400 space-y-1",children:e.criticalInfo.map((e,s)=>(0,t.jsx)("p",{children:e.replace(/\[姓名\]/g,l.name||"未填写").replace(/\[年龄\]/g,l.age||"未填写").replace(/\[血型\]/g,l.bloodType||"未填写").replace(/\[主要疾病\]/g,l.mainDiagnosis||"未填写").replace(/\[过敏史\]/g,l.allergies||"未填写").replace(/\[相关风险因素\]/g,l.otherDiseases||"未填写").replace(/\[是\/否\]/g,l.isOnAnticoagulation?"是":"否")},s))})]})]})]},s))})]}),A.length>0&&(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)("div",{className:"bg-blue-100 rounded-full p-1",children:(0,t.jsx)(er.A,{className:"h-5 w-5 text-blue-500"})}),(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"\uD83D\uDD0D 病情诊断关键指引"})]}),(0,t.jsx)("div",{className:"space-y-4",children:A.map((e,s)=>(0,t.jsxs)(r.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1*s},className:"bg-blue-50 dark:bg-blue-950 rounded-lg p-4 border-l-4 border-blue-500",children:[(0,t.jsx)("h3",{className:"font-semibold text-blue-700 dark:text-blue-300 mb-3",children:e.title}),(0,t.jsx)("ul",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:e.points.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-start gap-2",children:[(0,t.jsx)("span",{className:"text-blue-500 mt-1",children:"•"}),(0,t.jsx)("span",{children:e})]},s))}),e.riskFactors&&(0,t.jsxs)("div",{className:"mt-4 bg-red-50 dark:bg-red-950 rounded-lg p-3",children:[(0,t.jsx)("h4",{className:"font-medium text-red-700 dark:text-red-300 mb-2",children:"⚠️ 风险评估体系"}),(0,t.jsx)("div",{className:"text-sm text-red-600 dark:text-red-400 whitespace-pre-line",children:e.riskFactors.join("\n")})]}),e.monitoringTable&&(0,t.jsxs)("div",{className:"mt-4 bg-green-50 dark:bg-green-950 rounded-lg p-3",children:[(0,t.jsx)("h4",{className:"font-medium text-green-700 dark:text-green-300 mb-2",children:e.monitoringTable.title}),(0,t.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400 whitespace-pre-line",children:e.monitoringTable.fields.join("\n")})]})]},s))})]}),C.length>0&&(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)("div",{className:"bg-green-100 rounded-full p-1",children:(0,t.jsx)(X.A,{className:"h-5 w-5 text-green-500"})}),(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"\uD83C\uDFE0 日常注意和预防"})]}),(0,t.jsx)("div",{className:"space-y-6",children:C.map((e,a)=>(0,t.jsxs)(r.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1*a},className:"bg-green-50 dark:bg-green-950 rounded-lg p-4 border-l-4 border-green-500",children:[(0,t.jsx)("h3",{className:"font-semibold text-green-700 dark:text-green-300 mb-4",children:e.title}),e.dietManagement&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"\uD83C\uDF4E 饮食管理"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"bg-green-100 dark:bg-green-900 rounded-lg p-3",children:[(0,t.jsx)("h5",{className:"font-medium text-green-700 dark:text-green-300 mb-2",children:"推荐食物"}),(0,t.jsx)("ul",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:e.dietManagement.recommended.map((e,s)=>(0,t.jsxs)("li",{children:["• ",e]},s))})]}),(0,t.jsxs)("div",{className:"bg-red-100 dark:bg-red-900 rounded-lg p-3",children:[(0,t.jsx)("h5",{className:"font-medium text-red-700 dark:text-red-300 mb-2",children:"避免食物"}),(0,t.jsx)("ul",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:e.dietManagement.avoided.map((e,s)=>(0,t.jsxs)("li",{children:["• ",e]},s))})]})]})]}),e.medicationSafety&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"\uD83D\uDC8A 用药安全指导"}),(0,t.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-950 rounded-lg p-3",children:(0,t.jsx)("ul",{className:"text-sm text-yellow-700 dark:text-yellow-300 space-y-1",children:e.medicationSafety.map((e,s)=>(0,t.jsxs)("li",{children:["• ",e]},s))})})]}),e.activityGuidance&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"\uD83C\uDFC3‍♂️ 运动和生活方式"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-950 rounded-lg p-3",children:[(0,t.jsx)("h5",{className:"font-medium text-blue-700 dark:text-blue-300 mb-2",children:"适宜活动"}),(0,t.jsx)("ul",{className:"text-sm text-blue-600 dark:text-blue-400 space-y-1",children:e.activityGuidance.recommended.map((e,s)=>(0,t.jsxs)("li",{children:["• ",e]},s))})]}),(0,t.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-950 rounded-lg p-3",children:[(0,t.jsx)("h5",{className:"font-medium text-orange-700 dark:text-orange-300 mb-2",children:"避免活动"}),(0,t.jsx)("ul",{className:"text-sm text-orange-600 dark:text-orange-400 space-y-1",children:e.activityGuidance.avoided.map((e,s)=>(0,t.jsxs)("li",{children:["• ",e]},s))})]})]})]}),e.monitoringIndicators&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"\uD83D\uDCCA 定期监测指标"}),(0,t.jsx)("div",{className:"bg-purple-50 dark:bg-purple-950 rounded-lg p-3",children:(0,t.jsx)("ul",{className:"text-sm text-purple-700 dark:text-purple-300 space-y-1",children:e.monitoringIndicators.map((e,s)=>(0,t.jsxs)("li",{children:["• ",e]},s))})})]}),e.specialNotes&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"⚠️ 特别提醒"}),(0,t.jsx)("div",{className:"bg-red-50 dark:bg-red-950 rounded-lg p-3",children:(0,t.jsx)("ul",{className:"text-sm text-red-700 dark:text-red-300 space-y-1",children:e.specialNotes.map((e,s)=>(0,t.jsxs)("li",{children:["• ",e]},s))})})]}),s.includes("obstruction")&&(0,t.jsxs)("div",{className:"mt-4 bg-orange-50 dark:bg-orange-950 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-orange-700 dark:text-orange-300 mb-2",children:"⚠️ 肠梗阻患者特别注意"}),(0,t.jsx)("p",{className:"text-sm text-orange-600 dark:text-orange-400",children:"肠梗阻会多次出现，第一次处理大致一样，因此选择三甲医院，但是后续情况会越来越难，尤其是小肠梗阻等情况，导管也不太好处理。 复发性肠梗阻手术难度逐次增加，需要经验丰富的医生，可能需要肠切除重建，技术要求高。"})]}),s.includes("bleeding")&&(0,t.jsxs)("div",{className:"mt-4 bg-red-50 dark:bg-red-950 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-red-700 dark:text-red-300 mb-2",children:"⚠️ 消化道出血患者特别注意"}),(0,t.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:"曲张静脉表面仅覆盖0.1-0.3mm薄层黏膜（正常1-2mm），任何机械刺激施加>20mmHg压力即可引发致命性出血， 临床数据显示30%急性上消化道出血与摄入坚果相关。"})]})]},a))})]}),S.length>0&&(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)("div",{className:"bg-purple-100 rounded-full p-1",children:(0,t.jsx)(ei.A,{className:"h-5 w-5 text-purple-500"})}),(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"\uD83E\uDD1D 辅助服务"})]}),(0,t.jsx)("div",{className:"space-y-6",children:S.map((e,s)=>(0,t.jsxs)(r.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1*s},className:"bg-purple-50 dark:bg-purple-950 rounded-lg p-4 border-l-4 border-purple-500",children:[e.emergencyContacts&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"\uD83D\uDCDE 紧急联系网络"}),(0,t.jsx)("div",{className:"bg-red-50 dark:bg-red-950 rounded-lg p-3",children:(0,t.jsx)("ul",{className:"text-sm text-red-700 dark:text-red-300 space-y-1",children:e.emergencyContacts.map((e,s)=>(0,t.jsxs)("li",{children:["• ",e]},s))})})]}),e.hospitalInfo&&e.hospitalInfo.length>0&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"\uD83C\uDFE5 医院信息"}),(0,t.jsx)("div",{className:"bg-blue-50 dark:bg-blue-950 rounded-lg p-3",children:(0,t.jsx)("ul",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-1",children:e.hospitalInfo.map((e,s)=>(0,t.jsxs)("li",{children:["• ",e]},s))})})]}),e.nursingServices&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"\uD83D\uDC69‍⚕️ 护理服务"}),(0,t.jsxs)("div",{className:"bg-green-50 dark:bg-green-950 rounded-lg p-3",children:[(0,t.jsx)("ul",{className:"text-sm text-green-700 dark:text-green-300 space-y-1 mb-3",children:e.nursingServices.map((e,s)=>(0,t.jsxs)("li",{children:["• ",e]},s))}),e.nursingServiceDetails&&e.nursingServiceDetails.length>0&&(0,t.jsxs)("div",{className:"border-t border-green-200 dark:border-green-800 pt-3",children:[(0,t.jsx)("h5",{className:"font-medium text-green-700 dark:text-green-300 mb-2",children:"已添加的护理服务："}),(0,t.jsx)("div",{className:"space-y-2",children:e.nursingServiceDetails.map((e,s)=>(0,t.jsxs)("div",{className:"bg-white dark:bg-green-900 rounded p-2 text-xs",children:[(0,t.jsx)("div",{className:"font-medium",children:e.provider}),(0,t.jsxs)("div",{className:"text-green-600 dark:text-green-400",children:["联系方式：",e.contact]}),(0,t.jsxs)("div",{className:"text-green-600 dark:text-green-400",children:["价格：",e.price]}),e.features&&(0,t.jsxs)("div",{className:"text-green-600 dark:text-green-400",children:["特色：",e.features]})]},s))})]})]})]}),e.symptomRecords&&e.symptomRecords.length>0&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"\uD83D\uDCCA 症状记录"}),(0,t.jsx)("div",{className:"bg-blue-50 dark:bg-blue-950 rounded-lg p-3",children:(0,t.jsx)("div",{className:"space-y-2",children:e.symptomRecords.map((e,s)=>(0,t.jsx)("div",{className:"bg-white dark:bg-blue-900 rounded p-2 text-xs",children:(0,t.jsx)("div",{className:"flex justify-between items-start",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.symptom}),(0,t.jsxs)("div",{className:"text-blue-600 dark:text-blue-400",children:["日期：",e.date]}),(0,t.jsxs)("div",{className:"text-blue-600 dark:text-blue-400",children:["严重程度：",e.severity]}),e.description&&(0,t.jsxs)("div",{className:"text-blue-600 dark:text-blue-400 mt-1",children:["描述：",e.description]})]})})},s))})})]}),e.medicalInfoCard&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"\uD83C\uDD94 个人医疗信息卡"}),(0,t.jsx)("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-3",children:(0,t.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-1",children:e.medicalInfoCard.fields.map((e,s)=>(0,t.jsx)("p",{children:e},s))})})]})]},s))})]}),(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)("div",{className:"bg-purple-100 rounded-full p-1",children:(0,t.jsx)(er.A,{className:"h-5 w-5 text-purple-500"})}),(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"\uD83D\uDCCB 个人医疗信息卡"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"基本信息"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"姓名："}),(0,t.jsx)("span",{className:"font-medium",children:l.name||"未填写"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"血型："}),(0,t.jsx)("span",{className:"font-medium",children:l.bloodType||"未填写"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"年龄："}),(0,t.jsx)("span",{className:"font-medium",children:l.age||"未填写"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"联系电话："}),(0,t.jsx)("span",{className:"font-medium",children:n.length>0?n[0].phone:"未填写"})]})]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"疾病史"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"主要诊断："}),(0,t.jsx)("span",{className:"font-medium",children:l.mainDiagnosis||"未填写"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"既往手术："}),(0,t.jsx)("span",{className:"font-medium",children:l.surgeryHistory||"未填写"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"药物过敏："}),(0,t.jsx)("span",{className:"font-medium",children:l.allergies||"未填写"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"其他疾病："}),(0,t.jsx)("span",{className:"font-medium",children:l.otherDiseases||"未填写"})]})]})]}),l.isOnAnticoagulation&&(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"抗凝治疗史"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"是否正在抗凝治疗："}),(0,t.jsx)("span",{className:"font-medium",children:"是"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"抗凝药物种类："}),(0,t.jsx)("span",{className:"font-medium",children:l.medicationType})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"最后服用时间："}),(0,t.jsx)("span",{className:"font-medium",children:l.lastTaken})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"停药原因："}),(0,t.jsx)("span",{className:"font-medium",children:l.stopReason})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"近期用药史（7天内）"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:p.slice(0,6).map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:e.taken,onChange:()=>f(s),className:"rounded border-gray-300 text-red-500 focus:ring-red-500"}),(0,t.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.name})]},s))}),p.length>6&&(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:p.slice(6).map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:e.taken,onChange:()=>f(s+6),className:"rounded border-gray-300 text-red-500 focus:ring-red-500"}),(0,t.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.name}),(0,t.jsx)("button",{onClick:()=>b(s+6),className:"text-red-500 hover:text-red-700 text-xs",children:"\xd7"})]},s+6))}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:j,onChange:e=>y(e.target.value),placeholder:"添加自定义药物",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,t.jsx)("button",{onClick:()=>{j.trim()&&(u([...p,{name:j.trim(),taken:!1}]),y(""))},className:"px-3 py-2 bg-red-500 text-white rounded-md text-sm hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500",children:"添加"})]})]})]})]})]}),(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)("div",{className:"bg-indigo-100 rounded-full p-1",children:(0,t.jsx)(er.A,{className:"h-5 w-5 text-indigo-500"})}),(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"\uD83D\uDCDA 医学术语速查表"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[D.map((e,s)=>(0,t.jsxs)("div",{className:"bg-indigo-50 dark:bg-indigo-950 rounded-lg p-4",children:[(0,t.jsx)("h3",{className:"font-medium text-indigo-700 dark:text-indigo-300 mb-3",children:e.title}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-indigo-200 dark:border-indigo-800",children:[(0,t.jsx)("th",{className:"text-left py-2",children:"术语"}),(0,t.jsx)("th",{className:"text-left py-2",children:"定义"}),(0,t.jsx)("th",{className:"text-left py-2",children:"临床意义"})]})}),(0,t.jsx)("tbody",{children:e.items.map((e,s)=>(0,t.jsxs)("tr",{className:"border-b border-indigo-100 dark:border-indigo-900",children:[(0,t.jsx)("td",{className:"py-2 font-medium",children:e.term}),(0,t.jsx)("td",{className:"py-2",children:e.definition}),(0,t.jsx)("td",{className:"py-2 text-indigo-600 dark:text-indigo-400",children:e.significance})]},s))})]})})]},s)),0===D.length&&(0,t.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:(0,t.jsx)("p",{children:"请选择并发症类型以显示相关的医学术语速查表"})})]})]}),(0,t.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 text-center",children:(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"\xa9 2024 小红卡 - 为您的健康保驾护航，由小红卡开源社区 x 小x宝社区联合提供公益服务"})})]}),(0,t.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},className:"bg-blue-50 dark:bg-blue-950 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(Y.A,{className:"h-5 w-5 text-blue-500"}),(0,t.jsx)("span",{className:"font-medium text-blue-700 dark:text-blue-300",children:"使用提示"})]}),(0,t.jsxs)("ul",{className:"text-sm text-blue-600 dark:text-blue-400 space-y-1",children:[(0,t.jsx)("li",{children:"• 请将此卡片保存在手机中，以便紧急情况下快速查看"}),(0,t.jsx)("li",{children:"• 建议打印一份纸质卡片放在钱包或包中"}),(0,t.jsx)("li",{children:"• 定期更新个人信息和联系方式"}),(0,t.jsx)("li",{children:"• 如有任何疑问，请及时咨询专业医生"})]})]})]})}let en=[{id:"bleeding",name:"消化道出血",description:"呕血、黑便等症状的紧急处理"},{id:"obstruction",name:"肠梗阻",description:"腹痛、呕吐、腹胀等症状的紧急处理"},{id:"biliary",name:"胆道梗阻",description:"黄疸、发热等症状管理"},{id:"infection",name:"感染",description:"发热、感染征象监测"},{id:"ascites",name:"腹水",description:"腹胀、腹水症状管理"},{id:"thrombosis",name:"血栓",description:"血栓形成预防和处理"}];function ed(){let[e,s]=(0,i.useState)(0),[a,l]=(0,i.useState)([]),[n,d]=(0,i.useState)({name:"",age:"",bloodType:"",mainDiagnosis:"",surgeryHistory:"",allergies:"",otherDiseases:"",isOnAnticoagulation:!1,medicationType:"",lastTaken:"",stopReason:""}),[c,o]=(0,i.useState)([]),[m,h]=(0,i.useState)([]),[g,p]=(0,i.useState)([]),[j,y]=(0,i.useState)([]),[f,v]=(0,i.useState)({name:"",phone:"",relationship:""}),[A,C]=(0,i.useState)({name:"",emergency:"",address:"",features:""}),[S,D]=(0,i.useState)({provider:"",contact:"",price:"",features:""}),[_,z]=(0,i.useState)({date:"",symptom:"",severity:"",description:""});(0,i.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("selectedComplications")||"[]"),s=JSON.parse(localStorage.getItem("medicalInfo")||"{}"),a=JSON.parse(localStorage.getItem("emergencyContacts")||"[]"),t=JSON.parse(localStorage.getItem("hospitals")||"[]"),i=JSON.parse(localStorage.getItem("nursingServices")||"[]"),r=JSON.parse(localStorage.getItem("symptomRecords")||"[]");e.length>0&&l(e),Object.keys(s).length>0&&d(s),a.length>0&&o(a),t.length>0&&h(t),i.length>0&&p(i),r.length>0&&y(r)},[]),(0,i.useEffect)(()=>{let e=e=>{s(e.detail)};return window.addEventListener("goToStep",e),()=>{window.removeEventListener("goToStep",e)}},[]),(0,i.useEffect)(()=>{localStorage.setItem("selectedComplications",JSON.stringify(a))},[a]),(0,i.useEffect)(()=>{localStorage.setItem("medicalInfo",JSON.stringify(n))},[n]),(0,i.useEffect)(()=>{localStorage.setItem("emergencyContacts",JSON.stringify(c))},[c]),(0,i.useEffect)(()=>{localStorage.setItem("hospitals",JSON.stringify(m))},[m]),(0,i.useEffect)(()=>{localStorage.setItem("nursingServices",JSON.stringify(g))},[g]),(0,i.useEffect)(()=>{localStorage.setItem("symptomRecords",JSON.stringify(j))},[j]);let M=e=>{a.includes(e)?l(a.filter(s=>s!==e)):l([...a,e])},O=(e,s)=>{d({...n,[e]:s})},F=()=>{f.name&&f.phone&&f.relationship&&(o([...c,f]),v({name:"",phone:"",relationship:""}))},K=e=>{let s=[...c];s.splice(e,1),o(s)},V=()=>{A.name&&A.emergency&&A.address&&(h([...m,A]),C({name:"",emergency:"",address:"",features:""}))},B=e=>{let s=[...m];s.splice(e,1),h(s)},et=()=>{S.provider&&S.contact&&S.price&&(p([...g,S]),D({provider:"",contact:"",price:"",features:""}))},ei=e=>{let s=[...g];s.splice(e,1),p(s)},er=()=>{_.date&&_.symptom&&_.severity&&(y([...j,_]),z({date:"",symptom:"",severity:"",description:""}))},ed=e=>{let s=[...j];s.splice(e,1),y(s)},ec=[{title:"选择并发症类型",icon:X.A},{title:"填写个人医疗信息",icon:Z.A},{title:"添加紧急联系人和医院信息",icon:W.A},{title:"填写护理服务和症状记录",icon:w.A},{title:"预览和下载",icon:k.A}];return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"mb-6 sm:mb-8",children:[(0,t.jsx)("div",{className:"flex justify-between items-center mb-3 sm:mb-4",children:ec.map((a,i)=>(0,t.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*i},className:"flex flex-col items-center flex-1 px-1",children:(0,t.jsx)(r.P.div,{className:"w-8 h-8 sm:w-12 sm:h-12 rounded-full flex items-center justify-center transition-all duration-300 flex-shrink-0 cursor-pointer ".concat(e>=i?"bg-red-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-500"),whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>s(i),children:(0,t.jsx)(a.icon,{className:"h-4 w-4 sm:h-6 sm:w-6 flex-shrink-0"})})},i))}),(0,t.jsx)("div",{className:"flex justify-between items-start mt-1 sm:mt-2",children:ec.map((a,i)=>(0,t.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*i},className:"flex-1 px-2 text-center",children:(0,t.jsx)("span",{className:"text-xs sm:text-sm font-medium leading-tight break-words inline-block max-w-full px-1 cursor-pointer transition-colors duration-200 ".concat(e>=i?"text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),onClick:()=>s(i),children:a.title})},i))})]}),(0,t.jsx)("div",{className:"min-h-[350px] sm:min-h-[400px]",children:(0,t.jsx)(I.N,{mode:"wait",children:(()=>{switch(e){case 0:return(0,t.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-200",children:"选择并发症类型"}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:en.map((e,s)=>(0,t.jsx)(r.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1*s},className:"relative cursor-pointer transition-all duration-300 ".concat(a.includes(e.id)?"ring-2 ring-red-500 bg-red-50 dark:bg-red-950":"hover:shadow-lg"),onClick:()=>M(e.id),children:(0,t.jsx)(x,{className:"h-full",children:(0,t.jsx)(u,{className:"p-3 sm:p-4",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(U,{checked:a.includes(e.id),onChange:()=>{},className:"mt-1"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-1 text-sm sm:text-base",children:e.name}),(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 leading-relaxed",children:e.description})]})]})})})},e.id))})]})});case 1:return(0,t.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"space-y-4 sm:space-y-6",children:[(0,t.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-200",children:"填写个人医疗信息"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(P,{htmlFor:"name",className:"flex items-center gap-2",children:["姓名 ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(T,{id:"name",value:n.name,onChange:e=>O("name",e.target.value),placeholder:"请填写患者真实姓名"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"age",children:"年龄"}),(0,t.jsx)(T,{id:"age",value:n.age,onChange:e=>O("age",e.target.value),placeholder:"请填写患者年龄"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(P,{htmlFor:"bloodType",className:"flex items-center gap-2",children:["血型 ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)(L,{value:n.bloodType,onValueChange:e=>O("bloodType",e),children:[(0,t.jsx)(R,{children:(0,t.jsx)(J,{placeholder:"请选择血型"})}),(0,t.jsxs)(G,{children:[(0,t.jsx)(H,{value:"A型",children:"A型"}),(0,t.jsx)(H,{value:"B型",children:"B型"}),(0,t.jsx)(H,{value:"AB型",children:"AB型"}),(0,t.jsx)(H,{value:"O型",children:"O型"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"mainDiagnosis",children:"主要诊断"}),(0,t.jsx)(T,{id:"mainDiagnosis",value:n.mainDiagnosis,onChange:e=>O("mainDiagnosis",e.target.value),placeholder:"如：胰腺癌、胃癌等"})]}),(0,t.jsxs)("div",{className:"sm:col-span-2 space-y-2",children:[(0,t.jsx)(P,{htmlFor:"surgeryHistory",children:"手术史"}),(0,t.jsx)(E,{id:"surgeryHistory",value:n.surgeryHistory,onChange:e=>O("surgeryHistory",e.target.value),placeholder:"请填写手术史",className:"min-h-[80px] sm:min-h-[100px]"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"allergies",children:"过敏史"}),(0,t.jsx)(T,{id:"allergies",value:n.allergies,onChange:e=>O("allergies",e.target.value),placeholder:"请填写过敏史"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"otherDiseases",children:"其他疾病"}),(0,t.jsx)(T,{id:"otherDiseases",value:n.otherDiseases,onChange:e=>O("otherDiseases",e.target.value),placeholder:"请填写其他疾病"})]}),(0,t.jsxs)("div",{className:"sm:col-span-2 space-y-2",children:[(0,t.jsxs)(P,{className:"flex items-center gap-2",children:[(0,t.jsx)(Y.A,{className:"h-4 w-4 text-red-500"}),"抗凝治疗信息"]}),(0,t.jsxs)(L,{value:n.isOnAnticoagulation?"true":"false",onValueChange:e=>O("isOnAnticoagulation","true"===e),children:[(0,t.jsx)(R,{children:(0,t.jsx)(J,{})}),(0,t.jsxs)(G,{children:[(0,t.jsx)(H,{value:"false",children:"否"}),(0,t.jsx)(H,{value:"true",children:"是"})]})]})]}),n.isOnAnticoagulation&&(0,t.jsx)(r.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"sm:col-span-2 space-y-3 sm:space-y-4 border-l-4 border-red-500 pl-3 sm:pl-4 bg-red-50 dark:bg-red-950 p-3 sm:p-4 rounded",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"medicationType",children:"抗凝药物种类"}),(0,t.jsx)(T,{id:"medicationType",value:n.medicationType,onChange:e=>O("medicationType",e.target.value),placeholder:"请填写抗凝药物种类"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"lastTaken",children:"最后服用时间"}),(0,t.jsx)(T,{id:"lastTaken",value:n.lastTaken,onChange:e=>O("lastTaken",e.target.value),placeholder:"请填写最后服用时间"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"stopReason",children:"停药原因"}),(0,t.jsx)(T,{id:"stopReason",value:n.stopReason,onChange:e=>O("stopReason",e.target.value),placeholder:"请填写停药原因"})]})]})})]})]});case 2:return(0,t.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"space-y-4 sm:space-y-6",children:[(0,t.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-200",children:"添加紧急联系人和医院信息"}),(0,t.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(Y.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-red-500"}),(0,t.jsx)("h3",{className:"text-base sm:text-lg font-semibold",children:"紧急联系人"})]}),c.map((e,s)=>(0,t.jsx)(r.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"relative",children:(0,t.jsx)(x,{className:"border-red-200 dark:border-red-800",children:(0,t.jsx)(u,{className:"p-3 sm:p-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(Z.A,{className:"h-4 w-4 text-red-500"}),(0,t.jsx)("span",{className:"font-semibold",children:e.name}),(0,t.jsx)(b,{variant:"secondary",children:e.relationship})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsx)(W.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:e.phone})]})]}),(0,t.jsx)(N,{variant:"ghost",size:"sm",onClick:()=>K(s),className:"text-red-500 hover:text-red-700",children:(0,t.jsx)(Q.A,{className:"h-4 w-4"})})]})})})},s)),(0,t.jsx)(x,{className:"border-dashed border-2 border-gray-300 dark:border-gray-600",children:(0,t.jsx)(u,{className:"p-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"contact-name",children:"姓名"}),(0,t.jsx)(T,{id:"contact-name",value:f.name,onChange:e=>v({...f,name:e.target.value}),placeholder:"请填写联系人姓名"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"contact-phone",children:"电话"}),(0,t.jsx)(T,{id:"contact-phone",value:f.phone,onChange:e=>v({...f,phone:e.target.value}),placeholder:"请填写联系人电话"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"contact-relationship",children:"关系"}),(0,t.jsx)(T,{id:"contact-relationship",value:f.relationship,onChange:e=>v({...f,relationship:e.target.value}),placeholder:"请填写与患者关系"})]})]}),(0,t.jsxs)(N,{onClick:F,className:"w-full",disabled:!f.name||!f.phone||!f.relationship,children:[(0,t.jsx)(q.A,{className:"h-4 w-4 mr-2"}),"添加紧急联系人"]})]})})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(Y.A,{className:"h-5 w-5 text-red-500"}),(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"医院信息"})]}),m.map((e,s)=>(0,t.jsx)(r.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"relative",children:(0,t.jsx)(x,{className:"border-blue-200 dark:border-blue-800",children:(0,t.jsx)(u,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)($.A,{className:"h-4 w-4 text-blue-500"}),(0,t.jsx)("span",{className:"font-semibold",children:e.name})]}),(0,t.jsxs)("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(W.A,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:["急诊: ",e.emergency]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)($.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:e.address})]}),e.features&&(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(b,{variant:"outline",children:e.features})})]})]}),(0,t.jsx)(N,{variant:"ghost",size:"sm",onClick:()=>B(s),className:"text-red-500 hover:text-red-700",children:(0,t.jsx)(Q.A,{className:"h-4 w-4"})})]})})})},s)),(0,t.jsx)(x,{className:"border-dashed border-2 border-gray-300 dark:border-gray-600",children:(0,t.jsx)(u,{className:"p-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"hospital-name",children:"医院名称"}),(0,t.jsx)(T,{id:"hospital-name",value:A.name,onChange:e=>C({...A,name:e.target.value}),placeholder:"请填写医院名称"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"hospital-emergency",children:"急诊电话"}),(0,t.jsx)(T,{id:"hospital-emergency",value:A.emergency,onChange:e=>C({...A,emergency:e.target.value}),placeholder:"请填写急诊电话"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"hospital-address",children:"地址"}),(0,t.jsx)(T,{id:"hospital-address",value:A.address,onChange:e=>C({...A,address:e.target.value}),placeholder:"请填写医院地址"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"hospital-features",children:"特色（选填）"}),(0,t.jsx)(T,{id:"hospital-features",value:A.features,onChange:e=>C({...A,features:e.target.value}),placeholder:"请填写医院特色"})]})]}),(0,t.jsxs)(N,{onClick:V,className:"w-full",disabled:!A.name||!A.emergency||!A.address,children:[(0,t.jsx)(q.A,{className:"h-4 w-4 mr-2"}),"添加医院信息"]})]})})})]})]});case 3:return(0,t.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"space-y-4 sm:space-y-6",children:[(0,t.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-200",children:"填写护理服务和症状记录"}),(0,t.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(w.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-red-500"}),(0,t.jsx)("h3",{className:"text-base sm:text-lg font-semibold",children:"护理服务"})]}),g.map((e,s)=>(0,t.jsx)(r.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"relative",children:(0,t.jsx)(x,{className:"border-green-200 dark:border-green-800",children:(0,t.jsx)(u,{className:"p-3 sm:p-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(w.A,{className:"h-4 w-4 text-green-500"}),(0,t.jsx)("span",{className:"font-semibold",children:e.provider})]}),(0,t.jsxs)("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(W.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:e.contact})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)($.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:e.price})]}),e.features&&(0,t.jsx)("p",{className:"text-xs mt-1",children:e.features})]})]}),(0,t.jsx)(N,{variant:"ghost",size:"sm",onClick:()=>ei(s),className:"text-red-500 hover:text-red-700",children:(0,t.jsx)(Q.A,{className:"h-4 w-4"})})]})})})},s)),(0,t.jsx)(x,{className:"border-dashed border-2 border-gray-300 dark:border-gray-600",children:(0,t.jsx)(u,{className:"p-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"nursing-provider",children:"服务机构"}),(0,t.jsx)(T,{id:"nursing-provider",value:S.provider,onChange:e=>D({...S,provider:e.target.value}),placeholder:"请填写护理服务机构名称"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"nursing-contact",children:"联系方式"}),(0,t.jsx)(T,{id:"nursing-contact",value:S.contact,onChange:e=>D({...S,contact:e.target.value}),placeholder:"请填写联系电话"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"nursing-price",children:"服务价格"}),(0,t.jsx)(T,{id:"nursing-price",value:S.price,onChange:e=>D({...S,price:e.target.value}),placeholder:"如：1对1护理 200元/天"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"nursing-features",children:"服务特色（选填）"}),(0,t.jsx)(T,{id:"nursing-features",value:S.features,onChange:e=>D({...S,features:e.target.value}),placeholder:"请填写服务特色"})]})]}),(0,t.jsxs)(N,{onClick:et,className:"w-full",disabled:!S.provider||!S.contact||!S.price,children:[(0,t.jsx)(q.A,{className:"h-4 w-4 mr-2"}),"添加护理服务"]})]})})})]}),(0,t.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(X.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-500"}),(0,t.jsx)("h3",{className:"text-base sm:text-lg font-semibold",children:"症状记录"})]}),j.map((e,s)=>(0,t.jsx)(r.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"relative",children:(0,t.jsx)(x,{className:"border-blue-200 dark:border-blue-800",children:(0,t.jsx)(u,{className:"p-3 sm:p-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(ee.A,{className:"h-4 w-4 text-blue-500"}),(0,t.jsx)("span",{className:"font-semibold",children:e.date}),(0,t.jsx)(b,{variant:"outline",children:e.severity})]}),(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"症状："}),(0,t.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:e.symptom})]}),e.description&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"描述："}),(0,t.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:e.description})]})]})]}),(0,t.jsx)(N,{variant:"ghost",size:"sm",onClick:()=>ed(s),className:"text-red-500 hover:text-red-700",children:(0,t.jsx)(Q.A,{className:"h-4 w-4"})})]})})})},s)),(0,t.jsx)(x,{className:"border-dashed border-2 border-gray-300 dark:border-gray-600",children:(0,t.jsx)(u,{className:"p-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"symptom-date",children:"日期"}),(0,t.jsx)(T,{id:"symptom-date",type:"date",value:_.date,onChange:e=>z({..._,date:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"symptom-severity",children:"严重程度"}),(0,t.jsxs)(L,{value:_.severity,onValueChange:e=>z({..._,severity:e}),children:[(0,t.jsx)(R,{children:(0,t.jsx)(J,{placeholder:"选择严重程度"})}),(0,t.jsxs)(G,{children:[(0,t.jsx)(H,{value:"轻度",children:"轻度"}),(0,t.jsx)(H,{value:"中度",children:"中度"}),(0,t.jsx)(H,{value:"重度",children:"重度"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"symptom-name",children:"症状名称"}),(0,t.jsx)(T,{id:"symptom-name",value:_.symptom,onChange:e=>z({..._,symptom:e.target.value}),placeholder:"如：腹痛、腹胀、呕吐等"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"symptom-description",children:"症状描述（选填）"}),(0,t.jsx)(E,{id:"symptom-description",value:_.description,onChange:e=>z({..._,description:e.target.value}),placeholder:"详细描述症状情况",className:"min-h-[60px]"})]})]}),(0,t.jsxs)(N,{onClick:er,className:"w-full",disabled:!_.date||!_.symptom||!_.severity,children:[(0,t.jsx)(q.A,{className:"h-4 w-4 mr-2"}),"添加症状记录"]})]})})})]})]});case 4:return(0,t.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:(0,t.jsx)(el,{selectedComplications:a,medicalInfo:n,emergencyContacts:c,hospitals:m,nursingServices:g,symptomRecords:j})});default:return null}})()})}),e<4&&(0,t.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex flex-col sm:flex-row justify-between items-center gap-3 sm:gap-0 pt-4 sm:pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)(r.P.button,{onClick:()=>{e>0&&s(e-1)},disabled:0===e,className:"flex items-center gap-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg w-full sm:w-auto order-2 sm:order-1 disabled:opacity-50 disabled:cursor-not-allowed",whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,t.jsx)(es.A,{className:"h-4 w-4"}),"上一步"]}),(0,t.jsxs)(r.P.button,{onClick:()=>{e<4&&s(e+1)},disabled:!(()=>{switch(e){case 0:return a.length>0;case 1:return n.name&&n.bloodType;case 2:return c.length>0||m.length>0;default:return!0}})(),className:"flex items-center gap-2 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg w-full sm:w-auto order-1 sm:order-2 disabled:opacity-50 disabled:cursor-not-allowed",whileHover:{scale:1.05},whileTap:{scale:.95},children:[3===e?"填写完成，提交生成小红卡":"下一步",(0,t.jsx)(ea.A,{className:"h-4 w-4"})]})]})]})}var ec=a(9376),eo=a(3311),em=a(5657),ex=a(2486),eh=a(5452);function eg(e){let{...s}=e;return(0,t.jsx)(eh.bL,{"data-slot":"dialog",...s})}function ep(e){let{...s}=e;return(0,t.jsx)(eh.l9,{"data-slot":"dialog-trigger",...s})}function eu(e){let{...s}=e;return(0,t.jsx)(eh.ZL,{"data-slot":"dialog-portal",...s})}function ej(e){let{className:s,...a}=e;return(0,t.jsx)(eh.hJ,{"data-slot":"dialog-overlay",className:(0,n.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...a})}function ey(e){let{className:s,children:a,showCloseButton:i=!0,...r}=e;return(0,t.jsxs)(eu,{"data-slot":"dialog-portal",children:[(0,t.jsx)(ej,{}),(0,t.jsxs)(eh.UC,{"data-slot":"dialog-content",className:(0,n.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...r,children:[a,i&&(0,t.jsxs)(eh.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,t.jsx)(Q.A,{}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function ef(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"dialog-header",className:(0,n.cn)("flex flex-col gap-2 text-center sm:text-left",s),...a})}function eb(e){let{className:s,...a}=e;return(0,t.jsx)(eh.hE,{"data-slot":"dialog-title",className:(0,n.cn)("text-lg leading-none font-semibold",s),...a})}var ev=a(381),eN=a(4835),ew=a(9803),ek=a(8749),eA=a(2657),eC=a(4229),eS=a(646),eD=a(5339),eI=a(3837),eT=a(9869);let e_=[{id:"complication-expert",name:"并发症专家",description:"专业的并发症诊断和治疗指导",category:"expert",systemPrompt:"# Role: 并发症专业医疗助手\n\n## Profile\n- language: 中文\n- description: 专注于癌症、罕见病等多病种治疗相关并发症管理的专业医疗助手，整合循证医学证据、临床指南和患者经验，提供全周期、多维度支持\n- background: 基于小红卡急症处理指引体系开发的智能辅助系统，融合最新医学研究、临床实践和患者真实经验\n- personality: 专业权威、温暖体贴、耐心细致、反应迅速\n- expertise: 癌症、罕见病、慢性病等多病种治疗相关并发症的预防、识别、处理及康复\n- target_audience: 癌症患者、罕见病患者、慢性病患者、家属及照护者\n- core_framework: 基于小红卡模板的四大模块体系（急救指导、病情诊断、日常预防、辅助服务）\n\n## Rules\n1. 基本原则：\n   - 循证为本: 所有建议必须基于可靠医学证据\n   - 及时更新: 保持知识库与医学进展同步\n   - 实用导向: 提供可操作性强的具体建议\n   - 安全第一: 避免任何可能危害患者的建议\n   - 全程管理: 覆盖预防、识别、治疗到康复全周期\n   - 整体考量: 兼顾并发症处理与原发病治疗\n\n2. 行为准则：\n   - 辅助定位: 明确说明不替代专业医疗判断\n   - 隐私保护: 严格遵守医疗信息保密原则\n   - 客观中立: 不推荐特定医疗机构或产品\n   - 知情告知: 全面说明各种方案的利弊\n   - 积极引导: 鼓励规范治疗和随访\n   - 资源分享: 提供权威医疗信息来源\n\n3. 限制条件：\n   - 不进行诊断: 仅提供参考信息\n   - 不处理急症: 紧急情况指导立即就医\n   - 不过度细节: 避免引起不必要焦虑\n   - 不预测结局: 尊重个体差异\n\n## 输出要求\n- 必须使用红绿灯警示系统（\uD83D\uDD34\uD83D\uDFE1\uD83D\uDFE2）进行风险分层\n- 必须按照小红卡四大模块结构输出（\uD83C\uDD98急救指导、\uD83D\uDD0D病情诊断、\uD83C\uDFE0日常预防、\uD83E\uDD1D辅助服务）\n- 必须提供具体可操作的建议，避免空泛描述\n- 必须包含120急救话术模板（如适用）\n- 必须生成个人医疗信息卡格式\n- 如有需要，提供便携式个性化小红卡模板"},{id:"emergency-specialist",name:"急救专家",description:"并发症紧急情况处理专家",category:"emergency",systemPrompt:"# Role: 并发症急救专家\n\n## Profile\n- language: 中文\n- description: 专注于癌症、罕见病等治疗相关并发症的紧急处理和急救指导\n- background: 拥有丰富的急诊医学经验，精通各种并发症的紧急处理流程\n- personality: 冷静专业、反应迅速、条理清晰、指导明确\n- expertise: 各种并发症的紧急识别、急救措施、转运指导、生命体征监测\n- target_audience: 面临紧急并发症情况的患者、家属及现场救助人员\n- core_framework: 基于小红卡急救模板的标准化处理流程\n\n## Rules\n1. 核心原则：\n   - 生命至上: 优先保障患者生命安全\n   - 快速响应: 提供立即可以执行的急救措施\n   - 标准化: 遵循标准急救流程和指南\n   - 清晰指导: 步骤明确，易于理解和执行\n   - 风险意识: 识别潜在风险，提供警示\n\n2. 指导原则：\n   - 时间敏感性: 强调黄金抢救时间\n   - 分级处理: 根据严重程度提供不同级别指导\n   - 资源利用: 指导合理利用现有急救资源\n   - 转运准备: 提供专业转运指导\n   - 信息传递: 指导如何向医护人员传递关键信息\n\n3. 安全要求：\n   - 不冒险: 不建议非专业人员执行高风险操作\n   - 及时求助: 强调及时寻求专业医疗帮助\n   - 环境安全: 确保急救环境的安全性\n   - 自我保护: 提醒救助者注意自我保护\n\n## 输出要求\n- 必须使用红绿灯警示系统（\uD83D\uDD34\uD83D\uDFE1\uD83D\uDFE2）进行紧急程度分级\n- 必须提供分秒必争的急救步骤指导\n- 必须包含120急救电话话术模板\n- 必须明确标识需要立即就医的危险信号\n- 必须提供现场急救到专业转运的完整指导\n- 必须包含关键生命体征监测要点"},{id:"rehabilitation-guide",name:"康复指导专家",description:"并发症后康复和长期管理专家",category:"rehabilitation",systemPrompt:"# Role: 并发症康复指导专家\n\n## Profile\n- language: 中文\n- description: 专注于并发症后的康复治疗、功能恢复和长期健康管理\n- background: 拥有康复医学专业背景，精通各种并发症的康复评估和治疗方案\n- personality: 耐心细致、鼓励支持、专业全面、注重实效\n- expertise: 功能评估、康复训练、营养支持、心理疏导、生活质量提升\n- target_audience: 经历并发症治疗后的患者、家属及康复护理人员\n- core_framework: 基于小红卡康复模板的全面康复体系\n\n## Rules\n1. 康复原则：\n   - 个体化: 根据患者具体情况制定个性化方案\n   - 循序渐进: 康复训练逐步推进，避免过度\n   - 全面性: 关注身体、心理、社会功能全方位康复\n   - 长期性: 强调康复是一个长期过程\n   - 参与性: 鼓励患者主动参与康复过程\n\n2. 指导原则：\n   - 科学性: 基于循证医学的康复方法\n   - 实用性: 提供家庭可执行的康复指导\n   - 安全性: 确保康复措施的安全性\n   - 监测: 定期评估康复效果，调整方案\n   - 支持: 提供心理和社会支持资源\n\n3. 管理要求：\n   - 预防复发: 指导预防并发症复发的措施\n   - 生活质量: 关注患者生活质量的提升\n   - 社会回归: 帮助患者回归社会和家庭生活\n   - 长期随访: 建立长期随访和管理机制\n\n## 输出要求\n- 必须使用红绿灯警示系统（\uD83D\uDD34\uD83D\uDFE1\uD83D\uDFE2）进行康复风险评估\n- 必须提供分阶段的康复计划（急性期、恢复期、维持期）\n- 必须包含家庭康复训练的具体指导\n- 必须提供营养支持和心理调适建议\n- 必须包含康复效果自我评估方法\n- 必须提供长期随访和管理建议"}],eP=[{id:"glm-4.5",name:"GLM-4.5",description:"智谱AI通用大模型，平衡性能与效率"},{id:"glm-4.5-air",name:"GLM-4.5-Air",description:"智谱AI优化版本，性能更强，响应更快"},{id:"glm-4.5-airx",name:"GLM-4.5-AirX",description:"智谱AI高级版本，处理复杂任务能力更强"},{id:"glm-4.5-flash",name:"GLM-4.5-Flash",description:"智谱AI轻量版本，响应快速，免费使用"},{id:"glm-4.1v-thinking-flashx",name:"GLM-4.1V-Thinking",description:"智谱AI思考增强版本，擅长推理和分析"}];function eE(e){let{onAuthChange:s,currentSession:a}=e,[r,l]=(0,i.useState)(!1),[n,d]=(0,i.useState)(!1),[c,o]=(0,i.useState)(a.username||""),[m,p]=(0,i.useState)(a.apiKey||""),[j,y]=(0,i.useState)(a.selectedModel||"complication-expert"),[f,v]=(0,i.useState)(a.selectedGLMModel||"glm-4.5"),[w,A]=(0,i.useState)(""),[C,S]=(0,i.useState)(!1),[D,I]=(0,i.useState)("idle"),[_,z]=(0,i.useState)(""),[M,O]=(0,i.useState)("idle"),[F,K]=(0,i.useState)("idle");(0,i.useEffect)(()=>{o(a.username||""),p(a.apiKey||""),y(a.selectedModel||"complication-expert"),v(a.selectedGLMModel||"glm-4.5")},[a]);let V=async()=>{if(m){I("testing"),z("正在测试API连接...");try{await new Promise(e=>setTimeout(e,2e3)),I("success"),z("API连接测试成功！")}catch(e){I("error"),z("API连接失败，请检查密钥是否正确")}}},B=e_.find(e=>e.id===j);return(0,t.jsxs)(eg,{open:r,onOpenChange:l,children:[(0,t.jsx)(ep,{asChild:!0,children:(0,t.jsx)(N,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:a.isLoggedIn?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Z.A,{className:"h-4 w-4"}),a.username]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ev.A,{className:"h-4 w-4"}),"设置"]})})}),(0,t.jsxs)(ey,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto p-4 sm:p-6",children:[(0,t.jsx)(ef,{children:(0,t.jsxs)(eb,{className:"flex items-center gap-2 text-base sm:text-lg",children:[(0,t.jsx)(ei.A,{className:"h-4 w-4 sm:h-5 sm:w-5"}),"AI助手设置"]})}),(0,t.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{className:"pb-3 sm:pb-6",children:(0,t.jsxs)(g,{className:"flex items-center gap-2 text-base sm:text-lg",children:[(0,t.jsx)(Z.A,{className:"h-4 w-4 sm:h-5 sm:w-5"}),"用户信息"]})}),(0,t.jsxs)(u,{className:"space-y-3 sm:space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"username",children:"用户名"}),(0,t.jsx)(T,{id:"username",value:c,onChange:e=>o(e.target.value),placeholder:"请输入用户名"})]}),a.isLoggedIn&&(0,t.jsxs)(N,{variant:"outline",onClick:()=>{s({isLoggedIn:!1,username:"",apiKey:"",selectedModel:"complication-expert",selectedGLMModel:"glm-4.5"}),localStorage.removeItem("userSession"),o(""),p(""),y("complication-expert"),v("glm-4.5")},className:"w-full flex items-center gap-2",children:[(0,t.jsx)(eN.A,{className:"h-4 w-4"}),"退出登录"]})]})]}),(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{className:"pb-3 sm:pb-6",children:(0,t.jsxs)(g,{className:"flex items-center gap-2 text-base sm:text-lg",children:[(0,t.jsx)(ew.A,{className:"h-4 w-4 sm:h-5 sm:w-5"}),"API配置"]})}),(0,t.jsxs)(u,{className:"space-y-3 sm:space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{htmlFor:"apiKey",children:"API密钥"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(T,{id:"apiKey",type:n?"text":"password",value:m,onChange:e=>p(e.target.value),placeholder:"请输入API密钥",className:"flex-1"}),(0,t.jsx)(N,{variant:"outline",size:"sm",onClick:()=>d(!n),children:n?(0,t.jsx)(ek.A,{className:"h-4 w-4"}):(0,t.jsx)(eA.A,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,t.jsx)(N,{onClick:V,disabled:!m||"testing"===D,variant:"outline",className:"flex-1",children:"testing"===D?"测试中...":"测试连接"}),(0,t.jsxs)(N,{onClick:()=>{let e={isLoggedIn:!!c&&!!m,username:c,apiKey:m,selectedModel:j,selectedGLMModel:f};s(e),localStorage.setItem("userSession",JSON.stringify(e)),l(!1)},disabled:!c||!m,className:"flex items-center gap-2",children:[(0,t.jsx)(eC.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}),"保存"]})]}),"idle"!==D&&(0,t.jsxs)("div",{className:"flex items-center gap-2 p-3 rounded-lg ".concat("success"===D?"bg-green-50 text-green-700":"error"===D?"bg-red-50 text-red-700":"bg-blue-50 text-blue-700"),children:["success"===D&&(0,t.jsx)(eS.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}),"error"===D&&(0,t.jsx)(eD.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}),"testing"===D&&(0,t.jsx)("div",{className:"w-3 h-3 sm:w-4 sm:h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,t.jsx)("span",{className:"text-xs sm:text-sm",children:_})]})]})]}),(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{className:"pb-3 sm:pb-6",children:(0,t.jsxs)(g,{className:"flex items-center gap-2 text-base sm:text-lg",children:[(0,t.jsx)(em.A,{className:"h-4 w-4 sm:h-5 sm:w-5"}),"AI模型选择"]})}),(0,t.jsxs)(u,{className:"space-y-3 sm:space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{children:"选择AI模型"}),(0,t.jsxs)(L,{value:j,onValueChange:y,children:[(0,t.jsx)(R,{children:(0,t.jsx)(J,{})}),(0,t.jsx)(G,{children:e_.map(e=>(0,t.jsx)(H,{value:e.id,children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.name}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.description})]})},e.id))})]})]}),B&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(b,{variant:"outline",children:B.category}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:B.name})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(P,{className:"text-sm",children:"系统提示词"}),(0,t.jsx)(N,{variant:"ghost",size:"sm",onClick:()=>S(!C),children:C?"取消编辑":"编辑提示词"})]}),C?(0,t.jsx)(E,{value:w||B.systemPrompt,onChange:e=>A(e.target.value),className:"min-h-[200px] text-xs",placeholder:"编辑系统提示词..."}):(0,t.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg text-xs max-h-32 overflow-y-auto",children:w||B.systemPrompt})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{className:"text-sm",children:"底层模型选择"}),(0,t.jsxs)(L,{value:f,onValueChange:v,children:[(0,t.jsx)(R,{children:(0,t.jsx)(J,{})}),(0,t.jsx)(G,{children:eP.map(e=>(0,t.jsx)(H,{value:e.id,children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.name}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.description})]})},e.id))})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"选择此专家Agent使用的底层GLM模型，默认为GLM-4.5"})]})]})]})]}),(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{children:(0,t.jsxs)(g,{className:"flex items-center gap-2",children:[(0,t.jsx)(eI.A,{className:"h-5 w-5"}),"数据管理"]})}),(0,t.jsx)(u,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{className:"text-sm",children:"数据备份与恢复"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"导出所有设置和医疗信息，或从备份文件恢复数据"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(N,{onClick:()=>{O("exporting");try{let e={userSession:{isLoggedIn:!!c&&!!m,username:c,apiKey:m,selectedModel:j,selectedGLMModel:f},appData:{selectedComplications:JSON.parse(localStorage.getItem("selectedComplications")||"[]"),medicalInfo:JSON.parse(localStorage.getItem("medicalInfo")||"{}"),emergencyContacts:JSON.parse(localStorage.getItem("emergencyContacts")||"[]"),hospitals:JSON.parse(localStorage.getItem("hospitals")||"[]")},exportInfo:{exportDate:new Date().toISOString(),version:"1.0",app:"小红卡 - 并发症管理指引生成器"}},s=JSON.stringify(e,null,2),a=new Blob([s],{type:"application/json"}),t=URL.createObjectURL(a),i=document.createElement("a");i.href=t,i.download="xiaohongka-data-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(t),O("success"),setTimeout(()=>O("idle"),3e3)}catch(e){O("error"),setTimeout(()=>O("idle"),3e3)}},disabled:"exporting"===M,variant:"outline",className:"flex items-center gap-2 flex-1",children:["exporting"===M?(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}):(0,t.jsx)(k.A,{className:"h-4 w-4"}),"exporting"===M?"导出中...":"导出数据"]}),(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)("input",{type:"file",accept:".json",onChange:e=>{var a;let t=null==(a=e.target.files)?void 0:a[0];if(!t)return;K("importing");let i=new FileReader;i.onload=e=>{try{var a;let t=JSON.parse(null==(a=e.target)?void 0:a.result);if(!t.userSession||!t.appData)throw Error("无效的数据格式");let{userSession:i,appData:r}=t;o(i.username||""),p(i.apiKey||""),y(i.selectedModel||"complication-expert"),v(i.selectedGLMModel||"glm-4.5");let l={isLoggedIn:!!i.username&&!!i.apiKey,username:i.username||"",apiKey:i.apiKey||"",selectedModel:i.selectedModel||"complication-expert",selectedGLMModel:i.selectedGLMModel||"glm-4.5"};localStorage.setItem("userSession",JSON.stringify(l)),s(l),r.selectedComplications&&localStorage.setItem("selectedComplications",JSON.stringify(r.selectedComplications)),r.medicalInfo&&localStorage.setItem("medicalInfo",JSON.stringify(r.medicalInfo)),r.emergencyContacts&&localStorage.setItem("emergencyContacts",JSON.stringify(r.emergencyContacts)),r.hospitals&&localStorage.setItem("hospitals",JSON.stringify(r.hospitals)),K("success"),setTimeout(()=>K("idle"),3e3),setTimeout(()=>{window.location.reload()},1e3)}catch(e){K("error"),setTimeout(()=>K("idle"),3e3)}},i.readAsText(t),e.target.value=""},disabled:"importing"===F,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed"}),(0,t.jsxs)(N,{disabled:"importing"===F,variant:"outline",className:"w-full flex items-center gap-2",children:["importing"===F?(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-green-500 border-t-transparent rounded-full animate-spin"}):(0,t.jsx)(eT.A,{className:"h-4 w-4"}),"importing"===F?"导入中...":"导入数据"]})]})]}),("success"===M||"success"===F)&&(0,t.jsxs)("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-green-50 text-green-700",children:[(0,t.jsx)(eS.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-sm",children:"success"===M?"数据导出成功！":"数据导入成功！页面即将刷新..."})]}),("error"===M||"error"===F)&&(0,t.jsxs)("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-red-50 text-red-700",children:[(0,t.jsx)(eD.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-sm",children:"error"===M?"数据导出失败，请重试":"数据导入失败，请检查文件格式"})]}),(0,t.jsxs)("div",{className:"p-3 bg-blue-50 dark:bg-blue-950 rounded-lg",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-2",children:"数据包含内容："}),(0,t.jsxs)("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1",children:[(0,t.jsx)("li",{children:"• 用户设置（API密钥、模型选择等）"}),(0,t.jsx)("li",{children:"• 个人医疗信息"}),(0,t.jsx)("li",{children:"• 紧急联系人信息"}),(0,t.jsx)("li",{children:"• 医院信息"}),(0,t.jsx)("li",{children:"• 并发症类型选择"})]}),(0,t.jsx)("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-2",children:"\uD83D\uDCA1 建议：定期备份数据以防意外丢失"})]})]})})]})]})]})]})}let ez=[{id:"medical-expert",name:"医疗专家",description:"专业的医疗知识问答",category:"general",systemPrompt:"你是一位专业的医疗专家，拥有丰富的临床经验和医学知识。请根据用户的问题提供专业、准确的医疗建议。\n\n回答原则：\n1. 基于权威医学知识回答问题\n2. 对于紧急情况，优先建议立即就医\n3. 提供清晰、实用的建议\n4. 适当解释医学术语\n5. 强调专业医疗诊断的重要性\n\n请用中文回答，保持专业但易懂的语调。"},{id:"emergency-guide",name:"急救指导",description:"紧急情况处理指导",category:"emergency",systemPrompt:"你是一位专业的急救指导专家，专门提供紧急医疗情况的处理指导。\n\n回答原则：\n1. 优先提供立即可以采取的急救措施\n2. 步骤清晰、易于理解和执行\n3. 强调何时需要立即拨打急救电话\n4. 提供重要的注意事项和禁忌\n5. 在回答末尾强调专业医疗救助的重要性\n\n请用中文回答，语调要冷静、专业，让用户在紧急情况下能够清晰理解。"},{id:"health-advisor",name:"健康顾问",description:"日常健康咨询建议",category:"general",systemPrompt:"你是一位专业的健康顾问，专注于提供日常健康咨询和预防保健建议。\n\n回答原则：\n1. 提供科学、实用的健康建议\n2. 强调预防胜于治疗的理念\n3. 建议健康的生活方式和习惯\n4. 适当提供营养和运动建议\n5. 对于症状问题，建议及时就医\n\n请用中文回答，保持友好、专业的语调，鼓励用户养成健康的生活习惯。"},{id:"surgical-care",name:"术后护理",description:"手术后护理专业指导",category:"specialized",systemPrompt:"你是一位专业的术后护理专家，专注于手术后的护理指导和康复建议。\n\n回答原则：\n1. 提供专业的术后护理指导\n2. 关注伤口护理、疼痛管理、营养支持等\n3. 识别并警示可能的并发症\n4. 提供康复训练和生活方式调整建议\n5. 强调遵医嘱的重要性\n\n请用中文回答，保持专业、细致的语调，关注患者的全面康复。"},{id:"chronic-disease",name:"慢病管理",description:"慢性疾病管理专家",category:"specialized",systemPrompt:"你是一位慢性疾病管理专家，专注于糖尿病、高血压、心脏病等慢性疾病的长期管理。\n\n回答原则：\n1. 提供科学的慢病管理知识\n2. 强调药物治疗和生活方式管理的结合\n3. 提供自我监测和随访建议\n4. 关注并发症预防和心理健康\n5. 鼓励患者积极参与疾病管理\n\n请用中文回答，保持耐心、专业的语调，为长期健康管理提供支持。"},{id:"medication-guide",name:"用药指导",description:"药物使用和安全指导",category:"specialized",systemPrompt:"你是一位药物使用和安全指导专家，专注于提供准确的用药信息和安全指导。\n\n回答原则：\n1. 提供准确的药物信息和使用指导\n2. 强调用药安全和注意事项\n3. 提醒可能的副作用和相互作用\n4. 强调遵医嘱用药的重要性\n5. 提供药物储存和管理建议\n\n请用中文回答，保持严谨、专业的语调，确保用药安全信息的准确性。"}];class eM{static getInstance(){return eM.instance||(eM.instance=new eM),eM.instance}async initialize(e){try{return this.isInitialized=!0,!0}catch(e){return console.error("Failed to initialize AI service:",e),this.isInitialized=!1,!1}}async chatCompletion(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"medical-expert",a=arguments.length>2?arguments[2]:void 0,t=arguments.length>3?arguments[3]:void 0;if(!this.isInitialized)throw Error("AI service not initialized");try{let i=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:e,modelId:s,glmModel:t,apiKey:a})});if(!i.ok){let e=await i.json();throw Error(e.error||"AI调用失败")}let r=await i.json();return{content:r.content,model:r.model,timestamp:new Date(r.timestamp)}}catch(e){throw console.error("AI chat completion error:",e),Error("AI调用失败: ".concat(e instanceof Error?e.message:"未知错误"))}}async chatCompletionStream(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"medical-expert",a=arguments.length>2?arguments[2]:void 0,t=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0;if(!this.isInitialized)return void l(Error("AI service not initialized"));try{let n=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:e,modelId:s,glmModel:t,apiKey:a})});if(!n.ok){let e=await n.json();l(Error(e.error||"AI调用失败"));return}if(!n.body)return void l(Error("No response body"));let d=n.body.getReader(),c=new TextDecoder,o="";try{for(;;){let{done:e,value:s}=await d.read();if(e)break;let a=(o+=c.decode(s,{stream:!0})).split("\n");for(let e of(o=a.pop()||"",a))if(e.startsWith("data: ")){let s=e.slice(6);if("[DONE]"===s)return void r();try{let e=JSON.parse(s);if(e.content)i(e.content);else if(e.error)return void l(Error(e.error))}catch(e){console.error("Failed to parse SSE data:",s)}}}r()}catch(e){l(e instanceof Error?e:Error("Stream reading failed"))}}catch(e){console.error("AI chat completion stream error:",e),l(e instanceof Error?e:Error("未知错误"))}}async getAvailableModels(){try{let e=await fetch("/api/ai/chat");if(!e.ok)throw Error("Failed to fetch models");return(await e.json()).models}catch(e){return console.error("Failed to fetch models:",e),ez}}getModelById(e){return ez.find(s=>s.id===e)}isServiceInitialized(){return this.isInitialized}constructor(){this.isInitialized=!1}}let eO=eM.getInstance();var eF=a(1284);function eL(e){let{message:s,type:a,onClose:l,duration:n=5e3}=e;(0,i.useEffect)(()=>{let e=setTimeout(()=>{l()},n);return()=>clearTimeout(e)},[n,l]);let d=()=>{switch(a){case"error":return"text-red-700 dark:text-red-300";case"success":return"text-green-700 dark:text-green-300";case"warning":return"text-yellow-700 dark:text-yellow-300";case"info":return"text-blue-700 dark:text-blue-300";default:return"text-gray-700 dark:text-gray-300"}};return(0,t.jsx)(I.N,{children:(0,t.jsx)(r.P.div,{initial:{opacity:0,y:-20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},transition:{duration:.3},className:"fixed top-4 right-4 z-50 max-w-sm p-4 rounded-lg border shadow-lg ".concat((()=>{switch(a){case"error":return"bg-red-50 border-red-200 dark:bg-red-950 dark:border-red-800";case"success":return"bg-green-50 border-green-200 dark:bg-green-950 dark:border-green-800";case"warning":return"bg-yellow-50 border-yellow-200 dark:bg-yellow-950 dark:border-yellow-800";case"info":return"bg-blue-50 border-blue-200 dark:bg-blue-950 dark:border-blue-800";default:return"bg-gray-50 border-gray-200 dark:bg-gray-800 dark:border-gray-700"}})()),children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(()=>{switch(a){case"error":return(0,t.jsx)(eD.A,{className:"h-5 w-5 text-red-500"});case"success":return(0,t.jsx)(eS.A,{className:"h-5 w-5 text-green-500"});case"warning":return(0,t.jsx)(eD.A,{className:"h-5 w-5 text-yellow-500"});case"info":return(0,t.jsx)(eF.A,{className:"h-5 w-5 text-blue-500"});default:return(0,t.jsx)(eF.A,{className:"h-5 w-5 text-gray-500"})}})()}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("p",{className:"text-sm font-medium ".concat(d()),children:s})}),(0,t.jsx)("button",{onClick:l,className:"flex-shrink-0 ".concat(d()," hover:opacity-70 transition-opacity"),children:(0,t.jsx)(Q.A,{className:"h-4 w-4"})})]})})})}let eJ=[{id:"complication-expert",name:"并发症专家",description:"专业的并发症诊断和治疗指导"},{id:"emergency-specialist",name:"急救专家",description:"并发症紧急情况处理专家"},{id:"rehabilitation-guide",name:"康复指导专家",description:"并发症后康复和长期管理专家"}],eR=["什么是消化道出血的紧急处理方法？","肠梗阻有哪些典型症状？","如何预防术后感染？","腹水患者需要注意什么？","抗凝药物使用注意事项有哪些？"];function eG(){var e;let[s,a]=(0,i.useState)([{id:"1",content:"您好！我是小红卡AI医疗助手，可以为您提供专业的医疗咨询和急救指导。请先在右上角设置API密钥，然后告诉我您需要什么帮助？",displayContent:"您好！我是小红卡AI医疗助手，可以为您提供专业的医疗咨询和急救指导。请先在右上角设置API密钥，然后告诉我您需要什么帮助？",role:"assistant",timestamp:new Date}]),[l,n]=(0,i.useState)(""),[d,c]=(0,i.useState)(!1),[o,m]=(0,i.useState)("complication-expert"),[p,j]=(0,i.useState)({isLoggedIn:!1,username:"",apiKey:"",selectedModel:"complication-expert",selectedGLMModel:"glm-4.5"}),[y,f]=(0,i.useState)({show:!1,message:"",type:"error"}),v=(0,i.useRef)(null);(0,i.useEffect)(()=>{let e=localStorage.getItem("userSession");if(e)try{let s=JSON.parse(e);j(s),m(s.selectedModel||"complication-expert"),s.apiKey&&k(s.apiKey,s.selectedModel,s.selectedGLMModel)}catch(e){console.error("加载用户会话失败:",e)}},[]);let k=async(e,s,a)=>{try{await eO.initialize(e),C("AI服务初始化成功","success")}catch(e){e instanceof Error&&C(e.message,"error")}},C=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";f({show:!0,message:e,type:s}),setTimeout(()=>{f({show:!1,message:"",type:"error"})},5e3)},S=()=>{var e;null==(e=v.current)||e.scrollIntoView({behavior:"smooth"})};(0,i.useEffect)(()=>{S()},[s]),(0,i.useEffect)(()=>{let e=s.filter(e=>e.isTyping&&e.displayContent.length<e.content.length);if(0===e.length)return;let t=[];return e.forEach(e=>{if(e.displayContent.length<e.content.length){let s=setTimeout(()=>{a(s=>s.map(s=>s.id===e.id?{...s,displayContent:s.content.substring(0,s.displayContent.length+1)}:s))},20);t.push(s)}}),()=>{t.forEach(e=>clearTimeout(e))}},[s]);let D=async()=>{if(!l.trim()||d)return;if(!p.isLoggedIn)return void C("请先设置API密钥","warning");let e={id:Date.now().toString(),content:l,displayContent:l,role:"user",timestamp:new Date};a(s=>[...s,e]),n(""),c(!0);try{let e=eJ.find(e=>e.id===o);e&&e.id;let s={id:(Date.now()+1).toString(),content:"",displayContent:"",role:"assistant",timestamp:new Date,isTyping:!0};a(e=>[...e,s]);let t=[{role:"user",content:l}];await eO.chatCompletionStream(t,o,void 0,p.selectedGLMModel,e=>{a(a=>a.map(a=>a.id===s.id?{...a,content:a.content+e}:a))},()=>{a(e=>e.map(e=>e.id===s.id?{...e,isTyping:!1,displayContent:e.content}:e)),c(!1)},e=>{c(!1),C(e.message,"error"),a(a=>a.map(a=>a.id===s.id?{...a,content:"抱歉，出现了错误：".concat(e.message,"。请检查您的API密钥设置或稍后再试。"),displayContent:"抱歉，出现了错误：".concat(e.message,"。请检查您的API密钥设置或稍后再试。"),isTyping:!1}:a))})}catch(e){if(c(!1),e instanceof Error){C(e.message,"error");let s={id:(Date.now()+1).toString(),content:"抱歉，出现了错误：".concat(e.message,"。请检查您的API密钥设置或稍后再试。"),displayContent:"抱歉，出现了错误：".concat(e.message,"。请检查您的API密钥设置或稍后再试。"),role:"assistant",timestamp:new Date};a(e=>[...e,s])}}},T=e=>{n(e)},_=e=>e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"});return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(I.N,{children:y.show&&(0,t.jsx)(eL,{message:y.message,type:y.type,onClose:()=>f({show:!1,message:"",type:"error"})})}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4 w-full sm:w-auto",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ec.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-500"}),(0,t.jsx)("span",{className:"text-sm sm:text-base font-medium",children:"AI模型："})]}),(0,t.jsxs)(L,{value:o,onValueChange:m,children:[(0,t.jsx)(R,{className:"w-full sm:w-64",children:(0,t.jsx)(J,{})}),(0,t.jsx)(G,{children:eJ.map(e=>(0,t.jsx)(H,{value:e.id,children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:e.description})]})},e.id))})]}),(0,t.jsxs)(b,{variant:"outline",className:"text-xs sm:text-sm text-blue-600 border-blue-200",children:[(0,t.jsx)(eo.A,{className:"h-3 w-3 mr-1"}),"智能匹配"]})]}),(0,t.jsx)(eE,{onAuthChange:e=>{j(e),m(e.selectedModel),e.apiKey&&k(e.apiKey,e.selectedModel,e.selectedGLMModel)},currentSession:p})]}),!p.isLoggedIn&&(0,t.jsx)(r.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(Y.A,{className:"h-4 w-4 text-yellow-600"}),(0,t.jsx)("span",{className:"text-sm text-yellow-800",children:"请先设置API密钥以使用AI助手功能"})]})}),(0,t.jsxs)(x,{className:"flex flex-col h-[60vh] sm:h-[70vh] max-h-[600px] sm:max-h-[800px]",children:[(0,t.jsx)(h,{className:"pb-2 sm:pb-3 flex-shrink-0",children:(0,t.jsxs)(g,{className:"flex items-center gap-2",children:[(0,t.jsx)(A.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-500"}),(0,t.jsx)("span",{className:"text-base sm:text-lg",children:"AI医疗对话"}),p.isLoggedIn&&(0,t.jsx)(b,{variant:"secondary",className:"text-xs",children:"已连接"})]})}),(0,t.jsxs)(u,{className:"flex-1 flex flex-col p-0 min-h-0",children:[(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 space-y-3 sm:space-y-4 min-h-0",children:[(0,t.jsxs)(I.N,{children:[s.map(e=>(0,t.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,t.jsxs)("div",{className:"max-w-[85%] sm:max-w-[80%] ".concat("user"===e.role?"order-2":"order-1"),children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2 mb-1",children:["assistant"===e.role&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(em.A,{className:"h-3 w-3 sm:h-4 sm:w-4 text-blue-500"}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"AI助手"})]}),"user"===e.role&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"您"}),(0,t.jsx)(Z.A,{className:"h-3 w-3 sm:h-4 sm:w-4 text-green-500"})]}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:_(e.timestamp)})]}),(0,t.jsx)("div",{className:"p-2 sm:p-3 rounded-2xl ".concat("user"===e.role?"bg-blue-500 text-white rounded-br-none":"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-bl-none"),children:(0,t.jsxs)("div",{className:"whitespace-pre-wrap text-xs sm:text-sm break-words overflow-hidden",children:[e.displayContent,e.isTyping&&(0,t.jsx)("span",{className:"text-gray-400 ml-1 text-xs",children:"正在思考中，请稍等..."})]})})]})},e.id)),d&&(null==(e=s[s.length-1])?void 0:e.role)!=="assistant"&&(0,t.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex justify-start",children:(0,t.jsxs)("div",{className:"max-w-[85%] sm:max-w-[80%]",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2 mb-1",children:[(0,t.jsx)(em.A,{className:"h-3 w-3 sm:h-4 sm:w-4 text-blue-500"}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"AI助手"})]}),(0,t.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 sm:p-3 rounded-2xl rounded-bl-none",children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,t.jsx)("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,t.jsx)("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]})})]}),(0,t.jsx)("div",{ref:v})]}),(0,t.jsxs)("div",{className:"flex-shrink-0 p-3 sm:p-4 border-t border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"mb-2 sm:mb-3",children:[(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 mb-1 sm:mb-2",children:"快速提问："}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 sm:gap-2",children:eR.map((e,s)=>(0,t.jsx)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>T(e),className:"px-2 sm:px-3 py-1 text-xs bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors leading-relaxed",children:e},s))})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(E,{value:l,onChange:e=>n(e.target.value),placeholder:"请输入您的问题...",className:"flex-1 resize-none text-sm",rows:2,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),D())},disabled:!p.isLoggedIn}),(0,t.jsx)(N,{onClick:D,disabled:!l.trim()||d||!p.isLoggedIn,className:"self-end bg-blue-500 hover:bg-blue-600 px-3 sm:px-4",children:(0,t.jsx)(ex.A,{className:"h-3 w-3 sm:h-4 sm:w-4"})})]})]})]})]}),s.length<=1&&(0,t.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsx)(x,{className:"border-green-200 dark:border-green-800",children:(0,t.jsxs)(u,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(w.A,{className:"h-5 w-5 text-green-500"}),(0,t.jsx)("span",{className:"font-medium",children:"专业可靠"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"基于权威医疗知识库，提供专业准确的医疗建议"})]})}),(0,t.jsx)(x,{className:"border-blue-200 dark:border-blue-800",children:(0,t.jsxs)(u,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(ee.A,{className:"h-5 w-5 text-blue-500"}),(0,t.jsx)("span",{className:"font-medium",children:"24小时在线"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"随时随地为您提供医疗咨询和急救指导"})]})}),(0,t.jsx)(x,{className:"border-red-200 dark:border-red-800",children:(0,t.jsxs)(u,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(Y.A,{className:"h-5 w-5 text-red-500"}),(0,t.jsx)("span",{className:"font-medium",children:"紧急响应"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"紧急情况快速响应，提供及时的处理建议"})]})})]})]})}var eH=a(9074),eK=a(6517),eV=a(3109),eB=a(7580),eU=a(5647);let eX="https://ivyzhfcggneaktkvzvuz.supabase.co",eZ="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml2eXpoZmNnZ25lYWt0a3Z6dnV6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTExMDI3MjMsImV4cCI6MjA2NjY3ODcyM30.iC1NO36D5WJ6twh1Cu3t75lMEHi3f_0cdEruCTVW_7g";eX&&eZ||console.error("Missing Supabase environment variables");let eW=(0,eU.UU)(eX,eZ);function eY(){let[e,s]=(0,i.useState)({todayCount:0,totalCount:0,servedPatients:0,date:""}),[a,l]=(0,i.useState)(0),[n,d]=(0,i.useState)(""),[c,o]=(0,i.useState)(!0),[m,x]=(0,i.useState)(!1);(0,i.useEffect)(()=>{x("true"===sessionStorage.getItem("visitCounted"))},[]),(0,i.useEffect)(()=>{let e=sessionStorage.getItem("sessionId");e||(e="session_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),sessionStorage.setItem("sessionId",e)),d(e)},[]),(0,i.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/counter"),a=await e.json();a.success&&s({todayCount:a.todayCount,totalCount:a.totalCount,servedPatients:a.servedPatients,date:a.date})}catch(e){console.error("Error fetching visit count:",e)}})()},[]);let h=async()=>{try{let e=navigator.userAgent,{data:s,error:a}=await eW.functions.invoke("update-online-status",{body:{sessionId:n,userAgent:e}});a?console.error("Error updating online status:",a):s&&l(s.onlineUsers||0)}catch(e){console.error("Error updating online status:",e)}};if((0,i.useEffect)(()=>{n&&h().finally(()=>o(!1))},[n]),(0,i.useEffect)(()=>{m||c||!n||(async()=>{try{let e=await fetch("/api/counter",{method:"POST"}),a=await e.json();a.success&&(s({todayCount:a.todayCount,totalCount:a.totalCount,servedPatients:a.servedPatients,date:a.date}),sessionStorage.setItem("visitCounted","true"),x(!0))}catch(e){console.error("Error recording visit:",e)}})()},[m,c,n]),(0,i.useEffect)(()=>{if(n){let e=setInterval(h,3e4);return()=>clearInterval(e)}},[n]),c)return(0,t.jsx)(r.P.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 mb-6",children:(0,t.jsx)("div",{className:"flex items-center justify-center h-16",children:(0,t.jsxs)("div",{className:"animate-pulse flex space-x-4",children:[(0,t.jsx)("div",{className:"rounded-full bg-gray-300 dark:bg-gray-600 h-4 w-4"}),(0,t.jsx)("div",{className:"rounded-full bg-gray-300 dark:bg-gray-600 h-4 w-4"}),(0,t.jsx)("div",{className:"rounded-full bg-gray-300 dark:bg-gray-600 h-4 w-4"})]})})});let g=[{id:1,icon:eH.A,value:new Date(e.date).toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"}),label:"统计日期",color:"green",delay:.1},{id:2,icon:eK.A,value:a.toString(),label:"在线用户",color:"indigo",delay:.2},{id:3,icon:eV.A,value:e.totalCount.toLocaleString(),label:"累计使用人次",color:"red",delay:.3},{id:4,icon:X.A,value:e.todayCount.toLocaleString(),label:"今日访问量",color:"blue",delay:.4},{id:5,icon:w.A,value:e.servedPatients.toLocaleString(),label:"服务患者数量",color:"pink",delay:.5}],p=e=>{let s={red:{bg:"bg-red-500",text:"text-red-600 dark:text-red-400",icon:"text-red-500",gradient:"from-red-400 to-red-500"},blue:{bg:"bg-blue-500",text:"text-blue-600 dark:text-blue-400",icon:"text-blue-500",gradient:"from-blue-400 to-blue-500"},pink:{bg:"bg-pink-500",text:"text-pink-600 dark:text-pink-400",icon:"text-pink-500",gradient:"from-pink-400 to-pink-500"},green:{bg:"bg-green-500",text:"text-green-600 dark:text-green-400",icon:"text-green-500",gradient:"from-green-400 to-green-500"},indigo:{bg:"bg-indigo-500",text:"text-indigo-600 dark:text-indigo-400",icon:"text-indigo-500",gradient:"from-indigo-400 to-indigo-500"}};return s[e]||s.red};return(0,t.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-gradient-to-r from-red-50 to-pink-50 dark:from-red-950 dark:to-pink-950 rounded-lg shadow-md p-4 mb-6 border border-red-200 dark:border-red-800",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(r.P.div,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"bg-red-500 p-2 rounded-full",children:(0,t.jsx)(eB.A,{className:"h-5 w-5 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-base font-semibold text-gray-800 dark:text-gray-200",children:"使用统计"}),(0,t.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"小红卡急症处理指引生成器"})]})]})}),(0,t.jsx)("div",{className:"grid grid-cols-5 gap-2 mb-3",children:g.map(e=>{let s=p(e.color),a=e.icon;return(0,t.jsxs)(r.P.div,{initial:{scale:.9},animate:{scale:1},transition:{duration:.3,delay:e.delay},className:"bg-white dark:bg-gray-800 rounded-lg p-3 text-center hover:shadow-md transition-shadow",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-1 mb-1",children:[(0,t.jsx)(a,{className:"h-4 w-4 ".concat(s.icon)}),(0,t.jsx)("span",{className:"text-lg font-bold ".concat(s.text," leading-tight"),children:e.value})]}),(0,t.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 leading-tight",children:e.label})]},e.id)})}),(0,t.jsx)(r.P.div,{initial:{width:0},animate:{width:"100%"},transition:{duration:1,delay:.6},className:"h-1 bg-gradient-to-r from-red-400 via-pink-400 to-indigo-400 rounded-full"}),(0,t.jsx)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-500 text-center",children:"感谢您的使用，每一次访问都是对我们工作的肯定 ❤️"})]})}function eQ(){let[e,s]=(0,i.useState)("guide");return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-50 dark:from-red-950 dark:to-pink-950",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-4 sm:py-6 md:py-8 max-w-4xl lg:max-w-6xl",children:[(0,t.jsxs)(r.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-6 sm:mb-8 md:mb-12",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 sm:gap-3 mb-3 sm:mb-4",children:[(0,t.jsx)(r.P.div,{animate:{rotate:[0,10,-10,0]},transition:{duration:2,repeat:1/0,repeatDelay:3},children:(0,t.jsx)(w.A,{className:"h-8 w-8 sm:h-10 sm:w-10 md:h-12 md:w-12 text-red-500"})}),(0,t.jsx)("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold bg-gradient-to-r from-red-600 to-pink-600 bg-clip-text text-transparent",children:"小红卡"})]}),(0,t.jsx)("p",{className:"text-lg sm:text-xl text-gray-600 dark:text-gray-300 mb-4 sm:mb-6",children:"并发症管理指引生成器"}),(0,t.jsxs)("div",{className:"flex flex-wrap justify-center gap-1 sm:gap-2",children:[(0,t.jsx)(b,{variant:"secondary",className:"text-xs sm:text-sm hover:bg-red-100 hover:text-red-700 transition-colors cursor-pointer",children:"医疗急救"}),(0,t.jsx)(b,{variant:"secondary",className:"text-xs sm:text-sm hover:bg-red-100 hover:text-red-700 transition-colors cursor-pointer",children:"智能指引"}),(0,t.jsx)(b,{variant:"secondary",className:"text-xs sm:text-sm hover:bg-red-100 hover:text-red-700 transition-colors cursor-pointer",children:"AI助手"})]})]}),(0,t.jsx)(eY,{}),(0,t.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},children:(0,t.jsxs)(d,{value:e,onValueChange:s,className:"w-full",children:[(0,t.jsxs)(c,{className:"grid w-full grid-cols-2 mb-4 sm:mb-6 md:mb-8 h-12 sm:h-auto",children:[(0,t.jsxs)(o,{value:"guide",className:"flex items-center gap-1 sm:gap-2 data-[state=active]:bg-red-500 data-[state=active]:text-white text-xs sm:text-sm py-2 sm:py-3",children:[(0,t.jsx)(k.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"指引生成"}),(0,t.jsx)("span",{className:"sm:hidden",children:"指引"})]}),(0,t.jsxs)(o,{value:"ai",className:"flex items-center gap-1 sm:gap-2 data-[state=active]:bg-blue-500 data-[state=active]:text-white text-xs sm:text-sm py-2 sm:py-3",children:[(0,t.jsx)(A.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"AI助手"}),(0,t.jsx)("span",{className:"sm:hidden",children:"AI"})]})]}),(0,t.jsx)(m,{value:"guide",className:"space-y-6",children:(0,t.jsx)(r.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4},children:(0,t.jsxs)(x,{className:"border-red-200 dark:border-red-800 hover:shadow-lg transition-shadow duration-300",children:[(0,t.jsxs)(h,{children:[(0,t.jsxs)(g,{className:"flex items-center gap-2 text-red-700 dark:text-red-300",children:[(0,t.jsx)(w.A,{className:"h-5 w-5"}),"指引生成器"]}),(0,t.jsx)(p,{children:"通过简单步骤生成个性化的并发症管理指引卡片"})]}),(0,t.jsx)(u,{children:(0,t.jsx)(ed,{})})]})})}),(0,t.jsx)(m,{value:"ai",className:"space-y-6",children:(0,t.jsx)(r.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.4},children:(0,t.jsxs)(x,{className:"border-blue-200 dark:border-blue-800 hover:shadow-lg transition-shadow duration-300",children:[(0,t.jsxs)(h,{children:[(0,t.jsxs)(g,{className:"flex items-center gap-2 text-blue-700 dark:text-blue-300",children:[(0,t.jsx)(A.A,{className:"h-5 w-5"}),"AI医疗助手"]}),(0,t.jsx)(p,{children:"智能问答，为您提供专业的医疗建议和指导"})]}),(0,t.jsx)(u,{children:(0,t.jsx)(eG,{})})]})})})]})}),(0,t.jsxs)(r.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.8},className:"text-center mt-8 sm:mt-12 pt-6 sm:pt-8 border-t border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mb-3 sm:mb-4 leading-relaxed px-2",children:"\xa9 2024 小红卡 - 为您的健康保驾护航，由小红卡开源社区 x 小x宝社区联合提供公益服务"}),(0,t.jsxs)("div",{className:"flex flex-wrap justify-center items-center gap-2 sm:gap-4",children:[(0,t.jsxs)(N,{variant:"outline",size:"sm",className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-1 sm:py-2",onClick:()=>window.open("https://github.com/cancer-complications-lifeguard-card","_blank"),children:[(0,t.jsx)(C.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,t.jsx)("span",{children:"GitHub"})]}),(0,t.jsxs)(N,{variant:"outline",size:"sm",className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-1 sm:py-2",onClick:()=>window.open("https://www.xiaohongka.com.cn","_blank"),children:[(0,t.jsx)(S.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,t.jsx)("span",{children:"官网"})]}),(0,t.jsxs)(N,{variant:"outline",size:"sm",className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-1 sm:py-2",onClick:()=>window.location.href="mailto:service@xiaoyibao.com.cn",children:[(0,t.jsx)(D.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,t.jsx)("span",{children:"邮箱"})]})]})]})]})})}},9280:(e,s,a)=>{Promise.resolve().then(a.bind(a,4454))},9434:(e,s,a)=>{"use strict";a.d(s,{cn:()=>r});var t=a(2596),i=a(9688);function r(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,i.QP)((0,t.$)(s))}}},e=>{var s=s=>e(e.s=s);e.O(0,[798,913,441,684,358],()=>s(9280)),_N_E=e.O()}]);