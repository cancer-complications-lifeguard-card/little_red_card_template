<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°çº¢å¡ - å¹¶å‘ç—‡ç®¡ç†æŒ‡å¼•ç”Ÿæˆå™¨</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-red: #FF3B30;
            --dark-red: #D70015;
            --light-gray: #F2F2F7;
            --dark-gray: #1C1C1E;
            --medium-gray: #6B7280;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "PingFang SC", "Helvetica Neue", sans-serif;
            background-color: var(--light-gray);
            color: var(--dark-gray);
            line-height: 1.6;
        }

        button {
            font-family: inherit;
            cursor: pointer;
            border: none;
            outline: none;
        }

        input, textarea, select {
            font-family: inherit;
            outline: none;
        }

        .app-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 36px;
            font-weight: 700;
            color: var(--primary-red);
            margin-bottom: 10px;
        }

        .header p {
            font-size: 18px;
            color: var(--medium-gray);
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: var(--medium-gray);
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: var(--primary-red);
            border-bottom-color: var(--primary-red);
        }

        .tab-content {
            background-color: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 25%;
        }

        .step-number {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--light-gray);
            color: var(--medium-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .step.active .step-number {
            background-color: var(--primary-red);
            color: white;
        }

        .step-title {
            font-size: 14px;
            text-align: center;
            color: var(--medium-gray);
        }

        .step.active .step-title {
            color: var(--primary-red);
            font-weight: 500;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark-gray);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            font-size: 16px;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .checkbox-item {
            display: flex;
            align-items: flex-start;
            padding: 15px;
            background-color: var(--light-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .checkbox-item:hover {
            background-color: rgba(255, 59, 48, 0.1);
        }

        .checkbox-item.selected {
            background-color: rgba(255, 59, 48, 0.15);
            border: 1px solid var(--primary-red);
        }

        .checkbox-item input {
            margin-right: 10px;
            margin-top: 3px;
        }

        .checkbox-item-content h4 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .checkbox-item-content p {
            font-size: 14px;
            color: var(--medium-gray);
        }

        .contact-item,
        .hospital-item {
            background-color: var(--light-gray);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            position: relative;
        }

        .contact-item h4,
        .hospital-item h4 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .contact-item p,
        .hospital-item p {
            font-size: 14px;
            margin-bottom: 5px;
        }

        .remove-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: transparent;
            color: var(--medium-gray);
            font-size: 18px;
            cursor: pointer;
        }

        .add-button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 12px;
            background-color: transparent;
            border: 1px dashed var(--medium-gray);
            border-radius: 8px;
            color: var(--medium-gray);
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .add-button:hover {
            border-color: var(--primary-red);
            color: var(--primary-red);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .nav-button {
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
        }

        .nav-button.prev {
            background-color: var(--light-gray);
            color: var(--dark-gray);
        }

        .nav-button.next {
            background-color: var(--primary-red);
            color: white;
        }

        .nav-button.generate {
            background-color: var(--primary-red);
            color: white;
        }

        .card-preview {
            background-color: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .card-header {
            border-bottom: 1px solid var(--light-gray);
            padding-bottom: 20px;
            margin-bottom: 20px;
        }

        .card-header h2 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary-red);
        }

        .card-info {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .info-tag {
            font-size: 14px;
            background-color: var(--light-gray);
            padding: 6px 12px;
            border-radius: 20px;
        }

        .card-section {
            margin-bottom: 25px;
        }

        .card-section h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--dark-gray);
            display: flex;
            align-items: center;
        }

        .card-section h3 .icon {
            margin-right: 8px;
        }

        .warning-box {
            background-color: rgba(255, 59, 48, 0.1);
            border-left: 4px solid var(--primary-red);
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 0 8px 8px 0;
        }

        .warning-title {
            font-weight: 600;
            color: var(--primary-red);
            margin-bottom: 10px;
        }

        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
        }

        .action-button {
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
        }

        .action-button.primary {
            background-color: var(--primary-red);
            color: white;
        }

        .action-button.secondary {
            background-color: var(--light-gray);
            color: var(--dark-gray);
        }

        .chat-container {
            height: 500px;
            display: flex;
            flex-direction: column;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            position: relative;
        }

        .user-message {
            align-self: flex-end;
            background-color: var(--primary-red);
            color: white;
            border-bottom-right-radius: 6px;
        }

        .ai-message {
            align-self: flex-start;
            background-color: var(--light-gray);
            color: var(--dark-gray);
            border-bottom-left-radius: 6px;
        }

        .message-content {
            font-size: 16px;
            line-height: 1.4;
        }

        .message-time {
            font-size: 12px;
            margin-top: 5px;
            opacity: 0.7;
            text-align: right;
        }

        .chat-input {
            display: flex;
            padding: 15px;
            border-top: 1px solid var(--light-gray);
        }

        .chat-input textarea {
            flex: 1;
            border: 1px solid var(--light-gray);
            border-radius: 18px;
            padding: 12px 16px;
            font-size: 16px;
            resize: none;
            outline: none;
        }

        .send-button {
            margin-left: 15px;
            padding: 0 20px;
            background-color: var(--primary-red);
            color: white;
            border: none;
            border-radius: 18px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            align-self: flex-end;
        }

        .send-button:disabled {
            background-color: var(--light-gray);
            color: var(--medium-gray);
            cursor: not-allowed;
        }

        .auth-container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .auth-form h2 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
            color: var(--dark-gray);
        }

        .auth-button {
            width: 100%;
            padding: 12px;
            background-color: var(--primary-red);
            color: white;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 10px;
        }

        .auth-toggle {
            text-align: center;
            margin-top: 15px;
            font-size: 14px;
            color: var(--medium-gray);
        }

        .auth-toggle span {
            color: var(--primary-red);
            cursor: pointer;
        }

        .data-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .data-action {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .data-action h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark-gray);
        }

        .data-action p {
            font-size: 14px;
            color: var(--medium-gray);
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .status-message {
            margin-top: 10px;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
        }

        .status-message.success {
            background-color: rgba(52, 199, 89, 0.1);
            color: #34C759;
        }

        .status-message.error {
            background-color: rgba(255, 59, 48, 0.1);
            color: var(--primary-red);
        }

        .hidden {
            display: none;
        }

        .file-input {
            display: none;
        }

        .user-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .logout-button {
            padding: 6px 12px;
            background-color: var(--light-gray);
            color: var(--dark-gray);
            border-radius: 6px;
            font-size: 14px;
        }

        .model-selector {
            margin-bottom: 15px;
        }

        .model-selector select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--light-gray);
            border-radius: 6px;
            font-size: 14px;
        }

        .zhipu-login {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--light-gray);
        }

        .zhipu-login h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark-gray);
        }

        .zhipu-link {
            color: var(--primary-red);
            text-decoration: underline;
            margin-left: 5px;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .typing-indicator span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--medium-gray);
            animation: typing 1.4s infinite;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-10px);
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ä¸»åº”ç”¨ç»„ä»¶
        function App() {
            const [activeTab, setActiveTab] = useState('guide'); // 'guide' æˆ– 'ai'
            
            return (
                <div className="app-container">
                    <div className="header">
                        <h1>å°çº¢å¡</h1>
                        <p>å¹¶å‘ç—‡ç®¡ç†æŒ‡å¼•ç”Ÿæˆå™¨</p>
                    </div>
                    
                    <div className="tabs">
                        <div 
                            className={`tab ${activeTab === 'guide' ? 'active' : ''}`}
                            onClick={() => setActiveTab('guide')}
                        >
                            æŒ‡å¼•ç”Ÿæˆ
                        </div>
                        <div 
                            className={`tab ${activeTab === 'ai' ? 'active' : ''}`}
                            onClick={() => setActiveTab('ai')}
                        >
                            AIåŠ©æ‰‹
                        </div>
                    </div>
                    
                    <div className="tab-content">
                        {activeTab === 'guide' ? <GuideGenerator /> : <AIAssistant />}
                    </div>
                </div>
            );
        }

        // æŒ‡å¼•ç”Ÿæˆå™¨ç»„ä»¶
        function GuideGenerator() {
            const [currentStep, setCurrentStep] = useState(0);
            const [selectedComplications, setSelectedComplications] = useState([]);
            const [medicalInfo, setMedicalInfo] = useState({
                name: '',
                age: '',
                bloodType: '',
                mainDiagnosis: '',
                surgeryHistory: '',
                allergies: '',
                otherDiseases: '',
                isOnAnticoagulation: false,
                medicationType: '',
                lastTaken: '',
                stopReason: ''
            });
            const [emergencyContacts, setEmergencyContacts] = useState([]);
            const [hospitals, setHospitals] = useState([]);
            const [newContact, setNewContact] = useState({ name: '', phone: '', relationship: '' });
            const [newHospital, setNewHospital] = useState({ name: '', emergency: '', address: '', features: '' });
            
            // ä»localStorageåŠ è½½æ•°æ®
            useEffect(() => {
                const savedComplications = JSON.parse(localStorage.getItem('selectedComplications') || '[]');
                const savedMedicalInfo = JSON.parse(localStorage.getItem('medicalInfo') || '{}');
                const savedContacts = JSON.parse(localStorage.getItem('emergencyContacts') || '[]');
                const savedHospitals = JSON.parse(localStorage.getItem('hospitals') || '[]');
                
                if (savedComplications.length > 0) {
                    setSelectedComplications(savedComplications);
                }
                
                if (Object.keys(savedMedicalInfo).length > 0) {
                    setMedicalInfo(savedMedicalInfo);
                }
                
                if (savedContacts.length > 0) {
                    setEmergencyContacts(savedContacts);
                }
                
                if (savedHospitals.length > 0) {
                    setHospitals(savedHospitals);
                }
            }, []);
            
            // ä¿å­˜æ•°æ®åˆ°localStorage
            useEffect(() => {
                localStorage.setItem('selectedComplications', JSON.stringify(selectedComplications));
            }, [selectedComplications]);
            
            useEffect(() => {
                localStorage.setItem('medicalInfo', JSON.stringify(medicalInfo));
            }, [medicalInfo]);
            
            useEffect(() => {
                localStorage.setItem('emergencyContacts', JSON.stringify(emergencyContacts));
            }, [emergencyContacts]);
            
            useEffect(() => {
                localStorage.setItem('hospitals', JSON.stringify(hospitals));
            }, [hospitals]);
            
            const complications = [
                { id: 'bleeding', name: 'æ¶ˆåŒ–é“å‡ºè¡€', description: 'å‘•è¡€ã€é»‘ä¾¿ç­‰ç—‡çŠ¶çš„ç´§æ€¥å¤„ç†' },
                { id: 'obstruction', name: 'è‚ æ¢—é˜»', description: 'è…¹ç—›ã€å‘•åã€è…¹èƒ€ç­‰ç—‡çŠ¶çš„ç´§æ€¥å¤„ç†' },
                { id: 'biliary', name: 'èƒ†é“æ¢—é˜»', description: 'é»„ç–¸ã€å‘çƒ­ç­‰ç—‡çŠ¶ç®¡ç†' },
                { id: 'infection', name: 'æ„ŸæŸ“', description: 'å‘çƒ­ã€æ„ŸæŸ“å¾è±¡ç›‘æµ‹' },
                { id: 'ascites', name: 'è…¹æ°´', description: 'è…¹èƒ€ã€è…¹æ°´ç—‡çŠ¶ç®¡ç†' },
                { id: 'thrombosis', name: 'è¡€æ “', description: 'è¡€æ “å½¢æˆé¢„é˜²å’Œå¤„ç†' }
            ];
            
            const handleComplicationChange = (id) => {
                if (selectedComplications.includes(id)) {
                    setSelectedComplications(selectedComplications.filter(c => c !== id));
                } else {
                    setSelectedComplications([...selectedComplications, id]);
                }
            };
            
            const handleMedicalInfoChange = (field, value) => {
                setMedicalInfo({
                    ...medicalInfo,
                    [field]: value
                });
            };
            
            const handleAddContact = () => {
                if (newContact.name && newContact.phone && newContact.relationship) {
                    setEmergencyContacts([...emergencyContacts, newContact]);
                    setNewContact({ name: '', phone: '', relationship: '' });
                }
            };
            
            const handleRemoveContact = (index) => {
                const newContacts = [...emergencyContacts];
                newContacts.splice(index, 1);
                setEmergencyContacts(newContacts);
            };
            
            const handleAddHospital = () => {
                if (newHospital.name && newHospital.emergency && newHospital.address) {
                    setHospitals([...hospitals, newHospital]);
                    setNewHospital({ name: '', emergency: '', address: '', features: '' });
                }
            };
            
            const handleRemoveHospital = (index) => {
                const newHospitals = [...hospitals];
                newHospitals.splice(index, 1);
                setHospitals(newHospitals);
            };
            
            const nextStep = () => {
                if (currentStep < 3) {
                    setCurrentStep(currentStep + 1);
                }
            };
            
            const prevStep = () => {
                if (currentStep > 0) {
                    setCurrentStep(currentStep - 1);
                }
            };
            
            const canProceed = () => {
                switch (currentStep) {
                    case 0: return selectedComplications.length > 0;
                    case 1: return medicalInfo.name && medicalInfo.bloodType;
                    case 2: return emergencyContacts.length > 0 || hospitals.length > 0;
                    default: return true;
                }
            };
            
            const renderStep = () => {
                switch (currentStep) {
                    case 0:
                        return (
                            <div>
                                <h2>é€‰æ‹©å¹¶å‘ç—‡ç±»å‹</h2>
                                <div className="checkbox-group">
                                    {complications.map(comp => (
                                        <div 
                                            key={comp.id}
                                            className={`checkbox-item ${selectedComplications.includes(comp.id) ? 'selected' : ''}`}
                                            onClick={() => handleComplicationChange(comp.id)}
                                        >
                                            <input 
                                                type="checkbox" 
                                                checked={selectedComplications.includes(comp.id)}
                                                onChange={() => {}}
                                            />
                                            <div className="checkbox-item-content">
                                                <h4>{comp.name}</h4>
                                                <p>{comp.description}</p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        );
                    case 1:
                        return (
                            <div>
                                <h2>å¡«å†™ä¸ªäººåŒ»ç–—ä¿¡æ¯</h2>
                                <div className="form-group">
                                    <label>å§“å *</label>
                                    <input 
                                        type="text" 
                                        value={medicalInfo.name}
                                        onChange={(e) => handleMedicalInfoChange('name', e.target.value)}
                                        placeholder="è¯·å¡«å†™æ‚£è€…çœŸå®å§“å"
                                    />
                                </div>
                                <div className="form-group">
                                    <label>å¹´é¾„</label>
                                    <input 
                                        type="text" 
                                        value={medicalInfo.age}
                                        onChange={(e) => handleMedicalInfoChange('age', e.target.value)}
                                        placeholder="è¯·å¡«å†™æ‚£è€…å¹´é¾„"
                                    />
                                </div>
                                <div className="form-group">
                                    <label>è¡€å‹ *</label>
                                    <select 
                                        value={medicalInfo.bloodType}
                                        onChange={(e) => handleMedicalInfoChange('bloodType', e.target.value)}
                                    >
                                        <option value="">è¯·é€‰æ‹©è¡€å‹</option>
                                        <option value="Aå‹">Aå‹</option>
                                        <option value="Bå‹">Bå‹</option>
                                        <option value="ABå‹">ABå‹</option>
                                        <option value="Oå‹">Oå‹</option>
                                    </select>
                                </div>
                                <div className="form-group">
                                    <label>ä¸»è¦è¯Šæ–­</label>
                                    <input 
                                        type="text" 
                                        value={medicalInfo.mainDiagnosis}
                                        onChange={(e) => handleMedicalInfoChange('mainDiagnosis', e.target.value)}
                                        placeholder="å¦‚ï¼šèƒ°è…ºç™Œã€èƒƒç™Œç­‰"
                                    />
                                </div>
                                <div className="form-group">
                                    <label>æ‰‹æœ¯å²</label>
                                    <textarea 
                                        value={medicalInfo.surgeryHistory}
                                        onChange={(e) => handleMedicalInfoChange('surgeryHistory', e.target.value)}
                                        placeholder="è¯·å¡«å†™æ‰‹æœ¯å²"
                                    />
                                </div>
                                <div className="form-group">
                                    <label>è¿‡æ•å²</label>
                                    <input 
                                        type="text" 
                                        value={medicalInfo.allergies}
                                        onChange={(e) => handleMedicalInfoChange('allergies', e.target.value)}
                                        placeholder="è¯·å¡«å†™è¿‡æ•å²"
                                    />
                                </div>
                                <div className="form-group">
                                    <label>å…¶ä»–ç–¾ç—…</label>
                                    <input 
                                        type="text" 
                                        value={medicalInfo.otherDiseases}
                                        onChange={(e) => handleMedicalInfoChange('otherDiseases', e.target.value)}
                                        placeholder="è¯·å¡«å†™å…¶ä»–ç–¾ç—…"
                                    />
                                </div>
                                <div className="form-group">
                                    <label>âš ï¸ æŠ—å‡æ²»ç–—ä¿¡æ¯</label>
                                    <select 
                                        value={medicalInfo.isOnAnticoagulation ? 'true' : 'false'}
                                        onChange={(e) => handleMedicalInfoChange('isOnAnticoagulation', e.target.value === 'true')}
                                    >
                                        <option value="false">å¦</option>
                                        <option value="true">æ˜¯</option>
                                    </select>
                                </div>
                                {medicalInfo.isOnAnticoagulation && (
                                    <>
                                        <div className="form-group">
                                            <label>æŠ—å‡è¯ç‰©ç§ç±»</label>
                                            <input 
                                                type="text" 
                                                value={medicalInfo.medicationType}
                                                onChange={(e) => handleMedicalInfoChange('medicationType', e.target.value)}
                                                placeholder="è¯·å¡«å†™æŠ—å‡è¯ç‰©ç§ç±»"
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>æœ€åæœç”¨æ—¶é—´</label>
                                            <input 
                                                type="text" 
                                                value={medicalInfo.lastTaken}
                                                onChange={(e) => handleMedicalInfoChange('lastTaken', e.target.value)}
                                                placeholder="è¯·å¡«å†™æœ€åæœç”¨æ—¶é—´"
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>åœè¯åŸå› </label>
                                            <input 
                                                type="text" 
                                                value={medicalInfo.stopReason}
                                                onChange={(e) => handleMedicalInfoChange('stopReason', e.target.value)}
                                                placeholder="è¯·å¡«å†™åœè¯åŸå› "
                                            />
                                        </div>
                                    </>
                                )}
                            </div>
                        );
                    case 2:
                        return (
                            <div>
                                <h2>æ·»åŠ ç´§æ€¥è”ç³»äººå’ŒåŒ»é™¢ä¿¡æ¯</h2>
                                <h3>âš ï¸ ç´§æ€¥è”ç³»äºº</h3>
                                {emergencyContacts.map((contact, index) => (
                                    <div key={index} className="contact-item">
                                        <button className="remove-button" onClick={() => handleRemoveContact(index)}>Ã—</button>
                                        <h4>{contact.name} ({contact.relationship})</h4>
                                        <p>ç”µè¯: {contact.phone}</p>
                                    </div>
                                ))}
                                <div className="add-button" onClick={() => {
                                    const nameInput = document.getElementById('contact-name');
                                    const phoneInput = document.getElementById('contact-phone');
                                    const relationshipInput = document.getElementById('contact-relationship');
                                    
                                    if (nameInput.value && phoneInput.value && relationshipInput.value) {
                                        handleAddContact();
                                    }
                                }}>
                                    + æ·»åŠ ç´§æ€¥è”ç³»äºº
                                </div>
                                <div className="form-group">
                                    <label>å§“å</label>
                                    <input 
                                        id="contact-name"
                                        type="text" 
                                        value={newContact.name}
                                        onChange={(e) => setNewContact({...newContact, name: e.target.value})}
                                        placeholder="è¯·å¡«å†™è”ç³»äººå§“å"
                                    />
                                </div>
                                <div className="form-group">
                                    <label>ç”µè¯</label>
                                    <input 
                                        id="contact-phone"
                                        type="text" 
                                        value={newContact.phone}
                                        onChange={(e) => setNewContact({...newContact, phone: e.target.value})}
                                        placeholder="è¯·å¡«å†™è”ç³»äººç”µè¯"
                                    />
                                </div>
                                <div className="form-group">
                                    <label>å…³ç³»</label>
                                    <input 
                                        id="contact-relationship"
                                        type="text" 
                                        value={newContact.relationship}
                                        onChange={(e) => setNewContact({...newContact, relationship: e.target.value})}
                                        placeholder="è¯·å¡«å†™ä¸æ‚£è€…å…³ç³»"
                                    />
                                </div>
                                
                                <h3>âš ï¸ åŒ»é™¢ä¿¡æ¯</h3>
                                {hospitals.map((hospital, index) => (
                                    <div key={index} className="hospital-item">
                                        <button className="remove-button" onClick={() => handleRemoveHospital(index)}>Ã—</button>
                                        <h4>{hospital.name}</h4>
                                        <p>æ€¥è¯Š: {hospital.emergency}</p>
                                        <p>åœ°å€: {hospital.address}</p>
                                        {hospital.features && <p>ç‰¹è‰²: {hospital.features}</p>}
                                    </div>
                                ))}
                                <div className="add-button" onClick={() => {
                                    const nameInput = document.getElementById('hospital-name');
                                    const emergencyInput = document.getElementById('hospital-emergency');
                                    const addressInput = document.getElementById('hospital-address');
                                    
                                    if (nameInput.value && emergencyInput.value && addressInput.value) {
                                        handleAddHospital();
                                    }
                                }}>
                                    + æ·»åŠ åŒ»é™¢ä¿¡æ¯
                                </div>
                                <div className="form-group">
                                    <label>åŒ»é™¢åç§°</label>
                                    <input 
                                        id="hospital-name"
                                        type="text" 
                                        value={newHospital.name}
                                        onChange={(e) => setNewHospital({...newHospital, name: e.target.value})}
                                        placeholder="è¯·å¡«å†™åŒ»é™¢åç§°"
                                    />
                                </div>
                                <div className="form-group">
                                    <label>æ€¥è¯Šç”µè¯</label>
                                    <input 
                                        id="hospital-emergency"
                                        type="text" 
                                        value={newHospital.emergency}
                                        onChange={(e) => setNewHospital({...newHospital, emergency: e.target.value})}
                                        placeholder="è¯·å¡«å†™æ€¥è¯Šç”µè¯"
                                    />
                                </div>
                                <div className="form-group">
                                    <label>åœ°å€</label>
                                    <input 
                                        id="hospital-address"
                                        type="text" 
                                        value={newHospital.address}
                                        onChange={(e) => setNewHospital({...newHospital, address: e.target.value})}
                                        placeholder="è¯·å¡«å†™åŒ»é™¢åœ°å€"
                                    />
                                </div>
                                <div className="form-group">
                                    <label>ç‰¹è‰²</label>
                                    <input 
                                        type="text" 
                                        value={newHospital.features}
                                        onChange={(e) => setNewHospital({...newHospital, features: e.target.value})}
                                        placeholder="è¯·å¡«å†™åŒ»é™¢ç‰¹è‰²ï¼ˆé€‰å¡«ï¼‰"
                                    />
                                </div>
                            </div>
                        );
                    case 3:
                        return <CardPreview 
                            selectedComplications={selectedComplications}
                            medicalInfo={medicalInfo}
                            emergencyContacts={emergencyContacts}
                            hospitals={hospitals}
                        />;
                    default:
                        return null;
                }
            };
            
            return (
                <div>
                    <div className="steps">
                        <div className={`step ${currentStep >= 0 ? 'active' : ''}`}>
                            <div className="step-number">1</div>
                            <div className="step-title">é€‰æ‹©å¹¶å‘ç—‡ç±»å‹</div>
                        </div>
                        <div className={`step ${currentStep >= 1 ? 'active' : ''}`}>
                            <div className="step-number">2</div>
                            <div className="step-title">å¡«å†™ä¸ªäººåŒ»ç–—ä¿¡æ¯</div>
                        </div>
                        <div className={`step ${currentStep >= 2 ? 'active' : ''}`}>
                            <div className="step-number">3</div>
                            <div className="step-title">æ·»åŠ ç´§æ€¥è”ç³»äººå’ŒåŒ»é™¢ä¿¡æ¯</div>
                        </div>
                        <div className={`step ${currentStep >= 3 ? 'active' : ''}`}>
                            <div className="step-number">4</div>
                            <div className="step-title">é¢„è§ˆå’Œä¸‹è½½</div>
                        </div>
                    </div>
                    
                    <div className="step-content">
                        {renderStep()}
                    </div>
                    
                    {currentStep < 3 && (
                        <div className="navigation">
                            <button 
                                className="nav-button prev" 
                                onClick={prevStep}
                                disabled={currentStep === 0}
                            >
                                ä¸Šä¸€æ­¥
                            </button>
                            <button 
                                className={`nav-button ${currentStep === 2 ? 'generate' : 'next'}`} 
                                onClick={nextStep}
                                disabled={!canProceed()}
                            >
                                {currentStep === 2 ? 'ç”ŸæˆæŒ‡å¼•å¡ç‰‡' : 'ä¸‹ä¸€æ­¥'}
                            </button>
                        </div>
                    )}
                </div>
            );
        }

        // å¡ç‰‡é¢„è§ˆç»„ä»¶
        function CardPreview({ selectedComplications, medicalInfo, emergencyContacts, hospitals }) {
            const cardRef = useRef(null);
            const [isGenerating, setIsGenerating] = useState(false);
            
            const handleDownloadImage = async () => {
                if (!cardRef.current) return;
                
                setIsGenerating(true);
                try {
                    const canvas = await html2canvas(cardRef.current, {
                        scale: 2,
                        backgroundColor: '#FFFFFF'
                    });
                    const image = canvas.toDataURL('image/png');
                    const link = document.createElement('a');
                    link.href = image;
                    link.download = `${medicalInfo.name}_å¹¶å‘ç—‡ç®¡ç†æŒ‡å¼•.png`;
                    link.click();
                } catch (error) {
                    console.error('ç”Ÿæˆå›¾ç‰‡å¤±è´¥:', error);
                    alert('ç”Ÿæˆå›¾ç‰‡å¤±è´¥ï¼Œè¯·é‡è¯•');
                } finally {
                    setIsGenerating(false);
                }
            };
            
            const handleDownloadHTML = () => {
                const htmlContent = `
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${medicalInfo.name}çš„å¹¶å‘ç—‡ç®¡ç†æŒ‡å¼•</title>
  <style>
    body {
      font-family: "PingFang SC", "Helvetica Neue", sans-serif;
      background-color: #F2F2F7;
      color: #1C1C1E;
      line-height: 1.6;
      padding: 20px;
    }
    .card-container {
      max-width: 800px;
      margin: 0 auto;
      background-color: #FFFFFF;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      padding: 30px;
    }
    .card-header {
      border-bottom: 1px solid #F2F2F7;
      padding-bottom: 20px;
      margin-bottom: 20px;
    }
    .card-header h2 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 10px;
      color: #FF3B30;
    }
    .card-info {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .info-tag {
      font-size: 14px;
      background-color: #F2F2F7;
      padding: 6px 12px;
      border-radius: 20px;
    }
    .card-section {
      margin-bottom: 25px;
    }
    .card-section h3 {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 15px;
      color: #1C1C1E;
    }
    .warning-box {
      background-color: rgba(255, 59, 48, 0.1);
      border-left: 4px solid #FF3B30;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 0 8px 8px 0;
    }
    .warning-title {
      font-weight: 600;
      color: #FF3B30;
      margin-bottom: 10px;
    }
    .contact-item, .hospital-item {
      background-color: #F2F2F7;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 10px;
    }
    .contact-item h4, .hospital-item h4 {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 5px;
    }
    @media print {
      body {
        background-color: #FFFFFF;
        padding: 0;
      }
      .card-container {
        box-shadow: none;
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="card-container">
    <div class="card-header">
      <h2>${medicalInfo.name}çš„å¹¶å‘ç—‡ç®¡ç†æŒ‡å¼•</h2>
      <div class="card-info">
        <div class="info-tag">è¡€å‹: ${medicalInfo.bloodType}</div>
        <div class="info-tag">å¹´é¾„: ${medicalInfo.age}</div>
        <div class="info-tag">ä¸»è¦è¯Šæ–­: ${medicalInfo.mainDiagnosis}</div>
      </div>
    </div>
    
    <div class="card-section">
      <h3>ğŸ†˜ æ€¥æ•‘æŒ‡å¯¼æ­¥éª¤</h3>
      ${selectedComplications.includes('bleeding') ? `
        <div class="warning-box">
          <div class="warning-title">æ¶ˆåŒ–é“å‡ºè¡€æ€¥æ•‘</div>
          <p>ç«‹å³æ‹¨æ‰“120ï¼Œå‘ŠçŸ¥æ¶ˆåŒ–é“å‡ºè¡€</p>
          <p>ç»å¯¹ç¦é£Ÿç¦æ°´ï¼Œä¿æŒå‘¼å¸é“é€šç•…</p>
          <p>æ”¶é›†å‘•åç‰©ï¼Œç»™åŒ»ç”ŸæŸ¥çœ‹æ€§è´¨</p>
        </div>
      ` : ''}
      
      ${selectedComplications.includes('obstruction') ? `
        <div class="warning-box">
          <div class="warning-title">è‚ æ¢—é˜»æ€¥æ•‘</div>
          <p>ç«‹å³æ‹¨æ‰“120ï¼Œå‘ŠçŸ¥è‚ æ¢—é˜»ç—‡çŠ¶</p>
          <p>ç»å¯¹ç¦é£Ÿç¦æ°´ï¼Œç¦æ­¢ä½¿ç”¨æ­¢ç—›è¯</p>
          <p>ç¦æ­¢å‚¬åï¼Œç¦æ­¢çƒ­æ•·è…¹éƒ¨</p>
        </div>
      ` : ''}
      
      ${selectedComplications.includes('biliary') ? `
        <div class="warning-box">
          <div class="warning-title">èƒ†é“æ¢—é˜»æ€¥æ•‘</div>
          <p>ç«‹å³æ‹¨æ‰“120ï¼Œå‘ŠçŸ¥é»„ç–¸ã€å‘çƒ­ç—‡çŠ¶</p>
          <p>ç»å¯¹ç¦é£Ÿç¦æ°´ï¼Œç›‘æµ‹ä½“æ¸©å˜åŒ–</p>
          <p>è®°å½•è…¹ç—›ã€é»„ç–¸å˜åŒ–æƒ…å†µ</p>
        </div>
      ` : ''}
    </div>
    
    <div class="card-section">
      <h3>ğŸ” ç—…æƒ…è¯Šæ–­å…³é”®æŒ‡å¼•</h3>
      <p>å¯†åˆ‡è§‚å¯Ÿç”Ÿå‘½ä½“å¾ï¼šè¡€å‹ã€å¿ƒç‡ã€ä½“æ¸©</p>
      <p>è®°å½•ç—‡çŠ¶å˜åŒ–ï¼šè…¹ç—›ã€å‘•åã€è…¹èƒ€ã€é»„ç–¸ç­‰</p>
      <p>æ³¨æ„ç‰¹æ®Šç—‡çŠ¶ï¼šå‘•è¡€ã€é»‘ä¾¿ã€åœæ­¢æ’æ°”æ’ä¾¿</p>
    </div>
    
    <div class="card-section">
      <h3>ğŸ›¡ï¸ æ—¥å¸¸æ³¨æ„å’Œé¢„é˜²</h3>
      <p>é¥®é£Ÿï¼šé¿å…éš¾æ¶ˆåŒ–é£Ÿç‰©ï¼ˆç³¯ç±³ã€åšæœç­‰ï¼‰</p>
      <p>æ´»åŠ¨ï¼šä¿æŒé€‚å½“æ´»åŠ¨ï¼Œä¿ƒè¿›è‚ è •åŠ¨</p>
      <p>ç”¨è¯ï¼šéµåŒ»å˜±ç”¨è¯ï¼Œé¿å…è‡ªè¡Œç”¨è¯</p>
    </div>
    
    <div class="card-section">
      <h3>ğŸ¥ è¾…åŠ©æœåŠ¡</h3>
      
      <h4>ç´§æ€¥è”ç³»äºº</h4>
      ${emergencyContacts.map(contact => `
        <div class="contact-item">
          <h4>${contact.name} (${contact.relationship})</h4>
          <p>ç”µè¯: ${contact.phone}</p>
        </div>
      `).join('')}
      
      <h4>åŒ»é™¢ä¿¡æ¯</h4>
      ${hospitals.map(hospital => `
        <div class="hospital-item">
          <h4>${hospital.name}</h4>
          <p>æ€¥è¯Š: ${hospital.emergency}</p>
          <p>åœ°å€: ${hospital.address}</p>
          ${hospital.features ? `<p>ç‰¹è‰²: ${hospital.features}</p>` : ''}
        </div>
      `).join('')}
    </div>
  </div>
</body>
</html>
                `;
                
                const blob = new Blob([htmlContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `${medicalInfo.name}_å¹¶å‘ç—‡ç®¡ç†æŒ‡å¼•.html`;
                link.click();
                URL.revokeObjectURL(url);
            };
            
            const handleExportData = () => {
                const data = {
                    selectedComplications,
                    medicalInfo,
                    emergencyContacts,
                    hospitals,
                    exportDate: new Date().toISOString()
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `å°çº¢å¡é…ç½®_${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
            };
            
            const handleImportData = (e) => {
                const file = e.target.files?.[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const data = JSON.parse(event.target?.result);
                        
                        // éªŒè¯æ•°æ®æ ¼å¼
                        if (!data.selectedComplications || !data.medicalInfo) {
                            throw new Error('æ— æ•ˆçš„é…ç½®æ–‡ä»¶æ ¼å¼');
                        }
                        
                        // ä¿å­˜åˆ°localStorage
                        localStorage.setItem('selectedComplications', JSON.stringify(data.selectedComplications));
                        localStorage.setItem('medicalInfo', JSON.stringify(data.medicalInfo));
                        localStorage.setItem('emergencyContacts', JSON.stringify(data.emergencyContacts || []));
                        localStorage.setItem('hospitals', JSON.stringify(data.hospitals || []));
                        
                        alert('é…ç½®å¯¼å…¥æˆåŠŸï¼è¯·åˆ·æ–°é¡µé¢');
                    } catch (error) {
                        alert('é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Œè¯·é€‰æ‹©æœ‰æ•ˆçš„é…ç½®æ–‡ä»¶');
                        console.error('å¯¼å…¥å¤±è´¥:', error);
                    }
                };
                reader.readAsText(file);
            };
            
            const handleClearData = () => {
                if (window.confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) {
                    localStorage.clear();
                    alert('æ•°æ®å·²æ¸…ç©ºï¼Œè¯·åˆ·æ–°é¡µé¢');
                }
            };
            
            return (
                <div>
                    <div className="card-preview" ref={cardRef}>
                        <div className="card-header">
                            <h2>{medicalInfo.name}çš„å¹¶å‘ç—‡ç®¡ç†æŒ‡å¼•</h2>
                            <div className="card-info">
                                <div className="info-tag">è¡€å‹: {medicalInfo.bloodType}</div>
                                <div className="info-tag">å¹´é¾„: {medicalInfo.age}</div>
                                <div className="info-tag">ä¸»è¦è¯Šæ–­: {medicalInfo.mainDiagnosis}</div>
                            </div>
                        </div>
                        
                        <div className="card-section">
                            <h3><span className="icon">ğŸ†˜</span> æ€¥æ•‘æŒ‡å¯¼æ­¥éª¤</h3>
                            {selectedComplications.includes('bleeding') && (
                                <div className="warning-box">
                                    <div className="warning-title">æ¶ˆåŒ–é“å‡ºè¡€æ€¥æ•‘</div>
                                    <p>ç«‹å³æ‹¨æ‰“120ï¼Œå‘ŠçŸ¥æ¶ˆåŒ–é“å‡ºè¡€</p>
                                    <p>ç»å¯¹ç¦é£Ÿç¦æ°´ï¼Œä¿æŒå‘¼å¸é“é€šç•…</p>
                                    <p>æ”¶é›†å‘•åç‰©ï¼Œç»™åŒ»ç”ŸæŸ¥çœ‹æ€§è´¨</p>
                                </div>
                            )}
                            
                            {selectedComplications.includes('obstruction') && (
                                <div className="warning-box">
                                    <div className="warning-title">è‚ æ¢—é˜»æ€¥æ•‘</div>
                                    <p>ç«‹å³æ‹¨æ‰“120ï¼Œå‘ŠçŸ¥è‚ æ¢—é˜»ç—‡çŠ¶</p>
                                    <p>ç»å¯¹ç¦é£Ÿç¦æ°´ï¼Œç¦æ­¢ä½¿ç”¨æ­¢ç—›è¯</p>
                                    <p>ç¦æ­¢å‚¬åï¼Œç¦æ­¢çƒ­æ•·è…¹éƒ¨</p>
                                </div>
                            )}
                            
                            {selectedComplications.includes('biliary') && (
                                <div className="warning-box">
                                    <div className="warning-title">èƒ†é“æ¢—é˜»æ€¥æ•‘</div>
                                    <p>ç«‹å³æ‹¨æ‰“120ï¼Œå‘ŠçŸ¥é»„ç–¸ã€å‘çƒ­ç—‡çŠ¶</p>
                                    <p>ç»å¯¹ç¦é£Ÿç¦æ°´ï¼Œç›‘æµ‹ä½“æ¸©å˜åŒ–</p>
                                    <p>è®°å½•è…¹ç—›ã€é»„ç–¸å˜åŒ–æƒ…å†µ</p>
                                </div>
                            )}
                        </div>
                        
                        <div className="card-section">
                            <h3><span className="icon">ğŸ”</span> ç—…æƒ…è¯Šæ–­å…³é”®æŒ‡å¼•</h3>
                            <p>å¯†åˆ‡è§‚å¯Ÿç”Ÿå‘½ä½“å¾ï¼šè¡€å‹ã€å¿ƒç‡ã€ä½“æ¸©</p>
                            <p>è®°å½•ç—‡çŠ¶å˜åŒ–ï¼šè…¹ç—›ã€å‘•åã€è…¹èƒ€ã€é»„ç–¸ç­‰</p>
                            <p>æ³¨æ„ç‰¹æ®Šç—‡çŠ¶ï¼šå‘•è¡€ã€é»‘ä¾¿ã€åœæ­¢æ’æ°”æ’ä¾¿</p>
                        </div>
                        
                        <div className="card-section">
                            <h3><span className="icon">ğŸ›¡ï¸</span> æ—¥å¸¸æ³¨æ„å’Œé¢„é˜²</h3>
                            <p>é¥®é£Ÿï¼šé¿å…éš¾æ¶ˆåŒ–é£Ÿç‰©ï¼ˆç³¯ç±³ã€åšæœç­‰ï¼‰</p>
                            <p>æ´»åŠ¨ï¼šä¿æŒé€‚å½“æ´»åŠ¨ï¼Œä¿ƒè¿›è‚ è •åŠ¨</p>
                            <p>ç”¨è¯ï¼šéµåŒ»å˜±ç”¨è¯ï¼Œé¿å…è‡ªè¡Œç”¨è¯</p>
                        </div>
                        
                        <div className="card-section">
                            <h3><span className="icon">ğŸ¥</span> è¾…åŠ©æœåŠ¡</h3>
                            
                            <h4>ç´§æ€¥è”ç³»äºº</h4>
                            {emergencyContacts.map((contact, index) => (
                                <div key={index} className="contact-item">
                                    <h4>{contact.name} ({contact.relationship})</h4>
                                    <p>ç”µè¯: {contact.phone}</p>
                                </div>
                            ))}
                            
                            <h4>åŒ»é™¢ä¿¡æ¯</h4>
                            {hospitals.map((hospital, index) => (
                                <div key={index} className="hospital-item">
                                    <h4>{hospital.name}</h4>
                                    <p>æ€¥è¯Š: {hospital.emergency}</p>
                                    <p>åœ°å€: {hospital.address}</p>
                                    {hospital.features && <p>ç‰¹è‰²: {hospital.features}</p>}
                                </div>
                            ))}
                        </div>
                    </div>
                    
                    <div className="action-buttons">
                        <button 
                            className="action-button primary" 
                            onClick={handleDownloadImage}
                            disabled={isGenerating}
                        >
                            {isGenerating ? 'ç”Ÿæˆä¸­...' : 'ä¸‹è½½ä¸ºå›¾ç‰‡'}
                        </button>
                        <button className="action-button primary" onClick={handleDownloadHTML}>
                            ä¸‹è½½ä¸ºHTML
                        </button>
                    </div>
                    
                    <div className="data-actions">
                        <div className="data-action">
                            <h3>å¯¼å‡ºé…ç½®</h3>
                            <p>å°†å½“å‰é…ç½®å¯¼å‡ºä¸ºJSONæ–‡ä»¶ï¼Œå¯åœ¨å…¶ä»–è®¾å¤‡ä¸Šå¯¼å…¥ä½¿ç”¨</p>
                            <button className="action-button primary" onClick={handleExportData}>
                                å¯¼å‡ºé…ç½®
                            </button>
                        </div>
                        
                        <div className="data-action">
                            <h3>å¯¼å…¥é…ç½®</h3>
                            <p>ä»JSONæ–‡ä»¶å¯¼å…¥é…ç½®ï¼Œæ›¿æ¢å½“å‰æ•°æ®</p>
                            <label className="action-button secondary">
                                é€‰æ‹©æ–‡ä»¶
                                <input 
                                    type="file" 
                                    accept=".json" 
                                    onChange={handleImportData} 
                                    className="file-input"
                                />
                            </label>
                        </div>
                        
                        <div className="data-action">
                            <h3>æ¸…ç©ºæ•°æ®</h3>
                            <p>æ¸…é™¤æ‰€æœ‰æœ¬åœ°å­˜å‚¨çš„æ•°æ®ï¼Œæ¢å¤åˆå§‹çŠ¶æ€</p>
                            <button className="action-button secondary" onClick={handleClearData}>
                                æ¸…ç©ºæ•°æ®
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // AIåŠ©æ‰‹ç»„ä»¶
        function AIAssistant() {
            const [isLogin, setIsLogin] = useState(false);
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [username, setUsername] = useState('');
            const [password, setPassword] = useState('');
            const [confirmPassword, setConfirmPassword] = useState('');
            const [email, setEmail] = useState('');
            const [messages, setMessages] = useState([]);
            const [inputText, setInputText] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [selectedModel, setSelectedModel] = useState('glm-4.5-air'); // é»˜è®¤ä½¿ç”¨glm-4.5-airï¼ˆæ¨èï¼‰
            const [zhipuApiKey, setZhipuApiKey] = useState('');
            const messagesEndRef = useRef(null);

            // æ¨¡æ‹Ÿç™»å½•çŠ¶æ€
            useEffect(() => {
                const loggedIn = localStorage.getItem('isLoggedIn') === 'true';
                if (loggedIn) {
                    setIsLoggedIn(true);
                    setUsername(localStorage.getItem('username') || '');
                    const savedApiKey = localStorage.getItem('zhipuApiKey');
                    if (savedApiKey) {
                        setZhipuApiKey(savedApiKey);
                    }
                    const savedModel = localStorage.getItem('selectedModel');
                    if (savedModel) {
                        setSelectedModel(savedModel);
                    }
                }
            }, []);

            // æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯
            useEffect(() => {
                scrollToBottom();
            }, [messages]);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            };

            const handleRegister = () => {
                if (!username || !password) {
                    alert('è¯·å¡«å†™ç”¨æˆ·åå’Œå¯†ç ');
                    return;
                }
                if (password !== confirmPassword) {
                    alert('ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´');
                    return;
                }
                
                // æ¨¡æ‹Ÿæ³¨å†ŒæˆåŠŸ
                alert('æ³¨å†ŒæˆåŠŸï¼è¯·ç™»å½•');
                setIsLogin(true);
            };

            const handleLogin = () => {
                if (!username || !password) {
                    alert('è¯·å¡«å†™ç”¨æˆ·åå’Œå¯†ç ');
                    return;
                }
                
                if (!zhipuApiKey) {
                    alert('è¯·è¾“å…¥æ™ºè°±AI APIå¯†é’¥');
                    return;
                }
                
                // æ¨¡æ‹Ÿç™»å½•æˆåŠŸ
                setIsLoggedIn(true);
                localStorage.setItem('isLoggedIn', 'true');
                localStorage.setItem('username', username);
                localStorage.setItem('zhipuApiKey', zhipuApiKey);
                localStorage.setItem('selectedModel', selectedModel);
                
                // æ·»åŠ æ¬¢è¿æ¶ˆæ¯
                setMessages([
                    {
                        id: '1',
                        text: `æ‚¨å¥½ï¼Œ${username}ï¼æˆ‘æ˜¯æ‚¨çš„å¹¶å‘ç—‡ç®¡ç†AIåŠ©æ‰‹ï¼Œå½“å‰ä½¿ç”¨çš„æ˜¯${getModelName(selectedModel)}æ¨¡å‹ã€‚æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©æ‚¨çš„å—ï¼Ÿ`,
                        sender: 'ai',
                        timestamp: new Date()
                    }
                ]);
            };

            const handleLogout = () => {
                setIsLoggedIn(false);
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('username');
                localStorage.removeItem('zhipuApiKey');
                localStorage.removeItem('selectedModel');
                setMessages([]);
            };

            const getModelName = (model) => {
                switch(model) {
                    case 'glm-4.5-air': return 'GLM-4.5-Airï¼ˆæ¨èï¼‰';
                    case 'glm-4.5-flash': return 'GLM-4.5-Flashï¼ˆå…è´¹ï¼‰';
                    case 'glm-4.5-plus': return 'GLM-4.5-Plus';
                    case 'glm-4v': return 'GLM-4V';
                    case 'glm-4-air': return 'GLM-4-Air';
                    case 'glm-4-airx': return 'GLM-4-AirX';
                    case 'glm-4-flash': return 'GLM-4-Flash';
                    default: return model;
                }
            };

            const handleSendMessage = async () => {
                if (!inputText.trim()) return;
                
                // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
                const userMessage = {
                    id: Date.now().toString(),
                    text: inputText,
                    sender: 'user',
                    timestamp: new Date()
                };
                
                setMessages(prev => [...prev, userMessage]);
                setInputText('');
                setIsLoading(true);
                
                try {
                    // è°ƒç”¨æ™ºè°±AI API
                    const response = await fetch('https://open.bigmodel.cn/api/paas/v4/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${zhipuApiKey}`
                        },
                        body: JSON.stringify({
                            model: selectedModel,
                            messages: [
                                {
                                    role: 'system',
                                    content: `# Role: å¤šç—…ç§å¹¶å‘ç—‡ä¸“ä¸šåŠ©æ‰‹

## Profile
- language: ä¸­æ–‡
- description: ä¸“æ³¨äºç™Œç—‡ã€ç½•è§ç—…ç­‰å¤šç—…ç§æ²»ç–—ç›¸å…³å¹¶å‘ç—‡ç®¡ç†çš„ä¸“ä¸šåŒ»ç–—åŠ©æ‰‹ï¼Œæ•´åˆå¾ªè¯åŒ»å­¦è¯æ®ã€ä¸´åºŠæŒ‡å—å’Œæ‚£è€…ç»éªŒï¼Œæä¾›å…¨å‘¨æœŸã€å¤šç»´åº¦æ”¯æŒ
- background: åŸºäºå°çº¢å¡æ€¥ç—‡å¤„ç†æŒ‡å¼•ä½“ç³»å¼€å‘çš„æ™ºèƒ½è¾…åŠ©ç³»ç»Ÿï¼Œèåˆæœ€æ–°åŒ»å­¦ç ”ç©¶ã€ä¸´åºŠå®è·µå’Œæ‚£è€…çœŸå®ç»éªŒ
- personality: ä¸“ä¸šæƒå¨ã€æ¸©æš–ä½“è´´ã€è€å¿ƒç»†è‡´ã€ååº”è¿…é€Ÿ
- expertise: ç™Œç—‡ã€ç½•è§ç—…ã€æ…¢æ€§ç—…ç­‰å¤šç—…ç§æ²»ç–—ç›¸å…³å¹¶å‘ç—‡çš„é¢„é˜²ã€è¯†åˆ«ã€å¤„ç†åŠåº·å¤
- target_audience: ç™Œç—‡æ‚£è€…ã€ç½•è§ç—…æ‚£è€…ã€æ…¢æ€§ç—…æ‚£è€…ã€å®¶å±åŠç…§æŠ¤è€…
- core_framework: åŸºäºå°çº¢å¡æ¨¡æ¿çš„å››å¤§æ¨¡å—ä½“ç³»ï¼ˆæ€¥æ•‘æŒ‡å¯¼ã€ç—…æƒ…è¯Šæ–­ã€æ—¥å¸¸é¢„é˜²ã€è¾…åŠ©æœåŠ¡ï¼‰

## Skills
1. **å°çº¢å¡æ¨¡æ¿åº”ç”¨èƒ½åŠ›**: åŸºäºå°çº¢å¡å››å¤§æ¨¡å—æä¾›ç»“æ„åŒ–æ€¥æ•‘æŒ‡å¯¼ï¼Œä½¿ç”¨çº¢ç»¿ç¯è­¦ç¤ºç³»ç»Ÿè¿›è¡Œé£é™©è¯„ä¼°å’Œåˆ†çº§
2. **åŒ»å­¦çŸ¥è¯†æ•´åˆ**: å‡†ç¡®è§£ææœ€æ–°å¤šç—…ç§å¹¶å‘ç—‡ç®¡ç†æŒ‡å—ï¼Œæ•´åˆç½•è§ç—…å¹¶å‘ç—‡çš„ç‰¹æ®Šå¤„ç†è¦ç‚¹
3. **ä¿¡æ¯æ²Ÿé€šä¸é£é™©è­¦ç¤º**: ä½¿ç”¨ğŸ”´ğŸŸ¡ğŸŸ¢ç³»ç»Ÿè¿›è¡Œé£é™©åˆ†å±‚å’Œç´§æ€¥ç¨‹åº¦æ ‡è¯†ï¼Œæä¾›120æ€¥æ•‘è¯æœ¯æ¨¡æ¿
4. **åº”æ€¥ç®¡ç†ä¸ç³»ç»ŸåŒ–å¤„ç†**: æŒ‡å¯¼å¹¶å‘ç—‡æ—©æœŸç—‡çŠ¶ç›‘æµ‹ï¼Œæä¾›å®¶åº­å¤„ç†ä¸åŒ»ç–—å¹²é¢„çš„åˆ†çº§å»ºè®®
5. **å¤šå­¦ç§‘åä½œä¸èµ„æºæ•´åˆ**: è¿æ¥ç™Œç—‡ã€ç½•è§ç—…ç­‰ä¸“ç§‘åŒ»ç”Ÿèµ„æºï¼ŒååŠ©å»ºç«‹ç—…å‹äº’åŠ©ç½‘ç»œ

## è¾“å‡ºç»“æ„è§„èŒƒ

### ğŸš¦ çº¢ç»¿ç¯é£é™©è­¦ç¤ºç³»ç»Ÿ
**å¿…é¡»åœ¨æ¯æ¬¡å›å¤å¼€å¤´ä½¿ç”¨ä»¥ä¸‹æ ¼å¼è¿›è¡Œé£é™©åˆ†å±‚ï¼š**

#### ğŸ”´ ç´§æ€¥å±é™©ï¼ˆç«‹å³å°±åŒ»ï¼‰
ğŸ”´ **ç´§æ€¥è­¦ç¤º**ï¼šæ‚¨çš„ç—‡çŠ¶æç¤ºå¯èƒ½å­˜åœ¨ä¸¥é‡å¹¶å‘ç—‡é£é™©
âš ï¸ **ç«‹å³è¡ŒåŠ¨**ï¼šè¯·ç«‹å³æ‹¨æ‰“120æˆ–å‰å¾€æœ€è¿‘åŒ»é™¢æ€¥è¯Šç§‘
ğŸ“ **120è¯æœ¯**ï¼š"æ‚£è€…ä¸º[ç—…ç§]æ‚£è€…ï¼Œå‡ºç°[å…·ä½“ç—‡çŠ¶]ï¼Œç–‘ä¼¼[å¹¶å‘ç—‡åç§°]"

#### ğŸŸ¡ éœ€è¦å…³æ³¨ï¼ˆåŠæ—¶å°±åŒ»ï¼‰
ğŸŸ¡ **æ³¨æ„è­¦ç¤º**ï¼šæ‚¨çš„ç—‡çŠ¶éœ€è¦åŒ»ç–—ä¸“ä¸šè¯„ä¼°
â° **å»ºè®®æ—¶é—´**ï¼šå»ºè®®24-48å°æ—¶å†…å°±åŒ»
ğŸ¥ **å°±åŒ»ç§‘å®¤**ï¼š[æ¨èç§‘å®¤]

#### ğŸŸ¢ ç›¸å¯¹å®‰å…¨ï¼ˆè§‚å¯Ÿå¤„ç†ï¼‰
ğŸŸ¢ **ç›¸å¯¹å®‰å…¨**ï¼šå½“å‰ç—‡çŠ¶å¯ä»¥å±…å®¶è§‚å¯Ÿå¤„ç†
ğŸ‘€ **å¯†åˆ‡è§‚å¯Ÿ**ï¼šå¦‚å‡ºç°[æ¶åŒ–ç—‡çŠ¶]è¯·åŠæ—¶å°±åŒ»

### ğŸ“‹ å°çº¢å¡å››å¤§æ¨¡å—è¾“å‡ºæ ¼å¼ï¼ˆå¿…é¡»å®Œæ•´è¾“å‡ºï¼Œä¸èƒ½åˆ å‡ï¼‰

#### ğŸ†˜ ç¬¬ä¸€éƒ¨åˆ†ï¼šæ€¥æ•‘æŒ‡å¯¼æ­¥éª¤

## âš ï¸ é‡è¦é£é™©æé†’

\`\`\`diff
! ğŸ”´ ç”Ÿå‘½å±é™©ä¿¡å· - ç«‹å³æ‹¨æ‰“120
!
! âœ… [å…·ä½“å±é™©ç—‡çŠ¶1]
! âœ… [å…·ä½“å±é™©ç—‡çŠ¶2]
! âœ… [å…·ä½“å±é™©ç—‡çŠ¶3]
!
! âŒ ç»å¯¹ç¦æ­¢æ“ä½œ
!
! â€¢ [ç¦æ­¢æ“ä½œ1]
! â€¢ [ç¦æ­¢æ“ä½œ2]
! â€¢ [ç¦æ­¢æ“ä½œ3]
\`\`\`

## ğŸ†˜ 1. ç«‹å³æ‹¨æ‰“120ï¼ˆç¬¬ä¸€æ­¥ï¼‰

### ğŸ“ 120æŠ¥è­¦è¯æœ¯æ¨¡æ¿
\`\`\`diff
! "æ‚¨å¥½ï¼Œè¿™é‡Œæ˜¯[å¹¶å‘ç—‡åç§°]æ€¥æ•‘ï¼Œæ‚£è€…[å§“å]ï¼Œ[å¹´é¾„]å²[æ€§åˆ«]ï¼Œ[æ—¢å¾€ç—…å²]ã€‚
! ç°åœ¨å‡ºç°[å…·ä½“ç—‡çŠ¶]ï¼Œæ‚£è€…è¡€å‹[è¡€å‹]ï¼Œå¯èƒ½éœ€è¦[ç´§æ€¥å¤„ç†]ã€‚
! åœ°å€æ˜¯[å…·ä½“åœ°å€]ï¼Œè”ç³»ç”µè¯[ç”µè¯å·ç ]ã€‚è¯·å°½å¿«æ´¾æ•‘æŠ¤è½¦ï¼"
\`\`\`

## ğŸ©¸ 2. è¡€å‹ä¿¡æ¯ï¼ˆå‘ŠçŸ¥120å’ŒåŒ»é™¢ï¼‰

### ğŸ”´ å…³é”®ä¿¡æ¯å¡
\`\`\`diff
! æ‚£è€…ï¼š[å§“å]
! è¡€å‹ï¼š[è¡€å‹]
! å¹´é¾„ï¼š[å¹´é¾„]å²
! è¯Šæ–­ï¼š[ä¸»è¦ç–¾ç—…]
! ç‰¹æ®Šé£é™©ï¼š[ç›¸å…³é£é™©å› ç´ ]
! è¯ç‰©è¿‡æ•ï¼š[è¿‡æ•å²]
! 7å¤©å†…æŠ—å‡æ²»ç–—ï¼š[æ˜¯/å¦]
\`\`\`

## ğŸ¥ 3. æŒ‡å®šå¤„ç½®åŒ»é™¢ï¼ˆæŒ‰è·ç¦»å’Œä¸“ä¸šåº¦é€‰æ‹©ï¼‰

### ğŸš‘ é¦–é€‰åŒ»é™¢ï¼ˆä¸“ç§‘å¼ºï¼‰

**ğŸ¥‡ [å½“åœ°ä¸‰ç”²åŒ»é™¢1]**
- æ€¥è¯Šç§‘ï¼š[æ€¥è¯Šç§‘ç”µè¯]
- ä¸“ç§‘ï¼š[ç›¸å…³ä¸“ç§‘ç”µè¯]
- åœ°å€ï¼š[åŒ»é™¢åœ°å€]
- ä¼˜åŠ¿ï¼š[ä¸“ç§‘æŠ€æœ¯ç‰¹ç‚¹]
- 120æŒ‡ä»¤ï¼š"è¯·é€å¾€[åŒ»é™¢åç§°]æ€¥è¯Šç§‘ï¼Œæ‚£è€…[å¹¶å‘ç—‡]éœ€è¦ç´§æ€¥å¤„ç†"

**ğŸ¥ˆ [å½“åœ°ä¸‰ç”²åŒ»é™¢2]**
- æ€¥è¯Šç§‘ï¼š[æ€¥è¯Šç§‘ç”µè¯]
- ä¸“ç§‘ï¼š[ç›¸å…³ä¸“ç§‘ç”µè¯]
- åœ°å€ï¼š[åŒ»é™¢åœ°å€]
- ä¼˜åŠ¿ï¼š[ä¸“ç§‘æŠ€æœ¯ç‰¹ç‚¹]

**ğŸ‘¨â€âš•ï¸ ä¸»æ²»åŒ»ç”Ÿè”ç³»**
**[ä¸»æ²»åŒ»ç”Ÿå§“å]ï¼š[è”ç³»æ–¹å¼]**
- ç«‹å³é€šçŸ¥ï¼š"[åŒ»ç”Ÿå§“å]ï¼Œ[æ‚£è€…å§“å]å‡ºç°[å¹¶å‘ç—‡]ï¼Œæ­£åœ¨é€å¾€[åŒ»é™¢åç§°]æ€¥è¯Šç§‘ï¼Œè¯·ååŠ©è”ç³»æ¥è¯Š"

## ğŸš— 4. æ•‘æŠ¤è½¦åˆ°è¾¾å‰å¤„ç†ï¼ˆç­‰å¾…æœŸé—´ï¼‰

### ğŸ”´ ç«‹å³è¡ŒåŠ¨ï¼ˆå‰5åˆ†é’Ÿï¼‰
\`\`\`diff
! 1. ä½“ä½ç®¡ç†ï¼š[å…·ä½“ä½“ä½è¦æ±‚]
! 2. ç»å¯¹ç¦é£Ÿç¦æ°´ï¼š[å…·ä½“è¦æ±‚]
! 3. ä¿æŒå‘¼å¸é“é€šç•…ï¼š[å…·ä½“æ“ä½œ]
! 4. [å…¶ä»–ç´§æ€¥å¤„ç†]
\`\`\`

### ğŸ  å®¶ä¸­å‡†å¤‡
**å¿…å¤‡ç‰©å“æ¸…å•ï¼š**
- [ ] [å¿…å¤‡ç‰©å“1]
- [ ] [å¿…å¤‡ç‰©å“2]
- [ ] [å¿…å¤‡ç‰©å“3]

### ğŸš— äº¤é€šå®‰æ’
**ä¼˜å…ˆçº§æ’åºï¼š**
1. **120æ€¥æ•‘è½¦**ï¼ˆé‡ç—‡é¦–é€‰ï¼‰
2. **å‡ºç§Ÿè½¦/ç½‘çº¦è½¦**ï¼ˆå‘ŠçŸ¥å¸æœºæƒ…å†µï¼‰
3. **é¿å…**ï¼š[ä¸é€‚å®œçš„äº¤é€šæ–¹å¼]

## ğŸš¨ 5. æ•‘æŠ¤è½¦ä¸Šå¤„ç†è¦ç‚¹

### ğŸ“‹ ç»™æ€¥æ•‘åŒ»ç”Ÿçš„ä¿¡æ¯
\`\`\`diff
! å¿«é€Ÿæ±‡æŠ¥ï¼š
! "æ‚£è€…[å§“å]ï¼Œ[å¹´é¾„]å²ï¼Œ[ä¸»è¦ç–¾ç—…]ï¼Œ[è¡€å‹]è¡€ã€‚[æ—¶é—´]å¼€å§‹[ç—‡çŠ¶]ï¼Œ
! ç›®å‰è¡€å‹[æ•°å€¼]ï¼Œå¿ƒç‡[æ•°å€¼]ï¼Œæ„è¯†[çŠ¶æ€]ã€‚
! æœ‰[ç›¸å…³é£é™©å› ç´ ]ï¼Œæ€€ç–‘[å¹¶å‘ç—‡]ã€‚"
\`\`\`

### ğŸ©º é…åˆæ€¥æ•‘å¤„ç†
\`\`\`diff
! 1. æä¾›ç—…å†èµ„æ–™ï¼š[å…·ä½“èµ„æ–™]
! 2. ååŠ©å»ºç«‹é™è„‰é€šè·¯ï¼š[é…åˆè¦ç‚¹]
! 3. å‡†å¤‡è½¬è¿ï¼š[å¿…éœ€å“æ¸…å•]
! 4. å®¶å±é™ªåŒï¼š[é™ªåŒå®‰æ’]
\`\`\`

### ğŸ“ è·¯ä¸Šè”ç³»åŒ»é™¢
\`\`\`diff
! ç»™æ€¥è¯Šç§‘çš„ç”µè¯ï¼š
! "æ‚¨å¥½ï¼Œ120æ­£åœ¨é€ä¸€ä½[å¹¶å‘ç—‡]æ‚£è€…è¿‡æ¥ï¼Œæ‚£è€…[å§“å]ï¼Œ[è¡€å‹]è¡€ï¼Œ[ç–¾ç—…]ç—…å²ï¼Œé¢„è®¡[æ—¶é—´]åˆ°è¾¾ã€‚
! æ‚£è€…å¯èƒ½éœ€è¦[ç´§æ€¥å¤„ç†]ï¼Œè¯·å‡†å¤‡æ¥è¯Šã€‚"
\`\`\`

---

#### ğŸ” ç¬¬äºŒéƒ¨åˆ†ï¼šç—…æƒ…è¯Šæ–­å…³é”®æŒ‡å¼•

## ğŸ¥ åˆ°é™¢æµç¨‹
1. **æŒ‚å·**ï¼šç›´æ¥æ€¥è¯Šç§‘ï¼Œè¯´æ˜[å¹¶å‘ç—‡]ç—‡çŠ¶
2. **åˆ†è¯Š**ï¼šé…åˆæŠ¤å£«å¿«é€Ÿè¯„ä¼°ï¼Œä¼˜å…ˆå¤„ç†
3. **æ£€æŸ¥**ï¼š[ç›¸å…³æ£€æŸ¥é¡¹ç›®]
4. **æ²»ç–—**ï¼š[æ²»ç–—æ–¹æ¡ˆ]

## ğŸ”¬ [å¹¶å‘ç—‡]æ£€æŸ¥æŒ‡å—

### ğŸ“¸ [æ£€æŸ¥æ–¹æ³•1]ï¼ˆé¦–é€‰åˆç­›ï¼‰
**æ£€æŸ¥ä¼˜åŠ¿ï¼š**
- [ä¼˜åŠ¿1]
- [ä¼˜åŠ¿2]
- [ä¼˜åŠ¿3]

**å…¸å‹å¾è±¡ï¼š**
- **[å¾è±¡1]**ï¼š[å…·ä½“æè¿°]
- **[å¾è±¡2]**ï¼š[å…·ä½“æè¿°]
- **[å¾è±¡3]**ï¼š[å…·ä½“æè¿°]

### ğŸ–¥ï¸ [æ£€æŸ¥æ–¹æ³•2]ï¼ˆé‡‘æ ‡å‡†è¯Šæ–­ï¼‰
**æ£€æŸ¥é€‚åº”ç—‡ï¼š**
- [é€‚åº”ç—‡1]
- [é€‚åº”ç—‡2]
- [é€‚åº”ç—‡3]

**å…¸å‹å¾è±¡ï¼š**
- **[å¾è±¡1]**ï¼š[å…·ä½“æè¿°]
- **[å¾è±¡2]**ï¼š[å…·ä½“æè¿°]

### ğŸš¨ ç´§æ€¥å¾è±¡ï¼ˆç«‹å³æ‰‹æœ¯æŒ‡å¾ï¼‰
**ç»å¯¹æ‰‹æœ¯æŒ‡å¾ï¼š**
- **[å¾è±¡1]**ï¼š[å…·ä½“æè¿°]
- **[å¾è±¡2]**ï¼š[å…·ä½“æè¿°]
- **[å¾è±¡3]**ï¼š[å…·ä½“æè¿°]

## âš ï¸ é£é™©è¯„ä¼°ä½“ç³»

### ğŸ”´ é«˜å±é£é™©ä¿¡å·
**ç«‹å³å‘¼å«120ï¼š**
- [é«˜å±ç—‡çŠ¶1]
- [é«˜å±ç—‡çŠ¶2]
- [é«˜å±ç—‡çŠ¶3]

### ğŸŸ¨ ä¸­ç­‰é£é™©ç®¡ç†
**å¯†åˆ‡è§‚å¯Ÿï¼Œå‡†å¤‡å°±åŒ»ï¼š**
- [ä¸­å±ç—‡çŠ¶1]
- [ä¸­å±ç—‡çŠ¶2]
- [ä¸­å±ç—‡çŠ¶3]

### ğŸŸ¢ ä½é£é™©ç›‘æŠ¤
**å±…å®¶è§‚å¯Ÿï¼Œå®šæœŸå¤æŸ¥ï¼š**
- [ä½å±ç—‡çŠ¶1]
- [ä½å±ç—‡çŠ¶2]
- [ä½å±ç—‡çŠ¶3]

### ğŸ“Š ç—‡çŠ¶è®°å½•è¡¨

**æ—¥æœŸæ—¶é—´ï¼š** ___________
**[ä¸»è¦ç—‡çŠ¶]ï¼š**
- [ ] [ç—‡çŠ¶é€‰é¡¹1]ï¼ˆç¨‹åº¦ï¼š_______ï¼‰
- [ ] [ç—‡çŠ¶é€‰é¡¹2]ï¼ˆç¨‹åº¦ï¼š_______ï¼‰
- [ ] [ç—‡çŠ¶é€‰é¡¹3]ï¼ˆç¨‹åº¦ï¼š_______ï¼‰

**ç”Ÿå‘½ä½“å¾ï¼š**
- è¡€å‹ï¼š_______mmHg
- å¿ƒç‡ï¼š_______æ¬¡/åˆ†
- ä½“æ¸©ï¼š_______Â°C
- å‘¼å¸ï¼š_______æ¬¡/åˆ†

---

#### ğŸ›¡ï¸ ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ—¥å¸¸æ³¨æ„å’Œé¢„é˜²

## ğŸ”„ å¤æ‚æƒ…å†µå¤„ç†

### ğŸ¥ [å¹¶å‘ç—‡]å¤å‘æƒ…å†µè¯´æ˜
**[å¹¶å‘ç—‡]ä¼šå¤šæ¬¡å‡ºç°ï¼Œç¬¬ä¸€æ¬¡å¤„ç†å¤§è‡´ä¸€æ ·ï¼Œå› æ­¤é€‰æ‹©ä¸‰ç”²åŒ»é™¢ï¼Œä½†æ˜¯åç»­æƒ…å†µä¼šè¶Šæ¥è¶Šéš¾ã€‚**

**å¤å‘æ€§[å¹¶å‘ç—‡]ç‰¹ç‚¹ï¼š**
1. [ç‰¹ç‚¹1]
2. [ç‰¹ç‚¹2]
3. [ç‰¹ç‚¹3]

### ğŸ¥ ä¸‰ç”²åŒ»é™¢é€‰æ‹©ï¼ˆæ¨èé¡ºåºï¼‰
**é¦–é€‰ï¼š[å½“åœ°é¡¶çº§ä¸‰ç”²åŒ»é™¢]**
- [ä¸“ç§‘]ï¼š[æŠ€æœ¯æ°´å¹³]
- [æŠ€æœ¯ç‰¹è‰²]ï¼š[å…·ä½“æè¿°]
- è”ç³»æ–¹å¼ï¼š[åŒ»é™¢ç”µè¯]

**æ¬¡é€‰ï¼š[å½“åœ°çŸ¥åä¸‰ç”²åŒ»é™¢]**
- [ä¸“ç§‘]å®åŠ›å¼ºåŠ²
- [å¹¶å‘ç—‡]å¤„ç†ç»éªŒä¸°å¯Œ
- è”ç³»æ–¹å¼ï¼š[åŒ»é™¢ç”µè¯]

### ğŸ¥ ä¸“ç§‘åŒ»é™¢é€‰æ‹©

**âš ï¸ é‡è¦æé†’ï¼šé€‰æ‹©éœ€è°¨æ…ï¼å»ºè®®é€‰æ‹©æ­£è§„åŒ»é™¢çš„ä¸“ç§‘åŒ»ç”Ÿã€‚**

**ğŸ¥‡ [å½“åœ°ä¸“ç§‘åŒ»é™¢]ï¼ˆæ¨èï¼‰**
- **åœ°å€**ï¼š[åŒ»é™¢åœ°å€]
- **ç‰¹ç‚¹**ï¼š[åŒ»é™¢ç‰¹è‰²]
- **ç§‘å®¤ä¸»ä»»**ï¼š[ä¸»ä»»å§“å]
- **æ¨èåŒ»ç”Ÿ**ï¼š[åŒ»ç”Ÿå§“å]ï¼ˆ[èŒç§°]ï¼‰

**ğŸ‘¨â€âš•ï¸ [ä¸“ç§‘åŒ»ç”Ÿ]è¯¦ç»†ä¿¡æ¯ï¼š**
- **ä¸“ä¸šèƒŒæ™¯**ï¼š[æ•™è‚²èƒŒæ™¯]
- **ä¸“ä¸šç‰¹é•¿**ï¼š[ä¸“ä¸šé¢†åŸŸ]
- **ä¸´åºŠç»éªŒ**ï¼š[ç»éªŒæè¿°]
- **æ“…é•¿æŠ€æœ¯**ï¼š
  - [æŠ€æœ¯1]
  - [æŠ€æœ¯2]
  - [æŠ€æœ¯3]

### ğŸ” åŒ»é™¢é€‰æ‹©ç­–ç•¥
**é¦–æ¬¡[å¹¶å‘ç—‡]ï¼š** ä¼˜å…ˆé€‰æ‹©ä¸‰ç”²åŒ»é™¢
**å¤å‘[å¹¶å‘ç—‡]ï¼š** å¯è€ƒè™‘æœ‰ç»éªŒçš„ä¸“ç§‘åŒ»ç”Ÿ
**ç´§æ€¥æƒ…å†µï¼š** å°±è¿‘åŸåˆ™ï¼Œç¨³å®šåè½¬é™¢
**ä¿å®ˆæ²»ç–—ï¼š** å¯é€‰æ‹©æœ‰ä¸“ç§‘çš„åŒ»é™¢

## ğŸ½ï¸ é¥®é£Ÿé¢„é˜²åŸåˆ™

### âŒ é«˜é£é™©é£Ÿç‰©é¿å…
- **[é£Ÿç‰©ç±»å‹1]**ï¼š[å…·ä½“é£Ÿç‰©]
- **[é£Ÿç‰©ç±»å‹2]**ï¼š[å…·ä½“é£Ÿç‰©]
- **[é£Ÿç‰©ç±»å‹3]**ï¼š[å…·ä½“é£Ÿç‰©]

### âœ… æ¨èå®‰å…¨é¥®é£Ÿ
- **[é£Ÿç‰©ç±»å‹1]**ï¼š[å…·ä½“é£Ÿç‰©]
- **[é£Ÿç‰©ç±»å‹2]**ï¼š[å…·ä½“é£Ÿç‰©]
- **[é£Ÿç‰©ç±»å‹3]**ï¼š[å…·ä½“é£Ÿç‰©]

## ğŸƒâ€â™‚ï¸ è¿åŠ¨å’Œç”Ÿæ´»æ–¹å¼

### âœ… é€‚å®œæ´»åŠ¨
- [æ´»åŠ¨1]
- [æ´»åŠ¨2]
- [æ´»åŠ¨3]

### âŒ é¿å…æ´»åŠ¨
- [æ´»åŠ¨1]
- [æ´»åŠ¨2]
- [æ´»åŠ¨3]

## ğŸ’Š ç”¨è¯å®‰å…¨æŒ‡å¯¼

### âš ï¸ éœ€è°¨æ…ä½¿ç”¨çš„è¯ç‰©
- [è¯ç‰©1]ï¼ˆ[åŸå› ]ï¼‰
- [è¯ç‰©2]ï¼ˆ[åŸå› ]ï¼‰
- [è¯ç‰©3]ï¼ˆ[åŸå› ]ï¼‰

### ğŸ“‹ ç”¨è¯å‰å¿…é¡»å’¨è¯¢åŒ»ç”Ÿ
- [è¯ç‰©ç±»å‹1]
- [è¯ç‰©ç±»å‹2]
- [è¯ç‰©ç±»å‹3]

## ğŸ” å®šæœŸç›‘æµ‹æŒ‡æ ‡

### ğŸ“… æ¯å‘¨è‡ªæˆ‘æ£€æŸ¥
- [ç›‘æµ‹æŒ‡æ ‡1]
- [ç›‘æµ‹æŒ‡æ ‡2]
- [ç›‘æµ‹æŒ‡æ ‡3]

### ğŸ¥ æ¯æœˆåŒ»é™¢å¤æŸ¥
- [æ£€æŸ¥é¡¹ç›®1]
- [æ£€æŸ¥é¡¹ç›®2]
- [æ£€æŸ¥é¡¹ç›®3]

## ğŸ¥ åº·å¤æœŸç®¡ç†

### ğŸ“… å‡ºé™¢åæŠ¤ç†è®¡åˆ’
**ç¬¬1-3å¤©ï¼ˆæ€¥æ€§æœŸåï¼‰ï¼š**
- [æŠ¤ç†è¦ç‚¹1]
- [æŠ¤ç†è¦ç‚¹2]
- [æŠ¤ç†è¦ç‚¹3]

**ç¬¬4-7å¤©ï¼ˆæ¢å¤æœŸï¼‰ï¼š**
- [æŠ¤ç†è¦ç‚¹1]
- [æŠ¤ç†è¦ç‚¹2]
- [æŠ¤ç†è¦ç‚¹3]

**ç¬¬2-4å‘¨ï¼ˆç¨³å®šæœŸï¼‰ï¼š**
- [æŠ¤ç†è¦ç‚¹1]
- [æŠ¤ç†è¦ç‚¹2]
- [æŠ¤ç†è¦ç‚¹3]

### ğŸš¨ å¤å‘é¢„è­¦ä¿¡å·
**ç«‹å³å°±åŒ»çš„ç—‡çŠ¶ï¼š**
- [ç—‡çŠ¶1]
- [ç—‡çŠ¶2]
- [ç—‡çŠ¶3]

---

#### ğŸ¥ ç¬¬å››éƒ¨åˆ†ï¼šè¾…åŠ©æœåŠ¡

## ğŸ“‹ ä¸ªäººåŒ»ç–—ä¿¡æ¯å¡

### åŸºæœ¬ä¿¡æ¯
\`\`\`
å§“åï¼š[æ‚£è€…å§“å]          è¡€å‹ï¼š[è¡€å‹]
å¹´é¾„ï¼š[å¹´é¾„]å²           èº«ä»½è¯ï¼š[èº«ä»½è¯å·]
è”ç³»ç”µè¯ï¼š[è”ç³»ç”µè¯]      ç´§æ€¥è”ç³»äººï¼š[å§“å] [ç”µè¯]
\`\`\`

### ç–¾ç—…å²
- **ä¸»è¦è¯Šæ–­**ï¼š[ä¸»è¦ç–¾ç—…]
- **æ—¢å¾€æ‰‹æœ¯**ï¼š[æ‰‹æœ¯å²]
- **è¯ç‰©è¿‡æ•**ï¼š[è¿‡æ•å²]
- **å®¶æ—å²**ï¼š[å®¶æ—ç—…å²]

### å½“å‰ç”¨è¯
- **[è¯ç‰©1]**ï¼š[å‰‚é‡] [ç”¨æ³•]
- **[è¯ç‰©2]**ï¼š[å‰‚é‡] [ç”¨æ³•]
- **[è¯ç‰©3]**ï¼š[å‰‚é‡] [ç”¨æ³•]

### ç´§æ€¥è”ç³»äºº
1. **[è”ç³»äºº1]**ï¼š[å…³ç³»] [ç”µè¯]
2. **[è”ç³»äºº2]**ï¼š[å…³ç³»] [ç”µè¯]
3. **[è”ç³»äºº3]**ï¼š[å…³ç³»] [ç”µè¯]

### åŒ»ç–—å›¢é˜Ÿ
- **ä¸»æ²»åŒ»ç”Ÿ**ï¼š[å§“å] [ç§‘å®¤] [ç”µè¯]
- **æŠ¤ç†å›¢é˜Ÿ**ï¼š[è”ç³»æ–¹å¼]
- **è¯å¸ˆå’¨è¯¢**ï¼š[è”ç³»æ–¹å¼]

## ğŸ¥ åŒ»ç–—èµ„æº

### ğŸš‘ æ€¥æ•‘èµ„æº
- **120æ€¥æ•‘**ï¼š120
- **åŒ»é™¢æ€¥è¯Š**ï¼š[åŒ»é™¢åç§°] [ç”µè¯]
- **ä¸“ç§‘æ€¥è¯Š**ï¼š[ä¸“ç§‘åç§°] [ç”µè¯]

### ğŸ‘¨â€âš•ï¸ ä¸“å®¶èµ„æº
- **[ä¸“ç§‘1]ä¸“å®¶**ï¼š[å§“å] [è”ç³»æ–¹å¼]
- **[ä¸“ç§‘2]ä¸“å®¶**ï¼š[å§“å] [è”ç³»æ–¹å¼]
- **å¤šå­¦ç§‘ä¼šè¯Š**ï¼š[è”ç³»æ–¹å¼]

### ğŸ¥ æ£€æŸ¥èµ„æº
- **å½±åƒæ£€æŸ¥**ï¼š[åŒ»é™¢åç§°] [é¢„çº¦ç”µè¯]
- **å®éªŒå®¤æ£€æŸ¥**ï¼š[åŒ»é™¢åç§°] [é¢„çº¦ç”µè¯]
- **ç‰¹æ®Šæ£€æŸ¥**ï¼š[æ£€æŸ¥é¡¹ç›®] [é¢„çº¦æ–¹å¼]

### ğŸ’Š è¯ç‰©èµ„æº
- **åŒ»é™¢è¯æˆ¿**ï¼š[è”ç³»æ–¹å¼]
- **ç¤¾åŒºè¯æˆ¿**ï¼š[åœ°å€] [ç”µè¯]
- **ç‰¹æ®Šè¯ç‰©**ï¼š[è·å–é€”å¾„]

## ğŸ¤ æŠ¤ç†æœåŠ¡

### ğŸ  å±…å®¶æŠ¤ç†
- **æŠ¤ç†æœºæ„**ï¼š[æœºæ„åç§°] [è”ç³»æ–¹å¼]
- **æŠ¤ç†å†…å®¹**ï¼š[æœåŠ¡é¡¹ç›®]
- **æ”¶è´¹æ ‡å‡†**ï¼š[è´¹ç”¨è¯´æ˜]

### ğŸ‘¥ å®¶å±åŸ¹è®­
- **æŠ¤ç†æŠ€èƒ½åŸ¹è®­**ï¼š[åŸ¹è®­å†…å®¹]
- **æ€¥æ•‘æŠ€èƒ½åŸ¹è®­**ï¼š[åŸ¹è®­å®‰æ’]
- **å¿ƒç†æ”¯æŒ**ï¼š[æ”¯æŒèµ„æº]

### ğŸ“± åœ¨çº¿æœåŠ¡
- **è¿œç¨‹å’¨è¯¢**ï¼š[å¹³å°åç§°] [ä½¿ç”¨æ–¹å¼]
- **å¥åº·ç›‘æµ‹**ï¼š[ç›‘æµ‹å·¥å…·]
- **ç”¨è¯æé†’**ï¼š[æé†’å·¥å…·]

## ğŸ“ 24å°æ—¶æœåŠ¡çƒ­çº¿

### ğŸš¨ ç´§æ€¥è”ç³»
- **120æ€¥æ•‘**ï¼š120
- **åŒ»é™¢æ€»æœº**ï¼š[ç”µè¯]
- **æ€¥è¯Šç§‘**ï¼š[ç”µè¯]

### ğŸ’¬ å’¨è¯¢æœåŠ¡
- **åŒ»ç”Ÿå’¨è¯¢**ï¼š[ç”µè¯]
- **æŠ¤ç†å’¨è¯¢**ï¼š[ç”µè¯]
- **è¯ç‰©å’¨è¯¢**ï¼š[ç”µè¯]

### ğŸ†˜ å¿ƒç†æ”¯æŒ
- **å¿ƒç†çƒ­çº¿**ï¼š[ç”µè¯]
- **æ‚£è€…äº’åŠ©**ï¼š[è”ç³»æ–¹å¼]
- **å®¶å±æ”¯æŒ**ï¼š[è”ç³»æ–¹å¼]

## Rules
- ğŸ”´çº¢ç¯æƒ…å†µå¿…é¡»æ˜ç¡®æŒ‡å¯¼ç«‹å³å°±åŒ»
- ä¸æ›¿ä»£ä¸“ä¸šåŒ»ç–—è¯Šæ–­ï¼Œä»…æä¾›å‚è€ƒæŒ‡å¯¼
- ç´§æ€¥æƒ…å†µä¼˜å…ˆå»ºè®®æ‹¨æ‰“120æˆ–ç«‹å³å°±åŒ»
- å¿…é¡»æŒ‰ç…§å°çº¢å¡å››å¤§æ¨¡å—ç»“æ„å®Œæ•´è¾“å‡ºï¼Œä¸èƒ½åˆ å‡ä»»ä½•éƒ¨åˆ†
- å¿…é¡»ä½¿ç”¨çº¢ç»¿ç¯è­¦ç¤ºç³»ç»Ÿè¿›è¡Œé£é™©åˆ†å±‚
- è¾“å‡ºçš„HTMLç»“æ„å¿…é¡»ä¸æŒ‡å¼•å¡æ¨¡æ¿ä¿æŒä¸€è‡´

ä½œä¸ºå¤šç—…ç§å¹¶å‘ç—‡ä¸“ä¸šåŠ©æ‰‹ï¼Œè¯·ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°å®Œæ•´æ ¼å¼æä¾›ä¸“ä¸šã€å‡†ç¡®ã€æ˜“äºç†è§£çš„åŒ»ç–—å»ºè®®ï¼Œç¡®ä¿å››å¤§æ¨¡å—ç»“æ„å®Œæ•´ï¼Œä¸èƒ½åˆ å‡ã€‚`
                                },
                                {
                                    role: 'user',
                                    content: inputText
                                }
                            ],
                            max_tokens: 8000,
                            temperature: 0.7
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error('APIè¯·æ±‚å¤±è´¥');
                    }
                    
                    const data = await response.json();
                    const aiResponse = data.choices[0].message.content;
                    
                    // æ·»åŠ AIå›å¤
                    const aiMessage = {
                        id: (Date.now() + 1).toString(),
                        text: aiResponse,
                        sender: 'ai',
                        timestamp: new Date()
                    };
                    
                    setMessages(prev => [...prev, aiMessage]);
                } catch (error) {
                    console.error('APIè°ƒç”¨å¤±è´¥:', error);
                    
                    // å¦‚æœAPIè°ƒç”¨å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°å›å¤ä½œä¸ºåå¤‡
                    const fallbackResponse = getAIResponse(inputText);
                    const aiMessage = {
                        id: (Date.now() + 1).toString(),
                        text: fallbackResponse,
                        sender: 'ai',
                        timestamp: new Date()
                    };
                    
                    setMessages(prev => [...prev, aiMessage]);
                } finally {
                    setIsLoading(false);
                }
            };

            const getAIResponse = (question) => {
                // ç®€å•çš„å›å¤é€»è¾‘ï¼Œä½œä¸ºAPIè°ƒç”¨å¤±è´¥æ—¶çš„åå¤‡
                const lowerQuestion = question.toLowerCase();
                
                if (lowerQuestion.includes('è‚ æ¢—é˜»')) {
                    return 'è‚ æ¢—é˜»çš„å¸¸è§ç—‡çŠ¶åŒ…æ‹¬è…¹ç—›ã€å‘•åã€è…¹èƒ€å’Œåœæ­¢æ’æ°”æ’ä¾¿ã€‚ç´§æ€¥æƒ…å†µä¸‹åº”ç«‹å³æ‹¨æ‰“120ï¼Œå¹¶ä¸¥æ ¼ç¦é£Ÿç¦æ°´ã€‚';
                } else if (lowerQuestion.includes('å‡ºè¡€')) {
                    return 'æ¶ˆåŒ–é“å‡ºè¡€çš„å…¸å‹ç—‡çŠ¶æ˜¯å‘•è¡€å’Œé»‘ä¾¿ã€‚å¦‚æœå‡ºç°å¤§é‡å‘•è¡€æˆ–é»‘ä¾¿ä¼´å¤´æ™•ã€å¿ƒæ…Œï¼Œåº”ç«‹å³æ‹¨æ‰“120å°±åŒ»ã€‚';
                } else if (lowerQuestion.includes('é¥®é£Ÿ')) {
                    return 'å¹¶å‘ç—‡æ‚£è€…åº”é¿å…éš¾æ¶ˆåŒ–é£Ÿç‰©å¦‚ç³¯ç±³ã€åšæœï¼Œä»¥åŠæ˜“èƒ€æ°”é£Ÿç‰©å¦‚è±†ç±»ã€‚å»ºè®®é€‰æ‹©æµè´¨æˆ–åŠæµè´¨æ˜“æ¶ˆåŒ–é£Ÿç‰©ã€‚';
                } else if (lowerQuestion.includes('è¯ç‰©')) {
                    return 'è¯·ä¸¥æ ¼éµåŒ»å˜±ç”¨è¯ï¼Œç‰¹åˆ«æ˜¯æŠ—å‡è¯ç‰©ã€‚å¦‚æœ‰ä»»ä½•è¯ç‰©å‰¯ä½œç”¨æˆ–ç–‘é—®ï¼Œè¯·åŠæ—¶å’¨è¯¢åŒ»ç”Ÿã€‚';
                } else {
                    return 'æ„Ÿè°¢æ‚¨çš„æé—®ã€‚å…³äºå¹¶å‘ç—‡ç®¡ç†ï¼Œå»ºè®®æ‚¨å’¨è¯¢ä¸“ä¸šåŒ»ç”Ÿè·å–ä¸ªæ€§åŒ–å»ºè®®ã€‚æ‚¨è¿˜æœ‰å…¶ä»–é—®é¢˜å—ï¼Ÿ';
                }
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    handleSendMessage();
                }
            };

            if (!isLoggedIn) {
                return (
                    <div className="auth-container">
                        {!isLogin ? (
                            <div className="auth-form">
                                <h2>æ³¨å†Œè´¦å·</h2>
                                <div className="form-group">
                                    <label>ç”¨æˆ·å</label>
                                    <input 
                                        type="text" 
                                        value={username} 
                                        onChange={(e) => setUsername(e.target.value)} 
                                        placeholder="è¯·è¾“å…¥ç”¨æˆ·å" 
                                    />
                                </div>
                                <div className="form-group">
                                    <label>å¯†ç </label>
                                    <input 
                                        type="password" 
                                        value={password} 
                                        onChange={(e) => setPassword(e.target.value)} 
                                        placeholder="è¯·è¾“å…¥å¯†ç " 
                                    />
                                </div>
                                <div className="form-group">
                                    <label>ç¡®è®¤å¯†ç </label>
                                    <input 
                                        type="password" 
                                        value={confirmPassword} 
                                        onChange={(e) => setConfirmPassword(e.target.value)} 
                                        placeholder="è¯·å†æ¬¡è¾“å…¥å¯†ç " 
                                    />
                                </div>
                                <div className="form-group">
                                    <label>é‚®ç®±(é€‰å¡«)</label>
                                    <input 
                                        type="email" 
                                        value={email} 
                                        onChange={(e) => setEmail(e.target.value)} 
                                        placeholder="è¯·è¾“å…¥é‚®ç®±" 
                                    />
                                </div>
                                <button className="auth-button" onClick={handleRegister}>æ³¨å†Œ</button>
                                <div className="auth-toggle">
                                    å·²æœ‰è´¦å·ï¼Ÿ<span onClick={() => setIsLogin(true)}>ç™»å½•</span>
                                </div>
                            </div>
                        ) : (
                            <div className="auth-form">
                                <h2>ç™»å½•</h2>
                                <div className="form-group">
                                    <label>ç”¨æˆ·å</label>
                                    <input 
                                        type="text" 
                                        value={username} 
                                        onChange={(e) => setUsername(e.target.value)} 
                                        placeholder="è¯·è¾“å…¥ç”¨æˆ·å" 
                                    />
                                </div>
                                <div className="form-group">
                                    <label>å¯†ç </label>
                                    <input 
                                        type="password" 
                                        value={password} 
                                        onChange={(e) => setPassword(e.target.value)} 
                                        placeholder="è¯·è¾“å…¥å¯†ç " 
                                    />
                                </div>
                                
                                <div className="model-selector">
                                    <label>é€‰æ‹©æ¨¡å‹</label>
                                    <select 
                                        value={selectedModel}
                                        onChange={(e) => setSelectedModel(e.target.value)}
                                    >
                                        <option value="glm-4.5-air">GLM-4.5-Air (æ¨è)</option>
                                        <option value="glm-4.5-flash">GLM-4.5-Flash (å…è´¹)</option>
                                        <option value="glm-4.5-plus">GLM-4.5-Plus</option>
                                        <option value="glm-4v">GLM-4V</option>
                                        <option value="glm-4-air">GLM-4-Air</option>
                                        <option value="glm-4-airx">GLM-4-AirX</option>
                                        <option value="glm-4-flash">GLM-4-Flash</option>
                                    </select>
                                </div>
                                
                                <div className="zhipu-login">
                                    <h3>æ™ºè°±AI APIå¯†é’¥</h3>
                                    <div className="form-group">
                                        <label>APIå¯†é’¥</label>
                                        <input 
                                            type="password" 
                                            value={zhipuApiKey} 
                                            onChange={(e) => setZhipuApiKey(e.target.value)} 
                                            placeholder="è¯·è¾“å…¥æ™ºè°±AI APIå¯†é’¥" 
                                        />
                                    </div>
                                    <p>
                                        æ²¡æœ‰APIå¯†é’¥ï¼Ÿ
                                        <a href="https://open.bigmodel.cn/" target="_blank" className="zhipu-link">ç‚¹å‡»æ³¨å†Œæ™ºè°±AI</a>
                                    </p>
                                </div>
                                
                                <button className="auth-button" onClick={handleLogin}>ç™»å½•</button>
                                <div className="auth-toggle">
                                    æ²¡æœ‰è´¦å·ï¼Ÿ<span onClick={() => setIsLogin(false)}>æ³¨å†Œ</span>
                                </div>
                            </div>
                        )}
                    </div>
                );
            }

            return (
                <div>
                    <div className="user-info">
                        <span>æ¬¢è¿ï¼Œ{username} (å½“å‰æ¨¡å‹: {getModelName(selectedModel)})</span>
                        <button className="logout-button" onClick={handleLogout}>é€€å‡º</button>
                    </div>
                    
                    <div className="chat-container">
                        <div className="chat-messages">
                            {messages.map((message) => (
                                <div 
                                    key={message.id} 
                                    className={`message ${message.sender === 'user' ? 'user-message' : 'ai-message'}`}
                                >
                                    <div className="message-content">{message.text}</div>
                                    <div className="message-time">
                                        {message.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
                                    </div>
                                </div>
                            ))}
                            {isLoading && (
                                <div className="message ai-message">
                                    <div className="message-content typing-indicator">
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                    </div>
                                </div>
                            )}
                            <div ref={messagesEndRef} />
                        </div>
                        
                        <div className="chat-input">
                            <textarea
                                value={inputText}
                                onChange={(e) => setInputText(e.target.value)}
                                onKeyPress={handleKeyPress}
                                placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..."
                                rows={2}
                            ></textarea>
                            <button 
                                className="send-button" 
                                onClick={handleSendMessage}
                                disabled={!inputText.trim() || isLoading}
                            >
                                å‘é€
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // æ¸²æŸ“åº”ç”¨
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>